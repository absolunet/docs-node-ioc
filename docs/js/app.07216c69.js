(function(e){function s(s){for(var a,o,l=s[0],p=s[1],v=s[2],c=0,_=[];c<l.length;c++)o=l[c],r[o]&&_.push(r[o][0]),r[o]=0;for(a in p)Object.prototype.hasOwnProperty.call(p,a)&&(e[a]=p[a]);i&&i(s);while(_.length)_.shift()();return n.push.apply(n,v||[]),t()}function t(){for(var e,s=0;s<n.length;s++){for(var t=n[s],a=!0,l=1;l<t.length;l++){var p=t[l];0!==r[p]&&(a=!1)}a&&(n.splice(s--,1),e=o(o.s=t[0]))}return e}var a={},r={app:0},n=[];function o(s){if(a[s])return a[s].exports;var t=a[s]={i:s,l:!1,exports:{}};return e[s].call(t.exports,t,t.exports,o),t.l=!0,t.exports}o.m=e,o.c=a,o.d=function(e,s,t){o.o(e,s)||Object.defineProperty(e,s,{enumerable:!0,get:t})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,s){if(1&s&&(e=o(e)),8&s)return e;if(4&s&&"object"===typeof e&&e&&e.__esModule)return e;var t=Object.create(null);if(o.r(t),Object.defineProperty(t,"default",{enumerable:!0,value:e}),2&s&&"string"!=typeof e)for(var a in e)o.d(t,a,function(s){return e[s]}.bind(null,a));return t},o.n=function(e){var s=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(s,"a",s),s},o.o=function(e,s){return Object.prototype.hasOwnProperty.call(e,s)},o.p="/docs-node-ioc/";var l=window["webpackJsonp"]=window["webpackJsonp"]||[],p=l.push.bind(l);l.push=s,l=l.slice();for(var v=0;v<l.length;v++)s(l[v]);var i=p;n.push([0,"chunk-vendors"]),t()})({0:function(e,s,t){e.exports=t("56d7")},"083a":function(e,s,t){"use strict";t.r(s);var a=function(){var e=this,s=e.$createElement;e._self._c;return e._m(0)},r=[function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("section",[t("h1",[e._v("Test class")]),t("h2",[e._v("Introduction")]),t("p",[e._v("The test class in Node IoC is a way to enhance the test development experience.\nAll modern JavaScript test engines rely on callbacks, which is not very practical to organize code.")]),t("p",[e._v("We can then use test classes to write our tests, à la PHPUnit.")]),t("h2",[e._v("Test class")]),t("p",[e._v("The test class always extends the application's "),t("code",{pre:!0},[e._v("TestCase")]),e._v(" base class, which extends from the framework's "),t("code",{pre:!0},[e._v("TestCase")]),e._v(' base class.\nIt allows you to centralize all common features and assertions in a single file.\nThe main difference between application classes and test classes is that they are written in CommonJS instead of ESM.\nThis prevents any unexpected test behavior and ensures that the environment has the most "vanilla" flavor.')]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("// test/TestCase.js")]),e._v("\n\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("const")]),e._v(" { "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("TestCase")]),e._v(": BaseTestCase } = "),t("span",{pre:!0,attrs:{class:"hljs-built_in"}},[e._v("require")]),e._v("("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'@absolunet/ioc'")]),e._v(");\n\n\n"),t("span",{pre:!0,attrs:{class:"hljs-class"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("class")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("TestCase")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("extends")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("BaseTestCase")]),e._v(" ")]),e._v("{\n\n    setResult(result) {\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".result = result;\n    }\n\n    expectResultToBeFoo() {\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".expect("),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".result).toBe("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'foo'")]),e._v(");\n    }\n\n}\n\n\n"),t("span",{pre:!0,attrs:{class:"hljs-built_in"}},[e._v("module")]),e._v(".exports = TestCase;\n\n\n\n"),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("// test/unit/SomeTest.js")]),e._v("\n\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("const")]),e._v(" TestCase = "),t("span",{pre:!0,attrs:{class:"hljs-built_in"}},[e._v("require")]),e._v("("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'../TestCase'")]),e._v(");\n\n\n"),t("span",{pre:!0,attrs:{class:"hljs-class"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("class")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("SomeTest")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("extends")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("TestCase")]),e._v(" ")]),e._v("{\n\n    testSomeKeyConfigurationShouldBeFoo() {\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".expectResultToBeFoo("),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".make("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'config'")]),e._v(").get("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'some.key'")]),e._v("));   \n    }\n\n}\n\n\n"),t("span",{pre:!0,attrs:{class:"hljs-built_in"}},[e._v("module")]),e._v(".exports = SomeTest;\n")])]),t("p",[e._v("All of your test cases file names and class names should end with "),t("code",{pre:!0},[e._v("Test")]),e._v(", such as "),t("code",{pre:!0},[e._v("ExampleTest.js")]),e._v(".")]),t("h3",[e._v("Define a test")]),t("p",[e._v("To define a test, we would normally use a syntax like "),t("code",{pre:!0},[e._v("test('Some description', () => { /* ... */ })")]),e._v(".\nInstead, we can rely on method names.\nAll methods that start with "),t("code",{pre:!0},[e._v("test")]),e._v(" will be considered tests.\nThe description will then be the rest of the method's name, transformed as a sentence by the "),t("code",{pre:!0},[e._v("helper.string")]),e._v(" helper.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-class"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("class")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("SomeTest")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("extends")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("TestCase")]),e._v(" ")]),e._v("{\n\n    testSomeKeyConfigurationShouldBeFoo() {\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".expectResultToBeFoo("),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".make("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'config'")]),e._v(").get("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'some.key'")]),e._v("));\n        "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("// Same result as:")]),e._v("\n        "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("// test('Some key configuration should be foo', () => {")]),e._v("\n        "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("//     expect(app.make('config').get('some.key')).toBe('foo');")]),e._v("\n        "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("// })")]),e._v("\n    }\n}\n")])]),t("p",[e._v("The defined test method, as shown above, will be transformed as a test statement in the engine.\nIt will also describe the test as part of a given namespace, which is represented by the test file location, and the file name itself.")]),t("p",[e._v("For instance, the "),t("code",{pre:!0},[e._v("test/unit/foo/bar/some/ClassTest.js")]),e._v(" class file would be described as "),t("code",{pre:!0},[e._v("Unit > Foo > Bar > Some")]),e._v(", and then by "),t("code",{pre:!0},[e._v("Class")]),e._v(". If it has two test methods, "),t("code",{pre:!0},[e._v("testSomething")]),e._v(" and "),t("code",{pre:!0},[e._v("testAnotherThing")]),e._v(", we would have the following output.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":""}},[e._v("Unit > Foo > Bar > Some\n  Class\n    ✓ Something (12ms)\n    ✓ Another thing (34ms)\n")])]),t("h2",[e._v("Setup and teardown")]),t("p",[e._v("To define setup and teardown in a given class, we can rely on four methods that will be called by the test engine.")]),t("ul",[t("li",[t("p",[t("code",{pre:!0},[e._v("beforeAll")])]),t("blockquote",[t("p",[e._v("Will be called before all tests of the current class are run")])])]),t("li",[t("p",[t("code",{pre:!0},[e._v("beforeEach")])]),t("blockquote",[t("p",[e._v("Will be called before each test of the current class is run")])])]),t("li",[t("p",[t("code",{pre:!0},[e._v("afterEach")])]),t("blockquote",[t("p",[e._v("Will be called after each test of the current class has run")])])]),t("li",[t("p",[t("code",{pre:!0},[e._v("afterAll")])]),t("blockquote",[t("p",[e._v("Will be called after all tests of the current class has run")])])])]),t("p",[e._v("All of those hooks can be made "),t("code",{pre:!0},[e._v("async")]),e._v(" anytime, or return a "),t("code",{pre:!0},[e._v("Promise")]),e._v(".")]),t("h2",[e._v("Assertion")]),t("p",[e._v("To make an assertion, you can use the "),t("code",{pre:!0},[e._v("expect")]),e._v(" method.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-class"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("class")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("SomeTest")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("extends")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("TestCase")]),e._v(" ")]),e._v("{\n\n    testSomething() {\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".expect("),t("span",{pre:!0,attrs:{class:"hljs-literal"}},[e._v("true")]),e._v(").toBe("),t("span",{pre:!0,attrs:{class:"hljs-literal"}},[e._v("true")]),e._v(");\n    }\n\n}\n")])]),t("p",[e._v("For all your tests, the "),t("code",{pre:!0},[e._v("app")]),e._v(" property will be available to quickly create service instances to test them.\nIt is recommended to make the wanted services as fast as possible, such as in the "),t("code",{pre:!0},[e._v("beforeEach")]),e._v(" method.")]),t("p",[e._v("To make something, you can also use the "),t("code",{pre:!0},[e._v("make")]),e._v(" helper method.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("const")]),e._v(" fakeRepository = "),t("span",{pre:!0,attrs:{class:"hljs-built_in"}},[e._v("require")]),e._v("("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'./mocks/fakeRepository'")]),e._v(");\n\n"),t("span",{pre:!0,attrs:{class:"hljs-class"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("class")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("SomeTest")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("extends")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("TestCase")]),e._v(" ")]),e._v("{\n\n    beforeEach() {\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".someService = "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".make("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'some.service'")]),e._v(", {\n            "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'some.repository'")]),e._v(": fakeRepository\n        });\n    }\n\n    testSomething() {\n       "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("const")]),e._v(" result = "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".someService.doSomething();\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".expect(result).toBe("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'foo'")]),e._v(");\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".expect(fakeRepository.get).toHaveBeenCalledTimes("),t("span",{pre:!0,attrs:{class:"hljs-number"}},[e._v("1")]),e._v(");\n    }\n\n}\n")])]),t("p",[e._v("If you need to expect a service to be bound, you can use the "),t("code",{pre:!0},[e._v("expectBound")]),e._v(", or "),t("code",{pre:!0},[e._v("expectNotBound")]),e._v(" for the opposite behavior.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-class"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("class")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("SomeTest")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("extends")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("TestCase")]),e._v(" ")]),e._v("{\n\n    testSomething() {\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".expectBound("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'config'")]),e._v(");\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".expectNotBound("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'some.service'")]),e._v(");\n    }\n\n}\n")])])])}],n=t("2877"),o={},l=Object(n["a"])(o,a,r,!1,null,null,null);s["default"]=l.exports},1083:function(e,s,t){},"14ac":function(e,s,t){"use strict";t.r(s);var a=function(){var e=this,s=e.$createElement;e._self._c;return e._m(0)},r=[function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("section",[t("h1",[e._v("Validation")]),t("h2",[e._v("Introduction")]),t("p",[e._v("Validation is an essential part of any application.\nStrong validator systems were developed over time, some even light enough for browsers, such as "),t("code",{pre:!0},[e._v("yup")]),e._v(".\nHowever, one of the strongest validation systems on the market is the popular "),t("a",{attrs:{href:"https://joi.dev/"}},[t("code",{pre:!0},[e._v("joi")])]),e._v(" validation package.\nThis package is being used for the "),t("code",{pre:!0},[e._v("validator")]),e._v(" service.")]),t("h2",[e._v("The validator service")]),t("p",[e._v("The "),t("code",{pre:!0},[e._v("validator")]),e._v(" service simply exposes the "),t("code",{pre:!0},[e._v("joi")]),e._v(" package for direct usage.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("const")]),e._v(" validator = app.make("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'validator'")]),e._v(");\n\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("const")]),e._v(" schema = validator.object().keys({\n    "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("name")]),e._v(": validator.string()\n});\n\nvalidator.assert({ "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("name")]),e._v(": "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'John Smith'")]),e._v(" }, schema); "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("// Everything went well!")]),e._v("\nvalidator.assert({ "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("foo")]),e._v(": "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'bar'")]),e._v(" }, schema);\n"),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("// ValidationError: {")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v('//    "foo" [1]: "bar"')]),e._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("// }")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("//  ")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v('// [1] "foo" is not allowed')]),e._v("\n")])]),t("p",[e._v("All the "),t("code",{pre:!0},[e._v("joi")]),e._v(" package API is available in the "),t("code",{pre:!0},[e._v("validator")]),e._v(" service, including extensions through "),t("code",{pre:!0},[e._v("extend")]),e._v(".")]),t("h2",[e._v("Validate an HTTP request")]),t("p",[e._v("The most common validation type in a server application is request validation.\nFortunately, Node IoC already wrapped the validator into a simple controller method.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-class"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("class")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("MyController")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("extends")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("Controller")]),e._v(" ")]),e._v("{\n\n    "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("static")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("get")]),e._v(" dependencies() {\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" ["),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'custom.post.service'")]),e._v("];\n    }\n\n    "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("async")]),e._v(" store() {\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".validate("),t("span",{pre:!0,attrs:{class:"hljs-function"}},[e._v("("),t("span",{pre:!0,attrs:{class:"hljs-params"}},[e._v("v")]),e._v(") =>")]),e._v(" {\n        \t"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" {\n        \t    "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("title")]),e._v(":    v.string().min("),t("span",{pre:!0,attrs:{class:"hljs-number"}},[e._v("3")]),e._v(").required(),\n                "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("content")]),e._v(":  v.string().required(),\n                "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("promoted")]),e._v(": v.boolean().required()\n            };\n        });\n\n        "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("// After this point, we can consider the request's body to be valid.")]),e._v("\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("const")]),e._v(" { "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("body")]),e._v(": postData } = "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".request;\n\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("const")]),e._v(" post = "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("await")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".customPostService.createPost(postData);\n\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".json(post);\n    }\n\n}\n")])])])}],n=t("2877"),o={},l=Object(n["a"])(o,a,r,!1,null,null,null);s["default"]=l.exports},"1a3e":function(e,s,t){"use strict";t.r(s);var a=function(){var e=this,s=e.$createElement;e._self._c;return e._m(0)},r=[function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("section",[t("h1",[e._v("Create a service")]),t("h2",[e._v("Introduction")]),t("p",[t("em",[e._v("The API endpoint assignment must be completed to start this one since it uses the same controller and refactors it.")])]),t("p",[e._v("Services, repositories, factories, builders, drivers, engines, handlers... Those are all common terms for backend developers.")]),t("p",[e._v("If you are new to this world, it's important to understand the "),t("a",{attrs:{href:"https://en.wikipedia.org/wiki/SOLID"}},[e._v("SOLID")]),e._v(" principles.")]),t("p",[e._v("The first principle that it defines is the "),t("em",[t("strong",[e._v("S")]),e._v("ingle responsibility principle")]),e._v(", which states that each function, class, method, file, etc., must have a single purpose, a unique responsibility regarding your application.\nIt makes it easier to maintain, to test, to predict and to use.\nWe refer to classes that have too many responsibilities as "),t("em",[e._v("God class")]),e._v(".")]),t("p",[e._v("So, if a controller has business logic in it, it does not comply with the SOLID principle.\nThe controller's role is to handle the request and to return a response matching the request, not to interact with a database or to send emails.")]),t("p",[e._v("In this assignment, we will create a "),t("code",{pre:!0},[e._v("TodoService")]),e._v(" that will perfectly fit with the previous assignment.\nIn the last assignment, the controller itself managed the business logic of the todos.\nLet's split those two responsibilities.")]),t("h2",[e._v("What is a service?")]),t("p",[e._v("Essentially, a service manages the business (or the application) logic.\nThey are separated by concerns and can use other services, repositories and so on.\nIn an eCommerce platform, for instance, it is very usual to have a "),t("code",{pre:!0},[e._v("CustomerService")]),e._v(", a "),t("code",{pre:!0},[e._v("ProductService")]),e._v(" and an "),t("code",{pre:!0},[e._v("OrderService")]),e._v(", each of them exposing methods to interact with the data by using the programmed business logic.")]),t("p",[e._v("In our case, the "),t("code",{pre:!0},[e._v("TodoService")]),e._v(" that we will create will essentially expose the CRUD methods, but with some verbosity in it: instead of "),t("code",{pre:!0},[e._v("index")]),e._v(", we will call "),t("code",{pre:!0},[e._v("all()")]),e._v(", or "),t("code",{pre:!0},[e._v("getAllTodos()")]),e._v(", whatever is verbose enough for you, and those who will read or use the code.")]),t("blockquote",[t("p",[e._v("Indeed, the ratio of time spent reading versus writing is well over 10 to 1.\nWe are constantly reading old code as part of the effort to write new code.\n...[Therefore,] making it easy to read makes it easier to write.")]),t("p",[e._v("--- "),t("em",[e._v("Robert C. Martin, Clean Code: A Handbook of Agile Software Craftsmanship")])])]),t("h2",[e._v("Create the TodoService")]),t("p",[e._v("First, let's create our first service.\nUnlike the other times, there is no command to scaffold a service since they are normally completely custom.")]),t("p",[e._v("Let's create a "),t("code",{pre:!0},[e._v("services")]),e._v(" folder under "),t("code",{pre:!0},[e._v("src/app")]),e._v(", to group our services.\nThen, we can create a "),t("code",{pre:!0},[e._v("TodoService.js")]),e._v(" file in it.")]),t("p",[e._v("Here is the basic content:")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-class"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("class")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("TodoService")]),e._v(" ")]),e._v("{\n\n}\n\n\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("export")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("default")]),e._v(" TodoService;\n")])]),t("p",[e._v("Normally, any Node.js developer would go in their "),t("code",{pre:!0},[e._v("TodoController")]),e._v(" and "),t("code",{pre:!0},[e._v("import TodoService from '../../../services/TodoService")]),e._v(".\nNot in Node IoC.\n"),t("strong",[e._v("NEVER")]),e._v(" do this in Node IoC.\nWhy? Why using Node IoC in the first place.\nFrom the beginning, we injected "),t("code",{pre:!0},[e._v("config")]),e._v(" and "),t("code",{pre:!0},[e._v("http")]),e._v(", the controller used the application to build "),t("code",{pre:!0},[e._v("validator")]),e._v(" and "),t("code",{pre:!0},[e._v("view")]),e._v(", without importing anything.\nWe should work the same way!")]),t("p",[e._v("To make a service injectable, only two lines of code are required, and those lines will be located in a "),t("code",{pre:!0},[e._v("ServiceProvider")]),e._v(".\nIn our application, we have two service providers: the "),t("code",{pre:!0},[e._v("AppServiceProvider")]),e._v(", which should be used for service registration and third party initialization, and "),t("code",{pre:!0},[e._v("RouteServiceProvider")]),e._v(", which load the routes into the router.")]),t("p",[e._v("Inside the "),t("code",{pre:!0},[e._v("src/app/providers/AppServiceProvider")]),e._v(", you will see two methods: "),t("code",{pre:!0},[e._v("register")]),e._v(" and "),t("code",{pre:!0},[e._v("boot")]),e._v(".\nThe "),t("code",{pre:!0},[e._v("register")]),e._v(" is perfectly suited to bind a service in the application to make it injectable.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("import")]),e._v(" { ServiceProvider } "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("from")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'@absolunet/ioc'")]),e._v(";\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("import")]),e._v(" TodoService "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("from")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'../services/TodoService'")]),e._v(";\n\n\n"),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("/**\n * Application service provider.\n */")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-class"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("class")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("AppServiceProvider")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("extends")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("ServiceProvider")]),e._v(" ")]),e._v("{\n\n    "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("/**\n     * Register any application services.\n     */")]),e._v("\n    register() {\n        "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("// You may register any service either as a binding or a singleton using")]),e._v("\n        "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("// this.app.bind('service.name', concrete) or")]),e._v("\n        "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("// this.app.singleton('service.name', concrete).")]),e._v("\n        "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("// However, you should not use any service since some services may not be available yet.")]),e._v("\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".app.singleton("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'todo'")]),e._v(", TodoService);\n    }\n\n    "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("/**\n     * Bootstrap any application services.\n     */")]),e._v("\n    boot() {\n        "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("// You may use services here to bootstrap them.")]),e._v("\n        "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("// You can get a service instance using this.app.make('service.name').")]),e._v("\n    }\n\n}\n")])]),t("p",[e._v("We will use the "),t("code",{pre:!0},[e._v("singleton")]),e._v(" binding method to prevent creating a new instance each time it is registered.")]),t("p",[e._v("Now that we made a service, let's try to inject it in our "),t("code",{pre:!0},[e._v("TodoController")]),e._v(".")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-class"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("class")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("TodoController")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("extends")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("Controller")]),e._v(" ")]),e._v("{\n\n    "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("static")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("get")]),e._v(" dependencies() {\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" ["),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'config'")]),e._v(", "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'todo'")]),e._v("];\n    }\n\n    index() {\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".dump("),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".todo);\n        "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("// return this.json(this.config.get('todo', []));")]),e._v("\n    }\n\n    "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("/* ... */")]),e._v("\n\n}\n")])]),t("p",[e._v("In the dumped page, you should see "),t("code",{pre:!0},[e._v("( TodoService #1 ) { ▸ }")]),e._v(".\nYour service was successfully instantiated!\nWe can now start to implement it.")]),t("h2",[e._v("Describe the methods")]),t("p",[e._v("Here are the main actions (as a TypeScript interface) that we want to perform over our todos:")]),t("ul",[t("li",[t("code",{pre:!0},[e._v("getAll(): Array<Todo>;")])]),t("li",[t("code",{pre:!0},[e._v("create(data: CreateTodoModel): Todo;")])]),t("li",[t("code",{pre:!0},[e._v("findById(id: number): Todo;")])]),t("li",[t("code",{pre:!0},[e._v("existById(id): boolean;")])]),t("li",[t("code",{pre:!0},[e._v("updateById(id: number, data: UpdateTodoModel): Todo;")])]),t("li",[t("code",{pre:!0},[e._v("deleteById(id: number): void;")])])]),t("p",[e._v("They are much more verbose than "),t("code",{pre:!0},[e._v("index")]),e._v(" or "),t("code",{pre:!0},[e._v("show")]),e._v(", aren't they?\nNow, let's write our methods in the service.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-class"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("class")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("TodoService")]),e._v(" ")]),e._v("{\n\n    getAll() {\n        "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("//")]),e._v("\n    }\n\n    create(data) {\n        "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("//")]),e._v("\n    }\n\n    existById(id) {\n        "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("//")]),e._v("\n    }\n\n    findById(id) {\n        "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("//")]),e._v("\n    }\n\n    updateById(id, data) {\n        "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("//")]),e._v("\n    }\n\n    deleteById(id) {\n        "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("//")]),e._v("\n    }\n\n}\n")])]),t("h2",[e._v("Refactor the controller")]),t("p",[e._v("Let's use the service in the controller instead of the config repository and all the business logic.\nHowever, the validation should remain.\nIt is still the controller's responsibility to validate the request.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-class"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("class")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("TodoController")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("extends")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("Controller")]),e._v(" ")]),e._v("{\n\n    "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("static")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("get")]),e._v(" dependencies() {\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" ["),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'todo'")]),e._v("];\n    }\n\n    index() {\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".json("),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".todo.getAll());\n    }\n\n    store() {\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".validate("),t("span",{pre:!0,attrs:{class:"hljs-function"}},[e._v("("),t("span",{pre:!0,attrs:{class:"hljs-params"}},[e._v("validator")]),e._v(") =>")]),e._v(" {\n            "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" {\n                "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("label")]),e._v(": validator.string().required()\n            };\n        });\n\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".json("),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".todo.create("),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".request.body));\n    }\n\n    show() {\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("const")]),e._v(" id = "),t("span",{pre:!0,attrs:{class:"hljs-built_in"}},[e._v("Number")]),e._v("("),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".request.params.todo);\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("const")]),e._v(" todo = "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".todo.findById(id);\n\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("if")]),e._v(" (!todo) {\n            "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".notFound();\n        }\n\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".json(todo);\n    }\n\n    update() {\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("const")]),e._v(" id = "),t("span",{pre:!0,attrs:{class:"hljs-built_in"}},[e._v("Number")]),e._v("("),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".request.params.todo);\n\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("if")]),e._v(" (!"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".todo.existById(id)) {\n            "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".notFound();\n        }\n\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".validate("),t("span",{pre:!0,attrs:{class:"hljs-function"}},[e._v("("),t("span",{pre:!0,attrs:{class:"hljs-params"}},[e._v("validator")]),e._v(") =>")]),e._v(" {\n            "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" {\n                "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("label")]),e._v(": validator.string().optional(),\n                "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("done")]),e._v(":  validator.boolean().optional()\n            };\n        });\n\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".json("),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".todo.updateById(id, "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".request.body));\n    }\n\n    destroy() {\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("const")]),e._v(" id = "),t("span",{pre:!0,attrs:{class:"hljs-built_in"}},[e._v("Number")]),e._v("("),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".request.params.todo);\n\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("if")]),e._v(" (!"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".todo.existById(id)) {\n            "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".notFound();\n        }\n\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".todo.deleteById(id);\n\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".noContent();\n    }\n\n}\n")])]),t("p",[e._v("As you can see in this refactored controller, there is no business logic, just request handling (request body validation, service actions execution and response process).")]),t("p",[e._v("Now, we need to implement the "),t("code",{pre:!0},[e._v("TodoService")]),e._v(" methods.")]),t("h2",[e._v("Implement the service")]),t("h3",[e._v("Implement getAll()")]),t("p",[e._v("Let's tackle our first method, "),t("code",{pre:!0},[e._v("getAll")]),e._v(", which should return an array of todos, as described above.")]),t("p",[e._v("Before implementing it, we need to store the todos somewhere.\nThe "),t("code",{pre:!0},[e._v("config")]),e._v(" repository was just for demonstration...\nIt is not its purpose, so we should not use it anymore.")]),t("p",[e._v("In fact, we just need a repository to store them.\nWe could create a "),t("code",{pre:!0},[e._v("TodoRepository")]),e._v(" to manage the todo store, but let's implement a single service for now.")]),t("p",[e._v("Normally, in object-oriented programming, we would use private property to store the todos.\nIn JavaScript, the encapsulation is not yet implemented (written in early 2020, take a look at "),t("a",{attrs:{href:"https://github.com/tc39/proposal-class-fields"}},[e._v("this TC39 proposal")]),e._v(" to validate that statement).\nHowever, Absolunet offers an easy to use tool to emulate encapsulation with the "),t("code",{pre:!0},[e._v("[@absolunet/private-registry](https://github.com/absolunet/node-private-registry)")]),e._v(" package.\nOf course, it is not as strong as real encapsulation, but it's still a good starting point.")]),t("p",[e._v("Let's use it.\nThis time, since it should be kept private, you can "),t("code",{pre:!0},[e._v("import")]),e._v(" it.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("import")]),e._v(" __ "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("from")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'@absolunet/private-registry'")]),e._v(";\n\n\n"),t("span",{pre:!0,attrs:{class:"hljs-class"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("class")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("TodoService")]),e._v(" ")]),e._v("{\n\n    "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("/* ... */")]),e._v("\n\n}\n")])]),t("p",[e._v("Normally, what we would do is initializing our data in the constructor, like this:")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-class"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("class")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("TodoService")]),e._v(" ")]),e._v("{\n\n    "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("constructor")]),e._v("() {\n        __("),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(").set("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'todos'")]),e._v(", []);\n    }\n\n}\n")])]),t("p",[e._v("However, since the dependency injection occurs at this time, and the dependencies are not yet dynamically assigned, Node IoC offers another starting point for initialization, through the "),t("code",{pre:!0},[e._v("init")]),e._v(" method.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-class"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("class")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("TodoService")]),e._v(" ")]),e._v("{\n\n    init() {\n        __("),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(").set("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'todos'")]),e._v(", []);\n    }\n\n}\n")])]),t("p",[e._v("In the container instantiation cycle, the instance's dependencies are resolved.\nAn instance is created, with the resolved dependencies passed as arguments.\nThey are then dynamically assigned, and finally, the "),t("code",{pre:!0},[e._v("init")]),e._v(" method is called.")]),t("p",[e._v("In the "),t("code",{pre:!0},[e._v("init")]),e._v(" method, you can assume that everything is properly set up, and the instance is ready to work.")]),t("p",[e._v("Now that the todos are saved somewhere, let's implement the "),t("code",{pre:!0},[e._v("getAll")]),e._v(" method.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-class"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("class")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("TodoService")]),e._v(" ")]),e._v("{\n\n    init() {\n        __("),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(").set("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'todos'")]),e._v(", []);\n    }\n\n    getAll() {\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" __("),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(").get("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'todos'")]),e._v(").map("),t("span",{pre:!0,attrs:{class:"hljs-function"}},[e._v("("),t("span",{pre:!0,attrs:{class:"hljs-params"}},[e._v("todo")]),e._v(") =>")]),e._v(" {\n            "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" { ...todo };\n        });\n    }\n\n}\n")])]),t("p",[e._v("Here, a new array, with all the todos in it, is returned, to prevent that the array is directly modified by the caller.\nIt would remove the meaning of a private member.")]),t("p",[e._v("The same thing is done for all the todos.\nThey are transformed into an identical object, but in another instance, to prevent direct modification.")]),t("p",[e._v("Let's try to call the "),t("code",{pre:!0},[e._v("/api/todo")]),e._v(" route.\nWe should have an empty array as the response.")]),t("h3",[e._v("Implement create()")]),t("p",[e._v("Now, we can create a new todo and store it in the private registry.\nWe can keep track of an incrementing ID, which would be much cleaner than what we have done previously in the controller.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-class"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("class")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("TodoService")]),e._v(" ")]),e._v("{\n\n    init() {\n        __("),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(").set("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'todos'")]),e._v(", []);\n        __("),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(").set("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'id'")]),e._v(", "),t("span",{pre:!0,attrs:{class:"hljs-number"}},[e._v("0")]),e._v(");\n    }\n\n    "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("/* ... */")]),e._v("\n\n    create({ label }) {\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("const")]),e._v(" _this = __("),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(").get();\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("const")]),e._v(" id    = ++_this.id;\n\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("const")]),e._v(" todo = {\n            "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("done")]),e._v(": "),t("span",{pre:!0,attrs:{class:"hljs-literal"}},[e._v("false")]),e._v(",\n            id,\n            label\n        };\n\n        _this.todos.push(todo);\n\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" todo;\n    }\n\n}\n")])]),t("h3",[e._v("Implement findById()")]),t("p",[e._v("Finding the todo by ID should be simple, it's basically the same thing that we did in the controller during the last assignment.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-class"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("class")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("TodoService")]),e._v(" ")]),e._v("{\n\n    "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("/* ... */")]),e._v("\n\n    findById(id) {\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("const")]),e._v(" todos = __("),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(").get("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'todos'")]),e._v(");\n\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("const")]),e._v(" todo = todos.find("),t("span",{pre:!0,attrs:{class:"hljs-function"}},[e._v("("),t("span",{pre:!0,attrs:{class:"hljs-params"}},[e._v("{ id: todoId }")]),e._v(") =>")]),e._v(" {\n            "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" todoId === id;\n        });\n\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" todo ? { ...todo } : "),t("span",{pre:!0,attrs:{class:"hljs-literal"}},[e._v("null")]),e._v(";\n    }\n\n}\n")])]),t("p",[e._v("Here, we do the same thing as the "),t("code",{pre:!0},[e._v("getAll")]),e._v(" method.\nWe return another instance of the same data to prevent direct overwrite.")]),t("p",[e._v("However, you may have noticed that we do not cast the id as a string, because, in our model, we expect a number as an ID.\nIt's the responsibility of the caller to provide us the proper type.\nIn the controller, you may have also noticed that all the "),t("code",{pre:!0},[e._v("id")]),e._v(" that are sent to the service are cast as "),t("code",{pre:!0},[e._v("Number")]),e._v(".")]),t("h3",[e._v("Implement existById()")]),t("p",[e._v("We can rely on our "),t("code",{pre:!0},[e._v("findById")]),e._v(" method and return a boolean value of the returned data, or we can rely on the "),t("code",{pre:!0},[e._v("some")]),e._v(" method.\nBoth methods are very similar in terms of performance, so no need to worry about it for now.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-class"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("class")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("TodoService")]),e._v(" ")]),e._v("{\n\n    "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("/* ... */")]),e._v("\n\n    existById(id) {\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-built_in"}},[e._v("Boolean")]),e._v("("),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".findById(id));\n    }\n\n    "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("/* ... */")]),e._v("\n\n}\n")])]),t("p",[e._v("Or")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-class"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("class")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("TodoService")]),e._v(" ")]),e._v("{\n\n    "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("/* ... */")]),e._v("\n\n    existById(id) {\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" __("),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(").get("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'todos'")]),e._v(").some("),t("span",{pre:!0,attrs:{class:"hljs-function"}},[e._v("("),t("span",{pre:!0,attrs:{class:"hljs-params"}},[e._v("{ id: todoId }")]),e._v(") =>")]),e._v(" {\n            "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" todoId === id;\n        });\n    }\n\n    "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("/* ... */")]),e._v("\n\n}\n")])]),t("h3",[e._v("Implement updateById()")]),t("p",[e._v("Now, let's update an existing todo.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-class"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("class")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("TodoService")]),e._v(" ")]),e._v("{\n\n    "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("/* ... */")]),e._v("\n\n    updateById(id, { label, done }) {\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("const")]),e._v(" todos = __("),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(").get("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'todos'")]),e._v(");\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("const")]),e._v(" todo  = todos.find("),t("span",{pre:!0,attrs:{class:"hljs-function"}},[e._v("("),t("span",{pre:!0,attrs:{class:"hljs-params"}},[e._v("{ id: todoId }")]),e._v(") =>")]),e._v(" {\n            "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" todoId === id;\n        });\n    \n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("if")]),e._v(" (!todo) {\n            "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("throw")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("new")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-built_in"}},[e._v("TypeError")]),e._v("("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("`The todo "),t("span",{pre:!0,attrs:{class:"hljs-subst"}},[e._v("${id}")]),e._v(" was not found.`")]),e._v(");\n        }\n    \n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("if")]),e._v(" ("),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("typeof")]),e._v(" label === "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'string'")]),e._v(") {\n            todo.label = label;\n        }\n    \n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("if")]),e._v(" ("),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("typeof")]),e._v(" done === "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'boolean'")]),e._v(") {\n            todo.done = done;\n        }\n    \n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" { ...todo };\n    }\n\n    "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("/* ... */")]),e._v("\n\n}\n")])]),t("p",[e._v("Here, first retrieve the original array, with all the original todo instances.")]),t("p",[e._v("We attempt to find the todo with the received ID.\nIf it does not exist, we throw an error.\nNotice that our controller made an "),t("code",{pre:!0},[e._v("existById")]),e._v(" check before going forward with the update.")]),t("p",[e._v("Notice that we do not reassign the todo in the array.\nSince the reference is still the same, the todo in the array is pointing to the same object as the "),t("code",{pre:!0},[e._v("todo")]),e._v(" constant.")]),t("h3",[e._v("Implement deleteById()")]),t("p",[e._v("Finally, let's delete a todo by ID.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-class"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("class")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("TodoService")]),e._v(" ")]),e._v("{\n\n    "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("/* ... */")]),e._v("\n\n    deleteById(id) {\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("const")]),e._v(" todos = __("),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(").get("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'todos'")]),e._v(");\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("const")]),e._v(" index = todos.findIndex("),t("span",{pre:!0,attrs:{class:"hljs-function"}},[e._v("("),t("span",{pre:!0,attrs:{class:"hljs-params"}},[e._v("{ id: todoId }")]),e._v(") =>")]),e._v(" {\n            "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" todoId === id;\n        });\n\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("if")]),e._v(" (index === "),t("span",{pre:!0,attrs:{class:"hljs-number"}},[e._v("-1")]),e._v(") {\n            "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("throw")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("new")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-built_in"}},[e._v("TypeError")]),e._v("("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("`The todo "),t("span",{pre:!0,attrs:{class:"hljs-subst"}},[e._v("${id}")]),e._v(" was not found.`")]),e._v(");\n        }\n\n        todos.splice(index, "),t("span",{pre:!0,attrs:{class:"hljs-number"}},[e._v("1")]),e._v(");\n    }\n\n}\n")])]),t("p",[e._v("Here is our final class result.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("import")]),e._v(" __ "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("from")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'@absolunet/private-registry'")]),e._v(";\n\n\n"),t("span",{pre:!0,attrs:{class:"hljs-class"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("class")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("TodoService")]),e._v(" ")]),e._v("{\n\n    init() {\n        __("),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(").set("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'todos'")]),e._v(", []);\n        __("),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(").set("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'id'")]),e._v(", "),t("span",{pre:!0,attrs:{class:"hljs-number"}},[e._v("0")]),e._v(");\n    }\n\n    getAll() {\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" __("),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(").get("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'todos'")]),e._v(").map("),t("span",{pre:!0,attrs:{class:"hljs-function"}},[e._v("("),t("span",{pre:!0,attrs:{class:"hljs-params"}},[e._v("todo")]),e._v(") =>")]),e._v(" {\n            "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" { ...todo };\n        });\n    }\n\n    create({ label }) {\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("const")]),e._v(" _this = __("),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(").get();\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("const")]),e._v(" id = ++_this.id;\n\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("const")]),e._v(" todo = {\n            "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("done")]),e._v(": "),t("span",{pre:!0,attrs:{class:"hljs-literal"}},[e._v("false")]),e._v(",\n            id,\n            label\n        };\n\n        _this.todos.push(todo);\n\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" todo;\n    }\n\n    findById(id) {\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("const")]),e._v(" todos = __("),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(").get("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'todos'")]),e._v(");\n\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("const")]),e._v(" todo = todos.find("),t("span",{pre:!0,attrs:{class:"hljs-function"}},[e._v("("),t("span",{pre:!0,attrs:{class:"hljs-params"}},[e._v("{ id: todoId }")]),e._v(") =>")]),e._v(" {\n            "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" todoId === id;\n        });\n\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" todo ? { ...todo } : "),t("span",{pre:!0,attrs:{class:"hljs-literal"}},[e._v("null")]),e._v(";\n    }\n\n    existById(id) {\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" __("),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(").get("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'todos'")]),e._v(").some("),t("span",{pre:!0,attrs:{class:"hljs-function"}},[e._v("("),t("span",{pre:!0,attrs:{class:"hljs-params"}},[e._v("{ id: todoId }")]),e._v(") =>")]),e._v(" {\n            "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" todoId === id;\n        });\n    }\n\n    updateById(id, { label, done }) {\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("const")]),e._v(" todos = __("),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(").get("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'todos'")]),e._v(");\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("const")]),e._v(" todo  = todos.find("),t("span",{pre:!0,attrs:{class:"hljs-function"}},[e._v("("),t("span",{pre:!0,attrs:{class:"hljs-params"}},[e._v("{ id: todoId }")]),e._v(") =>")]),e._v(" {\n            "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" todoId === id;\n        });\n\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("if")]),e._v(" (!todo) {\n            "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("throw")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("new")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-built_in"}},[e._v("TypeError")]),e._v("("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("`The todo "),t("span",{pre:!0,attrs:{class:"hljs-subst"}},[e._v("${id}")]),e._v(" was not found.`")]),e._v(");\n        }\n\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("if")]),e._v(" ("),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("typeof")]),e._v(" label === "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'string'")]),e._v(") {\n            todo.label = label;\n        }\n\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("if")]),e._v(" ("),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("typeof")]),e._v(" done === "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'boolean'")]),e._v(") {\n            todo.done = done;\n        }\n\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" { ...todo };\n    }\n\n    deleteById(id) {\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("const")]),e._v(" todos = __("),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(").get("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'todos'")]),e._v(");\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("const")]),e._v(" index = todos.findIndex("),t("span",{pre:!0,attrs:{class:"hljs-function"}},[e._v("("),t("span",{pre:!0,attrs:{class:"hljs-params"}},[e._v("{ id: todoId }")]),e._v(") =>")]),e._v(" {\n            "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" todoId === id;\n        });\n\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("if")]),e._v(" (index === "),t("span",{pre:!0,attrs:{class:"hljs-number"}},[e._v("-1")]),e._v(") {\n            "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("throw")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("new")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-built_in"}},[e._v("TypeError")]),e._v("("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("`The todo "),t("span",{pre:!0,attrs:{class:"hljs-subst"}},[e._v("${id}")]),e._v(" was not found.`")]),e._v(");\n        }\n\n        todos.splice(index, "),t("span",{pre:!0,attrs:{class:"hljs-number"}},[e._v("1")]),e._v(");\n    }\n\n}\n\n\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("export")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("default")]),e._v(" TodoService;\n")])])])}],n=t("2877"),o={},l=Object(n["a"])(o,a,r,!1,null,null,null);s["default"]=l.exports},"1ade":function(e,s,t){"use strict";t.r(s);var a=function(){var e=this,s=e.$createElement;e._self._c;return e._m(0)},r=[function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("section",[t("h1",[e._v("Security")]),t("h2",[e._v("Introduction")]),t("p",[e._v("It often happens that some features are restricted to some users or other conditions such as configuration.\nThose restrictions are called "),t("code",{pre:!0},[e._v("policies")]),e._v(", which comes out of the box in Node IoC.\nYou can define your policies through the "),t("code",{pre:!0},[e._v("gate")]),e._v(" service and use them wherever you want.\nPlus, there is already an implementation of gates and policies in commands that you are already using without even noticing it.")]),t("h2",[e._v("The gate service")]),t("p",[e._v("The security service provider offers the "),t("code",{pre:!0},[e._v("gate")]),e._v(" service.\nIt offers basic features to define and use policies through the "),t("code",{pre:!0},[e._v("policy")]),e._v(" and "),t("code",{pre:!0},[e._v("can")]),e._v(" methods.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("const")]),e._v(" gate       = app.make("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'gate'")]),e._v(");\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("const")]),e._v(" dateHelper = app.make("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'helper.date'")]),e._v(");\n\ngate.policy("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'onEvening'")]),e._v(", () => {\n    "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("const")]),e._v(" hour = dateHelper().hours();\n\n    "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" hour >= "),t("span",{pre:!0,attrs:{class:"hljs-number"}},[e._v("18")]),e._v(";\n});\n\n"),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v('// Given current time = "2020-01-01 19:12:34"')]),e._v("\ngate.can("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'onEvening'")]),e._v("); "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("// true")]),e._v("\n\n"),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v('// Given current time = "2020-01-01 12:34:56"')]),e._v("\ngate.can("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'onEvening'")]),e._v("); "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("// false")]),e._v("\n")])]),t("p",[e._v("You can also validate multiple policies at the same time.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("const")]),e._v(" gate = app.make("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'gate'")]),e._v(");\n\ngate.policy("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'yes'")]),e._v(", () => { "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-literal"}},[e._v("true")]),e._v("; });\ngate.policy("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'no'")]),e._v(",  () => { "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-literal"}},[e._v("false")]),e._v("; });\n\ngate.can(["),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'yes'")]),e._v(", "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'no'")]),e._v("]); "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("// false")]),e._v("\n")])]),t("p",[e._v("You may define policies in your service providers to centralize operations since they will be available by all other services, commands, and controllers.")]),t("h3",[e._v("Policy arguments")]),t("p",[e._v("Sometimes, a policy alone is not enough.\nYou may need to configure them when using them.\nFor instance, the "),t("code",{pre:!0},[e._v("env")]),e._v(" policy allows or denies depending on the current environment.\nIt would be unthinkable to create all policies for all possible environments.\nInstead, we can use parameters, that follows this syntax: "),t("code",{pre:!0},[e._v("policy:arg1,arg2,arg3")]),e._v(".")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("const")]),e._v(" gate = app.make("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'gate'")]),e._v(");\n\n"),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v('// Given the current environment = "local"')]),e._v("\ngate.can("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'env:local'")]),e._v("); "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("// true")]),e._v("\ngate.can("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'env:production'")]),e._v("); "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("// false")]),e._v("\n")])]),t("p",[e._v("To use arguments, you simply have to accept them in the policy handler.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("const")]),e._v(" gate = app.make("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'gate'")]),e._v(");\n\ngate.policy("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'pair'")]),e._v(", (value) => {\n    "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-built_in"}},[e._v("parseInt")]),e._v("(value) % "),t("span",{pre:!0,attrs:{class:"hljs-number"}},[e._v("2")]),e._v(" === "),t("span",{pre:!0,attrs:{class:"hljs-number"}},[e._v("0")]),e._v(";\n});\n\ngate.can("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'pair:2'")]),e._v("); "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("// true")]),e._v("\ngate.can("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'pair:5'")]),e._v("); "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("// false")]),e._v("\n\n\ngate.policy("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'auth.role'")]),e._v(", (...roles) => {\n    "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("const")]),e._v(" user = app.make("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'custom.auth'")]),e._v(").user();\n\n    "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" roles.every("),t("span",{pre:!0,attrs:{class:"hljs-function"}},[e._v("("),t("span",{pre:!0,attrs:{class:"hljs-params"}},[e._v("role")]),e._v(") =>")]),e._v(" {\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" user.hasRole(role);\n    });\n});\n\n\n"),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v('// Given authenticated user with "foo" and "bar" roles')]),e._v("\ngate.can("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'auth.role:foo'")]),e._v(");     "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("// true")]),e._v("\ngate.can("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'auth.role:bar'")]),e._v(");     "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("// true")]),e._v("\ngate.can("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'auth.role:baz'")]),e._v(");     "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("// false")]),e._v("\ngate.can("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'auth.role:foo,bar'")]),e._v("); "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("// true")]),e._v("\ngate.can("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'auth.role:foo,baz'")]),e._v("); "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("// false")]),e._v("\n")])]),t("h2",[e._v("Use policies in commands")]),t("p",[e._v("By default, the command registrar uses the "),t("code",{pre:!0},[e._v("gate")]),e._v(" service to decide which commands are available in the CLI.\nWhen bootstrapping Yargs, it starts by instantiating all the registered commands and check their "),t("code",{pre:!0},[e._v("policies")]),e._v(" property value.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-class"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("class")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("MyCommand")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("extends")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("Command")]),e._v(" ")]),e._v("{\n\n    "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("get")]),e._v(" policies() {\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" ["),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'env:local'")]),e._v("];\n    }\n\n}\n")])]),t("p",[e._v("In the above example, the command would be available only if the environment is set to "),t("code",{pre:!0},[e._v("local")]),e._v(".\nFor instance, all the commands extending "),t("code",{pre:!0},[e._v("GeneratorCommand")]),e._v(" (those starting by "),t("code",{pre:!0},[e._v("make:")]),e._v(" are extending this class) have the "),t("code",{pre:!0},[e._v("env:local")]),e._v(" policy, at least.")]),t("h3",[e._v("Policy class")]),t("p",[e._v("It is sometimes preferable to implement policies in external classes to separate concerns.\nThe framework offers a base class to implement a policy.\nIn a policy class, the dependency injection can be used, the same way it is done for all other classes.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("import")]),e._v(" { Policy } "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("from")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'@absolunet/ioc'")]),e._v(";\n\n\n"),t("span",{pre:!0,attrs:{class:"hljs-class"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("class")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("NonProductionPolicy")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("extends")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("Policy")]),e._v(" ")]),e._v("{\n\n    "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("static")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("get")]),e._v(" dependencies() {\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" ["),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'config'")]),e._v("];\n    }\n\n    "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("get")]),e._v(" name() {\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'non-production'")]),e._v(";\n    }\n\n    passes() {\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" ["),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'prod'")]),e._v(", "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'production'")]),e._v("].includes("),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".config.get("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'app.env'")]),e._v(", "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'production'")]),e._v("));\n    }\n\n}\n")])]),t("p",[e._v("To register a policy class, the "),t("code",{pre:!0},[e._v("register")]),e._v(" method can be used on the gate service.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("import")]),e._v(" NonProductionPolicy "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("from")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'./policies/NonProductionPolicy'")]),e._v(";\n\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("const")]),e._v(" gate = app.make("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'gate'")]),e._v(");\n\ngate.register(NonProductionPolicy);\n")])])])}],n=t("2877"),o={},l=Object(n["a"])(o,a,r,!1,null,null,null);s["default"]=l.exports},"1c95":function(e,s,t){"use strict";t.r(s);var a=function(){var e=this,s=e.$createElement;e._self._c;return e._m(0)},r=[function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("section",[t("h1",[e._v("Log")]),t("h2",[e._v("Introduction")]),t("p",[e._v("Logging messages can be quite useful when debugging or inspecting jobs.\nThe Node IoC logger offers everything you need to log messages for a specific level in configurable channels.\nOut of the box, you can log in a file or in a database, but you can easily implement a driver to log into Logstash, Papertrail, Sentry or Bugsnag.")]),t("h2",[e._v("Configuration")]),t("p",[e._v("The logging service provider offers a configuration that enumerates available channels.\nBy default, there are three channels: "),t("code",{pre:!0},[e._v("stack")]),e._v(", "),t("code",{pre:!0},[e._v("single")]),e._v(" and "),t("code",{pre:!0},[e._v("database")]),e._v(", each of them containing a driver and its configuration.\nThose channels will be detailed later in this page.")]),t("h2",[e._v("The logger service")]),t("p",[e._v("The logger service offers a fluent way to log messages for a specific level.\nIt follows the PHP's "),t("a",{attrs:{href:"https://www.php-fig.org/psr/psr-3/#3-psrlogloggerinterface"}},[e._v("PSR-3 LoggerInterface")]),e._v(" which specifies these methods for a logger:")]),t("ul",[t("li",[t("code",{pre:!0},[e._v("emergency(message, context = {})")])]),t("li",[t("code",{pre:!0},[e._v("alert(message, context = {})")])]),t("li",[t("code",{pre:!0},[e._v("critical(message, context = {})")])]),t("li",[t("code",{pre:!0},[e._v("error(message, context = {})")])]),t("li",[t("code",{pre:!0},[e._v("warning(message, context = {})")])]),t("li",[t("code",{pre:!0},[e._v("notice(message, context = {})")])]),t("li",[t("code",{pre:!0},[e._v("info(message, context = {})")])]),t("li",[t("code",{pre:!0},[e._v("debug(message, context = {})")])]),t("li",[t("code",{pre:!0},[e._v("log(level, message, context = {})")])])]),t("p",[e._v("Like other services in Node IoC, the logger uses drivers that handle logging implementation.\nThe logger service exposes all those methods to call the driver's "),t("code",{pre:!0},[e._v("log")]),e._v(" method, with the appropriate level.")]),t("h3",[e._v("Level threshold")]),t("p",[e._v("For each channel, a "),t("code",{pre:!0},[e._v("level")]),e._v(" configuration can be set to prevent to log level that you don't need to log.\nFor instance, you may want to log everything in your "),t("code",{pre:!0},[e._v("single")]),e._v(" channel but prevent any log under the "),t("code",{pre:!0},[e._v("error")]),e._v(" level to be logged in the database.")]),t("h2",[e._v("Channels")]),t("p",[e._v("Channels are basically drivers with a custom configuration.\nNode IoC offers three drivers, and three channels using each of the drivers.\nYou can, of course, create your own channels with existing drivers, or create your own driver and create one or many channels with it.")]),t("h3",[e._v("Single channel")]),t("p",[e._v("The "),t("code",{pre:!0},[e._v("single")]),e._v(" channel uses the "),t("code",{pre:!0},[e._v("file")]),e._v(" driver to log into the "),t("code",{pre:!0},[e._v("storage/logs/ioc.log")]),e._v(" file.\nIt writes in a single file, specified by the "),t("code",{pre:!0},[e._v("path")]),e._v(" configuration, but limits its size based on the "),t("code",{pre:!0},[e._v("limit")]),e._v(" configuration, which is "),t("code",{pre:!0},[e._v("10mb")]),e._v(" by default.")]),t("h3",[e._v("Database channel")]),t("p",[e._v("The "),t("code",{pre:!0},[e._v("database")]),e._v(" channel, through the "),t("code",{pre:!0},[e._v("database")]),e._v(" driver, logs in a configured table, based on the "),t("code",{pre:!0},[e._v("table")]),e._v(" configuration, through the configured connection, based on the "),t("code",{pre:!0},[e._v("connection")]),e._v(" configuration.\nThe connection refers to the "),t("code",{pre:!0},[e._v("database.connections")]),e._v(" available connections.\nThe "),t("code",{pre:!0},[e._v("default")]),e._v(" value can be used to use the default configured database connection.\nIt also offers to limit the record count through the "),t("code",{pre:!0},[e._v("limit")]),e._v(" configuration, which is a thousand by default.")]),t("h4",[e._v("The log:table command")]),t("p",[e._v("In order to use the "),t("code",{pre:!0},[e._v("database")]),e._v(" driver, you will need to run a migration that creates the configured table name with the expected columns.\nThe "),t("code",{pre:!0},[e._v("log:table")]),e._v(" will create a scaffold of the needed migration for your "),t("code",{pre:!0},[e._v("database")]),e._v(" channel.\nIf you need more than one log table, you will need to manually duplicate the migration and change the table name.")]),t("h3",[e._v("Stack channel")]),t("p",[e._v("The "),t("code",{pre:!0},[e._v("stack")]),e._v(" channel is very interesting since it uses the "),t("code",{pre:!0},[e._v("stack")]),e._v(" driver, which logs through other channels, all at the same time.")]),t("p",[e._v("By default, the stack channel logs through the "),t("code",{pre:!0},[e._v("single")]),e._v(" channel.\nYou can add or change the channels through the "),t("code",{pre:!0},[e._v("channels")]),e._v(" configuration.")]),t("p",[e._v("Let's say for instance that you want to log into the database, so you can display the records on an administrator page, but you also want to write in a file that you can easily download for debugging, without having to fetch the database records.\nThe stack channel is then the perfect choice.")]),t("p",[e._v("If you need to log in multiple channels but change the channels depending on the environment, you can create multiple stack channels, with different channels in them, and change the default channel through the "),t("code",{pre:!0},[e._v("LOG_CHANNEL")]),e._v(" environment variable.")])])}],n=t("2877"),o={},l=Object(n["a"])(o,a,r,!1,null,null,null);s["default"]=l.exports},"1cba":function(e,s,t){"use strict";var a=t("9c50"),r=t.n(a);r.a},"1fc4":function(e,s,t){},2191:function(e,s,t){"use strict";var a=t("4e29"),r=t.n(a);r.a},2233:function(e,s,t){"use strict";t.r(s);var a=function(){var e=this,s=e.$createElement;e._self._c;return e._m(0)},r=[function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("section",[t("h1",[e._v("Directory structure")]),t("h2",[e._v("Root folder")]),t("p",[e._v("The root folder contains some important files that drive the application, as well as style and standards files.")]),t("h3",[e._v("ioc")]),t("p",[e._v("The "),t("code",{pre:!0},[e._v("ioc")]),e._v(" file is the starting point for your application through the CLI.\nIt will only load the main application file, "),t("code",{pre:!0},[e._v("dist/node/index.js")]),e._v(" by default.\nIt allows the use of the base command "),t("code",{pre:!0},[e._v("node ioc")]),e._v(".")]),t("h3",[e._v(".env")]),t("p",[e._v("The "),t("code",{pre:!0},[e._v(".env")]),e._v(" file is used to merge custom environment variables to the global ones.\nIt will (and should be) ignored by Git, since it can contain sensitive data, such as passwords, key-secret pairs, etc.")]),t("p",[e._v("The "),t("code",{pre:!0},[e._v(".env.example")]),e._v(" is there to be used as a reference for your project.\nFeel free to change the example file while you develop your application to keep track of the changes, and the new used variables.\nHowever, you should not write sensitive data in the example file, since it is part of your Git history.")]),t("p",[e._v("The "),t("code",{pre:!0},[e._v("APP_ENV")]),e._v(" key in your "),t("code",{pre:!0},[e._v(".env")]),e._v(" file defines the application environment.\nIf you want to do a quick smoke test, simply change the value in the "),t("code",{pre:!0},[e._v(".env")]),e._v(" file and run the following command:")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-bash"}},[e._v("node ioc env\n")])]),t("p",[e._v("This command displays the current application environment.\nYou can rapidly make sure the environment file is properly loaded.")]),t("h3",[e._v("Node tester, ESLint and EditorConfig")]),t("p",[e._v("To ensure that your application has the best code style, the "),t("a",{attrs:{href:"https://absolunet.com"}},[e._v("Absolunet")]),t("a",{attrs:{href:"https://github.com/absolunet/node-tester"}},[e._v("Node Tester")]),e._v(" offers standards tests that parse your files for styling issues.")]),t("p",[e._v("First, it uses the "),t("code",{pre:!0},[e._v(".editorconfig")]),e._v(" file to test basic code style for specified file extensions.")]),t("p",[e._v("Then, the popular "),t("a",{attrs:{href:"https://eslint.org/"}},[e._v("ESLint")]),e._v(" is run through your entire application.\nThe "),t("code",{pre:!0},[e._v(".eslintrc.yaml")]),e._v(" defines the rules that apply to your project.\nThe "),t("code",{pre:!0},[e._v(".eslintignore")]),e._v(" file adds exceptions for some files through folders and patterns.\nFor information, you may read the "),t("a",{attrs:{href:"https://eslint.org/docs/user-guide/configuring"}},[e._v("official documentation")]),e._v(".")]),t("p",[e._v("To run the standards tests, run the following commands")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-bash"}},[e._v("npm run "),t("span",{pre:!0,attrs:{class:"hljs-built_in"}},[e._v("test")]),e._v(":standards\n")])]),t("h3",[e._v("Node Manager")]),t("p",[e._v("The "),t("a",{attrs:{href:"https://absolunet.com"}},[e._v("Absolunet")]),t("a",{attrs:{href:"https://github.com/absolunet/node-manager"}},[e._v("Node Manager")]),e._v(" is a great tool for you to use that makes node applications and packages very simple to maintain.\nThe "),t("code",{pre:!0},[e._v("manager.js")]),e._v(" file defines your current project type (it is already defined for you) and your "),t("code",{pre:!0},[e._v("package.json")]),e._v(" file defines all the commands that handle compilation, outdated dependencies check, documentation generation through "),t("a",{attrs:{href:"https://jsdoc.app/"}},[e._v("JSDoc")]),e._v(" and package deployment through an NPM registry, such as "),t("a",{attrs:{href:"https://npmjs.com"}},[e._v("npmjs.com")]),e._v(".")]),t("p",[e._v("To compile your application, you can run the following command:")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-bash"}},[e._v("npm run manager:build\n")])]),t("p",[e._v("All the different commands are defined in the "),t("code",{pre:!0},[e._v("package.json")]),e._v(" file.")]),t("h2",[e._v("Source folder")]),t("p",[e._v("The "),t("em",[e._v("source")]),e._v(" folder is located under "),t("code",{pre:!0},[e._v("[root]/src")]),e._v(".\nIt contains the application source code.\nThose are mainly JavaScript class files.\nThe source directory will be explored in detail later in this page.")]),t("h3",[e._v("Application folder")]),t("p",[e._v("The "),t("em",[e._v("bootstrap")]),e._v(" folder is located under "),t("code",{pre:!0},[e._v("[root]/src/app")]),e._v(".\nIt contains all your application-specific class files.")]),t("h4",[e._v("Console folder")]),t("p",[e._v("The "),t("em",[e._v("console")]),e._v(" folder is located under "),t("code",{pre:!0},[e._v("[root]/src/app/console")]),e._v(".\nIt contains all your console-related files, such as the main Kernel and the application command classes.")]),t("h4",[e._v("Exceptions folder")]),t("p",[e._v("The "),t("em",[e._v("exceptions")]),e._v(" folder is located under "),t("code",{pre:!0},[e._v("[root]/src/app/exceptions")]),e._v(".\nIt contains the main exception handler, as well as custom error classes.")]),t("h4",[e._v("HTTP folder")]),t("p",[e._v("The "),t("em",[e._v("HTTP")]),e._v(" folder is located under "),t("code",{pre:!0},[e._v("[root]/src/app/http")]),e._v(".\nIt contains all your HTTP-related classes, such as the controllers.")]),t("h4",[e._v("Providers folder")]),t("p",[e._v("The "),t("em",[e._v("providers")]),e._v(" folder is located under "),t("code",{pre:!0},[e._v("[root]/src/app/providers")]),e._v(".\nIt contains all your application service providers.\nBy default, it contains "),t("code",{pre:!0},[e._v("AppServiceProvider.js")]),e._v(" and "),t("code",{pre:!0},[e._v("RouteServiceProvider.js")]),e._v(".")]),t("h3",[e._v("Bootstrap folder")]),t("p",[e._v("The "),t("em",[e._v("bootstrap")]),e._v(" folder is located under "),t("code",{pre:!0},[e._v("[root]/src/bootstrap")]),e._v(".\nIt contains the application bootstrap process file.")]),t("h3",[e._v("Database folder")]),t("p",[e._v("The "),t("em",[e._v("database")]),e._v(" folder is located under "),t("code",{pre:!0},[e._v("[root]/src/database")]),e._v(".\nIt contains all the database-related files, such as the migrations, the models, the seeders and the model factories.")]),t("h3",[e._v("Routes folder")]),t("p",[e._v("The "),t("em",[e._v("routes")]),e._v(" folder is located under "),t("code",{pre:!0},[e._v("[root]/src/routes")]),e._v(".\nIt contains all the application routes, by default split in two different files: "),t("code",{pre:!0},[e._v("web.js")]),e._v(" and "),t("code",{pre:!0},[e._v("api.js")]),e._v(".")]),t("h2",[e._v("Configuration folder")]),t("p",[e._v("The "),t("em",[e._v("configuration")]),e._v(" folder is located at "),t("code",{pre:!0},[e._v("[root]/config")]),e._v(".\nIt contains all the application configuration split into namespaces represented by files.")]),t("p",[e._v("By default, you should retrieve the following files:")]),t("ul",[t("li",[t("code",{pre:!0},[e._v("app.yaml")])]),t("li",[t("code",{pre:!0},[e._v("cache.yaml")])]),t("li",[t("code",{pre:!0},[e._v("database.yaml")])]),t("li",[t("code",{pre:!0},[e._v("dev.yaml")])]),t("li",[t("code",{pre:!0},[e._v("events.yaml")])]),t("li",[t("code",{pre:!0},[e._v("http.yaml")])]),t("li",[t("code",{pre:!0},[e._v("logging.yaml")])]),t("li",[t("code",{pre:!0},[e._v("view.yaml")])])]),t("p",[e._v("Feel free to add any file you want.\nWe suggest that the files uses the "),t("code",{pre:!0},[e._v(".yaml")]),e._v(" extension, but the "),t("code",{pre:!0},[e._v(".js")]),e._v(", "),t("code",{pre:!0},[e._v(".json")]),e._v(" and "),t("code",{pre:!0},[e._v("yml")]),e._v(" extensions are all supported.\nPlease note that commonJS syntax must be used in JavaScript configuration files since they are not compiled by the Node Manager.")]),t("h2",[e._v("Distribution folder")]),t("p",[e._v("The "),t("em",[e._v("distribution")]),e._v(" folder is located under "),t("code",{pre:!0},[e._v("[root]/dist")]),e._v(".\nIt contains the compiled application files.\nYou should never directly edit those files since they will be overwritten when compiling the application.\nYou should always code in the "),t("code",{pre:!0},[e._v("src")]),e._v(" folder.")]),t("h2",[e._v("Documentation folder")]),t("p",[e._v("The "),t("em",[e._v("documentation")]),e._v(" folder is located under "),t("code",{pre:!0},[e._v("[root]/docs")]),e._v(".\nSince the application comes with the Node Manager by default, you have access to a JSDoc documentation website that is generated by the source code comments.")]),t("p",[e._v("This folder will not be publicly accessible through the default application server routes but can be deployed separately on another server (such as "),t("a",{attrs:{href:"https://github.blog/2016-08-22-publish-your-project-documentation-with-github-pages/"}},[e._v("Github pages")]),e._v(", or any custom server).\nThis should be used only by developers.")]),t("h2",[e._v("Node modules")]),t("p",[e._v("The "),t("code",{pre:!0},[e._v("node_modules")]),e._v(" contains all the required dependencies of the project.\nThis folder should never be edited and is generated when installing NPM packages.\nIt contains the Node IoC framework, as well as its dependencies, and other custom dependencies.")]),t("h2",[e._v("Resources folder")]),t("p",[e._v("The "),t("em",[e._v("resources")]),e._v(" folder is located under "),t("code",{pre:!0},[e._v("[root]/resources")]),e._v(".\nNot to be confused with the source "),t("em",[e._v("code")]),e._v(" folder ("),t("code",{pre:!0},[e._v("src")]),e._v("), the "),t("em",[e._v("resources")]),e._v(" folder contains the application resources\nfiles, such as static files, HTML templates, etc.\nIt does not contain any back-end related JavaScript files.")]),t("p",[e._v("However, some of those files are used by the application.")]),t("h3",[e._v("Language folder")]),t("p",[e._v("The "),t("em",[e._v("language")]),e._v(" folder is located under "),t("code",{pre:!0},[e._v("[root]/resources/lang")]),e._v(".\nIt contains all the translation files, with at least "),t("code",{pre:!0},[e._v("translations.yaml")]),e._v(", the default one.")]),t("h3",[e._v("Static folder")]),t("p",[e._v("The "),t("em",[e._v("static")]),e._v(" folder is located under "),t("code",{pre:!0},[e._v("[root]/resources/static")]),e._v(".\nIt contains any static files that can be used by your web application, such as the favicon, images, CSS, front-end JavaScript files, etc.\nHowever, the uploaded content should not go there.\nThose files will be tracked by Git and should be managed by the developers.")]),t("h3",[e._v("Views folder")]),t("p",[e._v("The "),t("em",[e._v("views")]),e._v(" folder is located under "),t("code",{pre:!0},[e._v("[root]/resources/views")]),e._v(".\nIt contains all the HTML templates for your web application.\nSome of them already exist by default to show an example of how the Node IoC web application templating system works.")]),t("p",[e._v("Those templates should not be used by the front-end engine, such as React or Vue.js, but only by the Node IoC back-end application.")]),t("h2",[e._v("Storage folder")]),t("p",[e._v("The "),t("em",[e._v("storage")]),e._v(" folder is located under "),t("code",{pre:!0},[e._v("[root]/storage")]),e._v(".\nIt contains files that should be stored by the application, but that are environment-specific.\nIt contains cached data, logs, uploaded files, SQLite databases, etc.\nBy default, the existing folder content is not tracked by Git.")]),t("h3",[e._v("Databases storage folder")]),t("p",[e._v("The "),t("em",[e._v("databases")]),e._v(" storage folder is located under "),t("code",{pre:!0},[e._v("[root]/storage/databases")]),e._v(".\nIt contains all the application SQLite databases.\nOf course, it will not be part of the Git history.")]),t("p",[e._v("Deleting the content means that the data stored in the database is lost forever.\nThis folder is sensitive and should be well protected.")]),t("h3",[e._v("Framework storage folder")]),t("p",[e._v("The "),t("em",[e._v("framework")]),e._v(" storage folder is located under "),t("code",{pre:!0},[e._v("[root]/storage/framework")]),e._v(".\nIt contains all the framework-specific files.\nNormally, you should not be concerned with this folder.")]),t("p",[e._v("However, it is important to know that the file cache driver uses this folder to store data into "),t("code",{pre:!0},[e._v(".json")]),e._v(" files.\nDeleting the files will only affect the application cache and should not break anything.\nHowever, they can be created again by the application.")]),t("h3",[e._v("Logs storage folder")]),t("p",[e._v("The "),t("em",[e._v("logs")]),e._v(" storage folder is located under "),t("code",{pre:!0},[e._v("[root]/storage/logs")]),e._v(".\nAll the application logs are dropped in this folder.\nYou can delete the content anytime, but the logs will be lost.\nThe log file driver can create files again anytime.")]),t("h3",[e._v("Uploads storage folder")]),t("p",[e._v("The "),t("em",[e._v("uploads")]),e._v(" storage folder is located under "),t("code",{pre:!0},[e._v("[root]/storage/uploads")]),e._v(".\nIt contains all the files that were uploaded by the application.\nBy default, they are considered as private, but they will be publicly accessible if put into the "),t("code",{pre:!0},[e._v("[root]/storage/uploads/public")]),e._v(" folder.\nThis behavior can be changed anytime by changing the routes.")]),t("h2",[e._v("Tests folder")]),t("p",[e._v("The "),t("em",[e._v("tests")]),e._v(" folder is located under "),t("code",{pre:!0},[e._v("[root]/test/")]),e._v(".\nIt contains all the application tests, split by types.")]),t("ul",[t("li",[e._v("unit")]),t("li",[e._v("feature")]),t("li",[e._v("integration")]),t("li",[e._v("endtoend")]),t("li",[e._v("generic")])]),t("p",[e._v("The "),t("code",{pre:!0},[e._v("unit")]),e._v(", "),t("code",{pre:!0},[e._v("feature")]),e._v(", "),t("code",{pre:!0},[e._v("integration")]),e._v(" and "),t("code",{pre:!0},[e._v("endtoend")]),e._v(" tests are all the same, except that they are namespaced by purpose,\nand they run with different commands.")]),t("p",[e._v("The "),t("code",{pre:!0},[e._v("generic")]),e._v(" tests are all the standards tests run by the Node tester.")]),t("p",[e._v("When running "),t("code",{pre:!0},[e._v("npm test")]),e._v(", it will go through all the standards tests, and will then run all the other test types one after the other.")]),t("p",[e._v("When running "),t("code",{pre:!0},[e._v("npm run test:unit")]),e._v(", it will only run unit tests.\nIt is true for all the default test folders.")]),t("p",[e._v("The "),t("code",{pre:!0},[e._v("bootstrap")]),e._v(" folder should not be touched.\nIt contains the tests bootstrapper.\nHowever, if you need to do anything regarding the application bootstrap in a test environment, feel free to do so.")])])}],n=t("2877"),o={},l=Object(n["a"])(o,a,r,!1,null,null,null);s["default"]=l.exports},2672:function(e,s,t){},"26d5":function(e){e.exports={app:{name:"Node IoC",repository:"https://github.com/absolunet/node-ioc-app",date:{since:"2019"},author:{name:"Absolunet",link:"https://absolunet.com"}},license:{type:"MIT",link:"https://github.com/absolunet/node-ioc/blob/master/license"},error:{404:"It's dark in here..."},catchPhrases:{heart:"❤︎","hard work":"hard work","heated debates":"heated debates","cold sweats":"cold sweats","bad puns":"bad puns","coffee & tea":"coffee & tea"},"Made with":"Made with",by:"by","You are here":"You are here",Home:"Home","View on GitHub":"View on GitHub","A complete Node.js ecosystem with an elegant syntax to drive sparkling ideas":"A complete Node.js ecosystem with an elegant syntax to drive sparkling ideas","Get started!":"Get started!",menu:{"getting-started":"Getting started",installation:"Installation","directory-structure":"Directory structure",architecture:"Architecture",lifecycle:"Lifecycle",container:"Container","service-provider":"Service Provider","first-steps":"First steps","create-a-command":"Create a command","create-a-web-page":"Create a Web page","create-an-api-endpoint":"Create an API endpoint","create-a-service":"Create a service",basics:"Basics",configuration:"Configuration",commands:"Commands",routing:"Routing",views:"Views",data:"Data",database:"Database",models:"Models",factories:"Factories","migrations-and-seeders":"Migrations and seeders","http-client":"HTTP client",cache:"Cache","going-deeper":"Going deeper","exception-handling":"Exception handling",drivers:"Drivers",events:"Events","file-system":"File system",helpers:"Helpers",log:"Log","multiple-inheritances":"Multiple inheritances",security:"Security",translation:"Translation",validation:"Validation",tests:"Tests","test-commands":"Test commands","test-class":"Test class"},path:{"/getting-started/installation":"/getting-started/installation","/getting-started/directory-structure":"/getting-started/directory-structure","/architecture/lifecycle":"/architecture/lifecycle","/architecture/container":"/architecture/container","/architecture/service-provider":"/architecture/service-provider","/first-steps/create-a-command":"/first-steps/create-a-command","/first-steps/create-a-web-page":"/first-steps/create-a-web-page","/first-steps/create-an-api-endpoint":"/first-steps/create-an-api-endpoint","/first-steps/create-a-service":"/first-steps/create-a-service","/basics/configuration":"/basics/configuration","/basics/commands":"/basics/commands","/basics/routing":"/basics/routing","/basics/views":"/basics/views","/data/database":"/data/database","/data/models":"/data/models","/data/factories":"/data/factories","/data/migrations-and-seeders":"/data/migrations-and-seeders","/data/http-client":"/data/http-client","/data/cache":"/data/cache","/going-deeper/exception-handling":"/going-deeper/exception-handling","/going-deeper/drivers":"/going-deeper/drivers","/going-deeper/events":"/going-deeper/events","/going-deeper/file-system":"/going-deeper/file-system","/going-deeper/helpers":"/going-deeper/helpers","/going-deeper/log":"/going-deeper/log","/going-deeper/multiple-inheritances":"/going-deeper/multiple-inheritances","/going-deeper/security":"/going-deeper/security","/going-deeper/translation":"/going-deeper/translation","/going-deeper/validation":"/going-deeper/validation","/tests/test-commands":"/tests/test-commands","/tests/test-class":"/tests/test-class"}}},"27a9":function(e,s,t){"use strict";t.r(s);var a=function(){var e=this,s=e.$createElement;e._self._c;return e._m(0)},r=[function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("section",[t("h1",[e._v("Commands")]),t("h2",[e._v("Introduction")]),t("p",[e._v("The commands are the main entry point for CLI users.\nIt acts as both CLI routes and controllers, for those who work with MVC architecture.")]),t("p",[e._v("A command is used to handle a CLI request through a structured, standardized and simplified system.\nEach command is represented by a "),t("code",{pre:!0},[e._v("Command")]),e._v(" class file, with some methods and accessors that must be implemented to work properly.")]),t("p",[e._v("We will go through everything you need to get started properly in your Node IoC application.")]),t("h2",[e._v("Auto-registration")]),t("p",[e._v("In the application, the commands are located in the "),t("code",{pre:!0},[e._v("src/app/console/commands")]),e._v(" folder.\nBy default, an application has no command, but Node IoC makes it a breeze to create a command.\nTo have a quick introduction to commands, you may want to start with the "),t("code",{pre:!0},[e._v("Create a command")]),e._v(" first step.")]),t("p",[e._v("All the commands in the "),t("code",{pre:!0},[e._v("commands")]),e._v(" folder are automatically loaded by the application kernel ("),t("code",{pre:!0},[e._v("src/app/console/Kernel.js")]),e._v("), before handling the request.\nAt the auto-registration point, all the service providers were booted, so all the services are available and can be injected.")]),t("p",[e._v("For the commands, there are no dynamic namespaces based on the folder structure, so you can organize your commands the way you want in the dedicated folder.")]),t("h2",[e._v("The Command class")]),t("h3",[e._v("Basics")]),t("p",[e._v("Node IoC exposes a "),t("code",{pre:!0},[e._v("Command")]),e._v(" class that all commands should extend.\nIt offers everything you need to work in the CLI system of Node IoC without any effort.")]),t("p",[e._v("Some methods and accessors are abstracts and must be implemented.\nLet's take a small peak on critical ones.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("import")]),e._v(" { Command } "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("from")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'@absolunet/ioc'")]),e._v(";\n\n\n"),t("span",{pre:!0,attrs:{class:"hljs-class"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("class")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("MyCommand")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("extends")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("Command")]),e._v(" ")]),e._v("{\n\n    "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("get")]),e._v(" name() {\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'my:command'")]),e._v("\n    }\n\n    handle() {\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".info("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'Handling my command...'")]),e._v(");\n    }\n\n}\n\n\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("export")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("default")]),e._v(" MyCommand;\n")])]),t("p",[e._v("The "),t("code",{pre:!0},[e._v("name")]),e._v(" accessor and the "),t("code",{pre:!0},[e._v("handle")]),e._v(" at least method must be implemented.")]),t("p",[e._v("The "),t("code",{pre:!0},[e._v("name")]),e._v(" accessor is the command name fronted in the CLI system.\nWhen executing "),t("code",{pre:!0},[e._v("node ioc my:command")]),e._v(", the command registrar understands that the command should be handled by a "),t("code",{pre:!0},[e._v("MyCommand")]),e._v(" instance.\nWhen the command must be handled, the "),t("code",{pre:!0},[e._v("handle")]),e._v(" method is called and awaited.\nIn the "),t("code",{pre:!0},[e._v("handle")]),e._v(" method, you can do whatever you like.\nThe "),t("code",{pre:!0},[e._v("handle")]),e._v(" method can be made "),t("code",{pre:!0},[e._v("async")]),e._v(" anytime or can return a promise.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-class"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("class")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("MyCommand")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("extends")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("Command")]),e._v(" ")]),e._v("{\n\n    "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("static")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("get")]),e._v(" dependencies() {\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" ["),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'my.service'")]),e._v(", "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'my.other.service'")]),e._v("];\n    }\n\n    "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("get")]),e._v(" name() {\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'my:command'")]),e._v("\n    }\n\n    "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("async")]),e._v(" handle() {\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("try")]),e._v(" {\n            "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("const")]),e._v(" data = "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("await")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".myService.fetchSomething();\n            "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("await")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".myOtherService.doSomething(data);\n    \n            "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".success("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'Something was done successfully!'")]),e._v(");\n        } "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("catch")]),e._v(" (error) {\n            "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".failure("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'Please try again, something went wrong...'")]),e._v(");\n\n            "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("throw")]),e._v(" error;\n        }\n    }\n\n}\n")])]),t("p",[e._v("You can also add a description to your command for more verbosity.\nBy default, the command description is the command name.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-class"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("class")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("MyCommand")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("extends")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("Command")]),e._v(" ")]),e._v("{\n\n    "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("get")]),e._v(" name() {\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'my:command'")]),e._v("\n    }\n\n    "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("get")]),e._v(" description() {\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'Do something awesome!'")]),e._v(";\n    }\n\n}\n")])]),t("h3",[e._v("Arguments")]),t("p",[e._v("A command can be useful to perform generic actions but are way more powerful when accepting arguments, such as "),t("code",{pre:!0},[e._v("parameters")]),e._v(", "),t("code",{pre:!0},[e._v("options")]),e._v(" and "),t("code",{pre:!0},[e._v("flags")]),e._v(".")]),t("blockquote",[t("p",[e._v("A "),t("strong",[e._v("parameter")]),e._v(" is a value that follows the command, without the "),t("code",{pre:!0},[e._v("--")]),e._v(" prefix, such as "),t("code",{pre:!0},[e._v("name:command parameter")]),e._v(".")]),t("p",[e._v("An "),t("strong",[e._v("option")]),e._v(" is a value that follows an option name, such as "),t("code",{pre:!0},[e._v("name:command --option=value")]),e._v(".")]),t("p",[e._v("A "),t("strong",[e._v("flag")]),e._v(" is a boolean status that is set to "),t("code",{pre:!0},[e._v("true")]),e._v(" when present, such as "),t("code",{pre:!0},[e._v("name:command --flag")]),e._v(".")])]),t("p",[e._v("By default, some options and flags are available for all commands.")]),t("ul",[t("li",[t("p",[t("code",{pre:!0},[e._v("--help")])]),t("blockquote",[t("p",[e._v("Flag.\nDisplay the command signature, description, and available options and flags")])])]),t("li",[t("p",[t("code",{pre:!0},[e._v("--version")])]),t("blockquote",[t("p",[e._v("Flag.\nDisplay the application version, regardless of the executed command")])])]),t("li",[t("p",[t("code",{pre:!0},[e._v("--verbose, -v")])]),t("blockquote",[t("p",[e._v("Flag, cumulative.\nUse more verbosity.")])]),t("ul",[t("li",[t("code",{pre:!0},[e._v("--verbose")]),e._v(": 1")]),t("li",[t("code",{pre:!0},[e._v("--verbose --verbose")]),e._v(": 2")]),t("li",[t("code",{pre:!0},[e._v("--verbose --verbose --verbose")]),e._v(": 3")]),t("li",[t("code",{pre:!0},[e._v("-v")]),e._v(": 1")]),t("li",[t("code",{pre:!0},[e._v("-vv")]),e._v(": 2")]),t("li",[t("code",{pre:!0},[e._v("-vvv")]),e._v(": 3")])])])]),t("h4",[e._v("Parameters")]),t("p",[e._v("A parameter has a name that is used for the command signature and inside the command to retrieve its value.")]),t("p",[e._v("A parameter has a name, can be required, can have a default value and can have a description.")]),t("p",[e._v("To support an argument, you can use the "),t("code",{pre:!0},[e._v("parameters")]),e._v(" accessor.\nBy default, there are no parameters.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-class"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("class")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("MyCommand")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("extends")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("Command")]),e._v(" ")]),e._v("{\n\n    "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("get")]),e._v(" name() {\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'my:command'")]),e._v(";\n    }\n\n    "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("get")]),e._v(" parameters() {\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" [\n            "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v('// { name: "foo", required: true,  defaultValue: null,    description: "" }')]),e._v("\n            ["),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'foo'")]),e._v("],\n\n            "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v('// { name: "bar", required: true,  defaultValue: null,    description: "" }')]),e._v("\n            ["),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'bar'")]),e._v(", "),t("span",{pre:!0,attrs:{class:"hljs-literal"}},[e._v("true")]),e._v("],\n\n            "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v('// { name: "baz", required: false, defaultValue: "value", description: "" }')]),e._v("\n            ["),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'baz'")]),e._v(", "),t("span",{pre:!0,attrs:{class:"hljs-literal"}},[e._v("false")]),e._v(", "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'value'")]),e._v("],\n\n            "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v('// { name: "qux", required: false, defaultValue: "other", description: "A useful description" }')]),e._v("\n            ["),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'qux'")]),e._v(", "),t("span",{pre:!0,attrs:{class:"hljs-literal"}},[e._v("false")]),e._v(", "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'other'")]),e._v(", "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'A useful description'")]),e._v("]\n        ];\n    }\n\n    handle() {\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".info("),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".parameter("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'foo'")]),e._v("));\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".info("),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".parameter("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'bar'")]),e._v("));\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".info("),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".parameter("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'baz'")]),e._v("));\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".info("),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".parameter("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'qux'")]),e._v("));\n    }\n\n}\n")])]),t("p",[e._v("For this example, the signature would be this:")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":""}},[e._v("node ioc my:command <foo> <bar> [baz] [qux]\n")])]),t("p",[e._v("The "),t("code",{pre:!0},[e._v("foo")]),e._v(" and "),t("code",{pre:!0},[e._v("bar")]),e._v(" parameters would be required so that the "),t("code",{pre:!0},[e._v("handle")]),e._v(" method is called.\nThe "),t("code",{pre:!0},[e._v("baz")]),e._v(" and "),t("code",{pre:!0},[e._v("qux")]),e._v(" would be optional.")]),t("p",[e._v("These commands would work:")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":""}},[e._v("node ioc my:command some thing\n  some\n  thing\n  value\n  other\n\nnode ioc my:command some thing cool\n  some\n  thing\n  cool\n  other\n\nnode ioc my:command some thing very cool\n  some\n  thing\n  very\n  cool\n")])]),t("p",[e._v("These commands would not work:")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":""}},[e._v("node ioc my:command\n  YError: Not enough non-option arguments: got 0, need at least 2\n\nnode ioc my:command some\n  YError: Not enough non-option arguments: got 1, need at least 2\n")])]),t("p",[e._v("To implement parameters properly, required parameters should always be on the top of the array, and the optional ones, at the bottom, the same way we would do in a function or a method.")]),t("h4",[e._v("Options")]),t("p",[e._v("An option has a name that is used when calling the command and when retrieving its value.\nBy default, an option is, of course, optional.")]),t("p",[e._v("An option has a name, can have a default value and can have a description.")]),t("p",[e._v("To support an option, you can use the "),t("code",{pre:!0},[e._v("options")]),e._v(" accessor.\nBy default, there are no options.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-class"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("class")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("MyCommand")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("extends")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("Command")]),e._v(" ")]),e._v("{\n\n    "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("get")]),e._v(" name() {\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'my:command'")]),e._v(";\n    }\n\n    "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("get")]),e._v(" options() {\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" [\n            "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v('// { name: "foo", defaultValue: null,    description: "" }')]),e._v("\n            ["),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'foo'")]),e._v("],\n\n            "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v('// { name: "bar", defaultValue: "value", description: "" }')]),e._v("\n            ["),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'bar'")]),e._v(", "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'value'")]),e._v("],\n\n            "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v('// { name: "baz", defaultValue: "value", description: "An option description" }')]),e._v("\n            ["),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'baz'")]),e._v(", "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'quz'")]),e._v(", "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'An option description'")]),e._v("],\n        ];\n    }\n\n    handle() {\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".info("),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".option("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'foo'")]),e._v("));\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".info("),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".option("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'bar'")]),e._v("));\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".info("),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".option("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'baz'")]),e._v("));\n    }\n\n}\n")])]),t("p",[e._v("For this example, the signature would be this:")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-bash"}},[e._v("node ioc my:"),t("span",{pre:!0,attrs:{class:"hljs-built_in"}},[e._v("command")]),e._v(" [--foo=null] [--bar=value] [--baz=qux]\n")])]),t("p",[e._v("These commands would work:")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":""}},[e._v("node ioc my:command\n  null\n  value\n  qux\n\nnode ioc my:command --foo=\n  \n  value\n  qux\n\nnode ioc my:command --foo=something\n  something\n  value\n  qux\n\nnode ioc my:command --bar=cool\n  null\n  cool\n  qux\n\nnode ioc my:command --baz=awesome\n  null\n  value\n  awesome\n\nnode ioc my:command --foo=a --bar=b --baz=c\n  a\n  b\n  c\n")])]),t("p",[e._v("The option declaration order, both in the class and in the CLI command, has no impact whatsoever.")]),t("h4",[e._v("Flags")]),t("p",[e._v("A flag has a name that is used when calling the command and when retrieving its value.\nBy default, a flag is, optional.\nIts default value is always "),t("code",{pre:!0},[e._v("false")]),e._v(".\nIt does not accept any value.\nWhen present, its value is "),t("code",{pre:!0},[e._v("true")]),e._v(".")]),t("p",[e._v("A flag has a name and can have a description.")]),t("p",[e._v("To support a flag, you can use the "),t("code",{pre:!0},[e._v("flags")]),e._v(" accessor.\nBy default, there are no flags.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-class"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("class")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("MyCommand")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("extends")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("Command")]),e._v(" ")]),e._v("{\n\n    "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("get")]),e._v(" name() {\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'my:command'")]),e._v(";\n    }\n\n    "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("get")]),e._v(" flags() {\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" [\n            "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v('// { name: "foo", description: "" }')]),e._v("\n            ["),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'foo'")]),e._v("],\n\n            "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v('// { name: "bar", description: "A flag description" }')]),e._v("\n            ["),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'bar'")]),e._v(", "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'A flag description'")]),e._v("]\n        ];\n    }\n\n    handle() {\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".info("),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".flag("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'foo'")]),e._v("));\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".info("),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".flag("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'bar'")]),e._v("));\n    }\n\n}\n")])]),t("p",[e._v("For this example, the signature would be this:")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-bash"}},[e._v("node ioc my:"),t("span",{pre:!0,attrs:{class:"hljs-built_in"}},[e._v("command")]),e._v(" [--foo] [--bar]\n")])]),t("p",[e._v("These commands would work:")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":""}},[e._v("node ioc my:command\n  false\n  false\n\nnode ioc my:command --foo\n  true\n  false\n\nnode ioc my:command --bar\n  false\n  true\n\nnode ioc my:command --foo --bar\n  true\n  true\n")])]),t("h3",[e._v("Handle command")]),t("p",[e._v("By default, the only method that must be implemented to properly handle the command request is "),t("code",{pre:!0},[e._v("handle")]),e._v(".\nHowever, the command lifecycle offers two other methods to act before and after, called "),t("code",{pre:!0},[e._v("preprocess")]),e._v(" and "),t("code",{pre:!0},[e._v("postprocess")]),e._v(".")]),t("h4",[e._v("Pre-process")]),t("p",[e._v("During the pre-process phase, we can change the Yargs "),t("code",{pre:!0},[e._v("argv")]),e._v(" object.\nLet's say that some flags become deprecated over time, and you want to adapt the handling code properly without the deprecated flags in it, you can transform the request object.\nIt acts as a command middleware.")]),t("p",[e._v("This method accepts an "),t("code",{pre:!0},[e._v("argv")]),e._v(" object and must return an "),t("code",{pre:!0},[e._v("argv")]),e._v(" object.\nBy default, it returns it without any manipulation.")]),t("h4",[e._v("Handle")]),t("p",[e._v("This method does not accept any argument, but at this point, you can use the "),t("code",{pre:!0},[e._v("parameter")]),e._v(", "),t("code",{pre:!0},[e._v("option")]),e._v(" and "),t("code",{pre:!0},[e._v("flag")]),e._v(" methods to get the request parameters.\nThis method processes the command.\nIf it returns a promise, the promise is awaited before moving to the next cycle.")]),t("p",[e._v("By the way, if you need some services to work, don't forget that you can inject services.\nIf you forgot to do so, or if you need service conditionally, the application is always available with the "),t("code",{pre:!0},[e._v("app")]),e._v(" property, as well as the "),t("code",{pre:!0},[e._v("terminal")]),e._v(".")]),t("h4",[e._v("Post-process")]),t("p",[e._v("The post-process phase may be used to do additional things after request handling.\nNormally, there is nothing to do since everything would be done in the handling phase, but it is useful for commands that are forwarding the request to another command that may have policies that do not expose it.\nForwarding is explained below.")]),t("h3",[e._v("Forward request")]),t("p",[e._v('Since some commands can be scoped with policies, which will be explained below, it may be useful to create a "public" command that forwards the call to a private command, with some preprocessing to format the arguments from your command to the private command, and postprocessing to act after the underlying command has properly handled the command.')]),t("p",[e._v("To forward the call to another command, you can either use the "),t("code",{pre:!0},[e._v("call")]),e._v(" method in your "),t("code",{pre:!0},[e._v("handle")]),e._v(" method or implement the "),t("code",{pre:!0},[e._v("forward")]),e._v(" accessor.")]),t("h4",[e._v("The call method")]),t("p",[e._v("You can call internal commands anytime by using the "),t("code",{pre:!0},[e._v("call")]),e._v(" method.")]),t("p",[e._v("Given a "),t("code",{pre:!0},[e._v("baz:qux")]),e._v(" private command, here is a simple implementation from a "),t("code",{pre:!0},[e._v("foo:bar")]),e._v(" public command.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-class"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("class")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("FooBarCommand")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("extends")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("Command")]),e._v(" ")]),e._v("{\n\n    "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("get")]),e._v(" name() {\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'foo:bar'")]),e._v(";\n    }\n\n    "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("async")]),e._v(" handle() {\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("await")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".call("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'baz:qux --option=value --flag'")]),e._v(");\n    }\n\n}\n")])]),t("p",[e._v("A command can be easily called without spawning any process under the hood.\nThe command registrar will resolve the command and execute it with the whole lifecycle.")]),t("h4",[e._v("The forward accessor")]),t("p",[e._v("The "),t("code",{pre:!0},[e._v("forward")]),e._v(" accessor is simply an easy way to "),t("code",{pre:!0},[e._v("call")]),e._v(" a command without having to handle it manually.")]),t("p",[e._v("If this accessor is implemented, the "),t("code",{pre:!0},[e._v("handle")]),e._v(" method will not be called in favor of a forwarding.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-class"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("class")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("FooBarCommand")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("extends")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("Command")]),e._v(" ")]),e._v("{\n\n    "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("get")]),e._v(" name() {\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'foo:bar'")]),e._v(";\n    }\n\n    "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("get")]),e._v(" forward() {\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'baz:qux'")]),e._v(";\n    }\n\n}\n")])]),t("p",[e._v("When forwarding a command call, the whole arguments are sent, in the same order, to the underlying command.\nThe whole argument configuration is taken from the underlying command instead of the current one.\nSo, implementing the "),t("code",{pre:!0},[e._v("parameter")]),e._v(", "),t("code",{pre:!0},[e._v("options")]),e._v(" and "),t("code",{pre:!0},[e._v("flags")]),e._v(" accessors will not impact how the command will be parsed when building it into Yargs.")]),t("p",[e._v("Consider the following "),t("code",{pre:!0},[e._v("baz:qux")]),e._v(" signature, here is the "),t("code",{pre:!0},[e._v("foo:bar")]),e._v(" command signature.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":""}},[e._v("node ioc baz:qux <one> [two] [--three=null] [four]\nnode ioc foo:bar <one> [two] [--three=null] [four]\n")])]),t("p",[e._v("The signature will be identical.\nBy default, if a command forwards to a command that also forwards to another command, the three commands will have the same signature, except for their name.\nTheir policies will be different too, so their public appearance will be different.")]),t("h3",[e._v("Policies")]),t("p",[e._v("The policies can be very useful to prevent commands to be publicly accessible from the CLI.\nThey are scoping access to the different commands from public access.\nHowever, their policies can be ignored when calling them by the code.")]),t("p",[e._v("The policies can be set from the "),t("code",{pre:!0},[e._v("policies")]),e._v(" accessor.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-class"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("class")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("MyCommand")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("extends")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("Command")]),e._v(" ")]),e._v("{\n\n    "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("get")]),e._v(" policies() {\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" ["),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'env:local'")]),e._v("];\n    }\n\n}\n")])]),t("p",[e._v("In this case, the "),t("code",{pre:!0},[e._v("env")]),e._v(" policy must pass, with the "),t("code",{pre:!0},[e._v("local")]),e._v(" argument, so the command can appear in the commands list.")]),t("p",[e._v("All the policies are checked with the "),t("code",{pre:!0},[e._v("gate")]),e._v(" service.\nPolicies can also be defined with this service.")]),t("p",[e._v("By default, a Node IoC application defines the "),t("code",{pre:!0},[e._v("public")]),e._v(", "),t("code",{pre:!0},[e._v("private")]),e._v(", "),t("code",{pre:!0},[e._v("env")]),e._v(", "),t("code",{pre:!0},[e._v("db")]),e._v(" and "),t("code",{pre:!0},[e._v("http")]),e._v(" policies.\nYou can read about it on the security page.")]),t("p",[e._v("Before bootstrapping Yargs, each registered command policies are checked before adding the command's signature to Yargs for public access.\nIf the policies fail, the command is ignored from Yargs bootstrapping.")]),t("h2",[e._v("Terminal")]),t("p",[e._v("The terminal is an extended version of the "),t("code",{pre:!0},[e._v("@absolunet/terminal")]),e._v(" package that offers a log of useful methods to print in the terminal, but also to prompt the user for information or to display data in tables.")]),t("p",[e._v("In a command, the terminal is automatically injected without an explicit dependency injection directive, as well as the application.\nHowever, some useful methods were created that abstracts the terminal to quickly use common command features.")]),t("ul",[t("li",[t("p",[t("code",{pre:!0},[e._v("write(...parameters)")])]),t("blockquote",[t("p",[e._v("Echo a message")])])]),t("li",[t("p",[t("code",{pre:!0},[e._v("info(...parameters)")])]),t("blockquote",[t("p",[e._v("Display a message with the primary color")])])]),t("li",[t("p",[t("code",{pre:!0},[e._v("log(...parameters)")])]),t("blockquote",[t("p",[e._v("Display a message with the primary color when the verbose level is greater than or equal to 1")])])]),t("li",[t("p",[t("code",{pre:!0},[e._v("debug(...parameters)")])]),t("blockquote",[t("p",[e._v("Display a message with the primary color when the verbose level is greater than or equal to 2")])])]),t("li",[t("p",[t("code",{pre:!0},[e._v("spam(...parameters)")])]),t("blockquote",[t("p",[e._v("Display a message with the primary color when the verbose level is greater than or equal to 3")])])]),t("li",[t("p",[t("code",{pre:!0},[e._v("success(...parameters)")])]),t("blockquote",[t("p",[e._v("Display a success message")])])]),t("li",[t("p",[t("code",{pre:!0},[e._v("warning(...parameters)")])]),t("blockquote",[t("p",[e._v("Display a warning message")])])]),t("li",[t("p",[t("code",{pre:!0},[e._v("failure(...parameters)")])]),t("blockquote",[t("p",[e._v("Display a failure message")])])]),t("li",[t("p",[t("code",{pre:!0},[e._v("ask(question, defaultAnswer)")])]),t("blockquote",[t("p",[e._v("Ask a question to the user")])])]),t("li",[t("p",[t("code",{pre:!0},[e._v("secret(question)")])]),t("blockquote",[t("p",[e._v("Ask a question to the user with a secret answer that does not show up in the CLI")])])]),t("li",[t("p",[t("code",{pre:!0},[e._v("confirm(statement)")])]),t("blockquote",[t("p",[e._v("Ask the user for confirmation")])])]),t("li",[t("p",[t("code",{pre:!0},[e._v("choice(question, choices, defaultAnswer)")])]),t("blockquote",[t("p",[e._v("Ask a question to the user with answer choices")])])]),t("li",[t("p",[t("code",{pre:!0},[e._v("table(header, data)")])]),t("blockquote",[t("p",[e._v("Echo data in a table")])])]),t("li",[t("p",[t("code",{pre:!0},[e._v("tables(data)")])]),t("blockquote",[t("p",[e._v("Echo data set in multiple tables")])])])]),t("h2",[e._v("Interceptor")]),t("p",[e._v("Sometime, third parties may print data directly in the console through "),t("code",{pre:!0},[e._v("console.log")]),e._v(" or "),t("code",{pre:!0},[e._v("process.stdout.write")]),e._v(", which may be an issue.\nOr sometimes, we want their output, but with some formatting, translations, etc.\nA service was designed to handle these issues, called the "),t("code",{pre:!0},[e._v("terminal.interceptor")]),e._v(".")]),t("p",[e._v("It offers some nice features, such as adding and removing interceptors, enabling and disabling interception, manipulating output from interceptors, capturing output data into an array and get the output from the time it starts capturing, muting the console and remove the colors.")]),t("p",[e._v("One of the features you may want to use more often in a command class is the capture.\nWhen using third parties that may output in the CLI, you can start the output capture, by calling the "),t("code",{pre:!0},[e._v("captureOutput")]),e._v(" method, and finally calling "),t("code",{pre:!0},[e._v("stopCaptureOutput")]),e._v(", which will return the captured output, ordered by call in an array.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-class"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("class")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("MyCommand")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("extends")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("Command")]),e._v(" ")]),e._v("{\n\n    "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("/* ... */")]),e._v("\n\n    "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("async")]),e._v(" handle() {\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("await")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".app.make("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'third-party'")]),e._v(").doSomething(); "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v('// outputs "Something was done!"')]),e._v("\n\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".captureOutput();\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("await")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".app.make("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'third-party'")]),e._v(").doSomething(); "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("// outputs nothing")]),e._v("\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("const")]),e._v(" output = "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".stopCaptureOutput();\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("if")]),e._v(" (output.includes("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'Something was done'")]),e._v(")) {\n            "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".success("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'Completed without error!'")]),e._v(");\n        } "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("else")]),e._v(" {\n            "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".failure("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'An error may have occurred...'")]),e._v(");\n            "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".log(...output); "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("// verbose level >= 1")]),e._v("\n        }\n    }\n\n}\n")])])])}],n=t("2877"),o={},l=Object(n["a"])(o,a,r,!1,null,null,null);s["default"]=l.exports},2833:function(e,s,t){"use strict";var a=t("2672"),r=t.n(a);r.a},"2a32":function(e,s,t){"use strict";t.r(s);var a=function(){var e=this,s=e.$createElement;e._self._c;return e._m(0)},r=[function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("section",[t("h1",[e._v("Drivers")]),t("h2",[e._v("Introduction")]),t("p",[e._v("In Node IoC, the abstraction is one of its main architecture concepts.\nUsing a complex service must be as easy as possible, without having to drill down to the concrete object that will handle the process.\nDrivers are a very important piece of equipment a complex class can use to abstract implementation.")]),t("p",[e._v("For instance, the logger service does not have to know how a file logger is implemented, and how different it is from the database logger.\nIt simply uses the correct implementation and calls its methods.")]),t("p",[e._v('Normally, all drivers of a given service must implement the same "interface", which does not exist in JavaScript.\nHowever, a very convenient way to emulate interfaces is through abstract classes (normally called '),t("code",{pre:!0},[e._v("Driver")]),e._v(" in our case), which still do not exist in JavaScript, but the "),t("code",{pre:!0},[e._v("NotImplementedError")]),e._v(" is used to throw an exception when the method was not implemented by the instantiable class.")]),t("h2",[e._v("The hasDriver mixin")]),t("p",[e._v("To start using drivers in your custom classes, the "),t("code",{pre:!0},[e._v("hasDriver")]),e._v(" mixin is the starting point.\nIt adds all the necessary methods to use drivers.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("import")]),e._v(" { mixins }     "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("from")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'@absolunet/ioc'")]),e._v(";\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("import")]),e._v(" FileDriver     "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("from")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'./drivers/FileDriver'")]),e._v(";\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("import")]),e._v(" DatabaseDriver "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("from")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'./drivers/Database'")]),e._v(";\n\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("const")]),e._v(" { hasDriver } = mixins;\n\n\n"),t("span",{pre:!0,attrs:{class:"hljs-class"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("class")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("TaskService")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("extends")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("hasDriver")]),e._v("() ")]),e._v("{\n\n    "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("static")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("get")]),e._v(" dependencies() {\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" ("),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("super")]),e._v(".dependencies || []).concat(["),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'config'")]),e._v("]);\n    }\n\n    init() {\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("super")]),e._v(".init();\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".addDriver("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'file'")]),e._v(",     FileDriver);\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".addDriver("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'database'")]),e._v(", DatabaseDriver);\n    }\n\n    completeTask(task) {\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".getDriverByConfig().completeTask(task);\n    }\n\n    getDriverByConfig() {\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("const")]),e._v(" store = "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".config.get("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'task.default'")]),e._v(", "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'file'")]),e._v(");\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("const")]),e._v(" { driver, ...driverConfig } = "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".config.get("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("`task.stores."),t("span",{pre:!0,attrs:{class:"hljs-subst"}},[e._v("${store}")]),e._v("`")]),e._v(");\n\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".driver(driver, { "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'driver.config'")]),e._v(": driverConfig });\n    }\n\n}\n")])]),t("p",[e._v("This mixin gives you those methods.")]),t("ul",[t("li",[t("p",[t("code",{pre:!0},[e._v("driver()")])]),t("blockquote",[t("p",[e._v("Get the default driver, or the driver called "),t("code",{pre:!0},[e._v('"default"')])])])]),t("li",[t("p",[t("code",{pre:!0},[e._v("driver(name)")])]),t("blockquote",[t("p",[e._v("Get the driver by name.")])])]),t("li",[t("p",[t("code",{pre:!0},[e._v("driver(name, parameters)")])]),t("blockquote",[t("p",[e._v("Get the driver by name with the given parameters when making the instance through the container.")])])]),t("li",[t("p",[t("code",{pre:!0},[e._v("addDriver(name, class)")])]),t("blockquote",[t("p",[e._v("Add a driver with a name")])])]),t("li",[t("p",[t("code",{pre:!0},[e._v("setDefaultDriver(name)")])]),t("blockquote",[t("p",[e._v("Alias the given driver name as "),t("code",{pre:!0},[e._v('"default"')])])])]),t("li",[t("p",[t("code",{pre:!0},[e._v("setDriverAlias(name, alias)")])]),t("blockquote",[t("p",[e._v("Alias the given driver name as the given alias")])])]),t("li",[t("p",[t("code",{pre:!0},[e._v("hasDriver(name)")])]),t("blockquote",[t("p",[e._v("Check if the driver exists by name, either for drivers and aliases")])])]),t("li",[t("p",[t("code",{pre:!0},[e._v("isDriverAlias(name)")])]),t("blockquote",[t("p",[e._v("Check if the driver's name is an alias.")])])])]),t("p",[e._v("You can also implement a method called "),t("code",{pre:!0},[e._v("bootDriver")]),e._v(".\nIt is used the same way as a service decorator would be.\nIn this method, you will receive the driver instance with its name, so you can perform actions before using it.")]),t("h2",[e._v("Create drivers")]),t("p",[e._v("To create a driver, there is no restriction.\nHowever, here is a recommended recipe.")]),t("p",[e._v("First, you will need an abstract driver class.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("import")]),e._v(" { NotImplementedError } "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("from")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'@absolunet/ioc'")]),e._v(";\n\n"),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("/**\n * Abstract driver to handle tasks.\n */")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-class"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("class")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("Driver")]),e._v(" ")]),e._v("{\n\n    "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("static")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("get")]),e._v(" dependencies() {\n        "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("// This dependency does not exist in the container.")]),e._v("\n        "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("// However, we can still declare it as a dependency that must be manually injected.")]),e._v("\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" ["),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'driver.config'")]),e._v("];\n    }\n\n    "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("/**\n     * Complete a task.\n     *\n     * @param {{id: number, label: string, done: boolean}} task - The completed task.\n     * @returns {Promise<{id: number, label: string, done: boolean}>} The completed task.\n     * @async\n     * @abstract\n     */")]),e._v("\n    completeTask(task) {\n        "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v('// For a "FileDriver" instance, the message will be:')]),e._v("\n        "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v('// "The method [completeTask] must be implemented in [FileDriver].')]),e._v("\n        "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v('// It should return [Promise<task>]."')]),e._v("\n        "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("// Here is the signature: new NotImplementedError(instance, method, [returnType], [type='method'])")]),e._v("\n        "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("//")]),e._v("\n        "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("// To make an accessor or mutator abstract, you can specify a fourth argument, 'accessor' or 'mutator'.")]),e._v("\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("throw")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("new")]),e._v(" NotImplementedError("),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(", "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'completeTask'")]),e._v(", "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'Promise<task>'")]),e._v(");\n    }\n\n}\n")])]),t("p",[e._v("Then, you can start implementing the driver with concrete drivers.\nYou can also use configuration to drive the implementation.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-yaml"}},[t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("# config/task.yaml")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("default:")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("file")]),e._v("\n\n"),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("stores:")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("  file:")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("    driver:")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("file")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("    file:")]),e._v("   "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'/path/to/file.json'")]),e._v("\n\n"),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("  database:")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("    driver:")]),e._v("     "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("database")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("    connection:")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("default")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("    table:")]),e._v("      "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("tasks")]),e._v("\n")])]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("import")]),e._v(" Driver "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("from")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'./Driver'")]),e._v(";\n\n\n"),t("span",{pre:!0,attrs:{class:"hljs-class"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("class")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("FileDriver")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("extends")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("Driver")]),e._v(" ")]),e._v("{\n\n    "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("static")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("get")]),e._v(" dependencies() {\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" ("),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("super")]),e._v(".dependencies || []).concat(["),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'file'")]),e._v("]);\n    }\n\n    "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("async")]),e._v(" completeTask(task) {\n        task.done = "),t("span",{pre:!0,attrs:{class:"hljs-literal"}},[e._v("true")]),e._v(";\n\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("const")]),e._v(" tasks = "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("await")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".file.loadAsync("),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".driverConfig.file);\n\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("const")]),e._v(" exists = tasks.some("),t("span",{pre:!0,attrs:{class:"hljs-function"}},[e._v("("),t("span",{pre:!0,attrs:{class:"hljs-params"}},[e._v("t")]),e._v(") =>")]),e._v(" {\n            "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("if")]),e._v(" (t.id === task.id) {\n                "),t("span",{pre:!0,attrs:{class:"hljs-built_in"}},[e._v("Object")]),e._v(".assign(t, task);\n\n                "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-literal"}},[e._v("true")]),e._v(";\n            }\n\n            "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-literal"}},[e._v("false")]),e._v(";\n        });\n\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("if")]),e._v(" (!exists) {\n            "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("throw")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("new")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-built_in"}},[e._v("TypeError")]),e._v("("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'The given task does not exists.'")]),e._v(");\n        }\n\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("await")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".file.writeAsync("),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".driverConfig.file, tasks);\n\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" task;\n    }\n\n}\n")])]),t("p",[e._v("In this example, the driver reads a JSON file, alter its data and overwrite it with fresh data.\nFun fact, the "),t("code",{pre:!0},[e._v("file")]),e._v(" manager uses drivers to properly load the file by its type.\nThat is the reason why we don't have to "),t("code",{pre:!0},[e._v("JSON.parse")]),e._v(" it, the driver does it by itself.\nThe same thing happens when writing the file, it encodes the data for us.")]),t("p",[e._v("Now, we can easily use the driver in our service.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("import")]),e._v(" FileDriver "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("from")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'./drivers/FileDriver'")]),e._v(";\n\n"),t("span",{pre:!0,attrs:{class:"hljs-class"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("class")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("TaskService")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("extends")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("hasDriver")]),e._v("() ")]),e._v("{\n\n    "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("static")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("get")]),e._v(" dependencies() {\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" ("),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("super")]),e._v(".dependencies || []).concat(["),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'config'")]),e._v("]);\n    }\n\n    init() {\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("super")]),e._v(".init();\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".addDriver("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'file'")]),e._v(", FileDriver);\n    }\n\n    completeTask(task) {\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("const")]),e._v(" { driver, ...driverConfig } = "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".config.get("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'task.stores.file'")]),e._v(");\n\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".driver(driver, { "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'driver.config'")]),e._v(": driverConfig }).completeTask(task);\n    }\n\n}\n")])]),t("p",[e._v("Now, let's implement another driver, the "),t("code",{pre:!0},[e._v("DatabaseDriver")]),e._v(".\nThe implementation will change, but the same method will be implemented.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("import")]),e._v(" Driver "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("from")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'./Driver'")]),e._v(";\n\n"),t("span",{pre:!0,attrs:{class:"hljs-class"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("class")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("DatabaseDriver")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("extends")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("Driver")]),e._v(" ")]),e._v("{\n\n    "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("static")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("get")]),e._v(" dependencies() {\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" ("),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("super")]),e._v(".dependencies || []).concat(["),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'db'")]),e._v("]);\n    }\n\n    "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("async")]),e._v(" completeTask(task) {\n        task.done = "),t("span",{pre:!0,attrs:{class:"hljs-literal"}},[e._v("true")]),e._v(";\n\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("const")]),e._v(" connection = "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".db.getConnection("),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".driverConfig.connection);\n\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("await")]),e._v(" connection("),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".driverConfig.table)\n            .where({ "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("id")]),e._v(": task.id })\n            .update({ ...task });\n\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" task;\n    }\n\n}\n")])]),t("p",[e._v("As we can see, the same thing is done, but through the database connection.")]),t("p",[e._v("Now, the only thing left is to handle the proper driver to use.\nThe first code example shows an acceptable implementation.")]),t("p",[e._v("Node IoC uses this concept a lot in order to minimize the code that must be written, in favor of configuration.\nCode can still be used for edge-cases, but most of the normal implementations can use the features just with simple code lines and configuration.")]),t("h2",[e._v("Forward calls to the default driver")]),t("p",[e._v("Drivers are a very nice way to abstract complex and configurable features.\nHowever, there is still the "),t("code",{pre:!0},[e._v(".driver()")]),e._v(" call to use all the time, which can be annoying.\nHow can we assume that a service has drivers, or handles itself the implementation?")]),t("p",[e._v("Fortunately, thanks to the ES2015 "),t("a",{attrs:{href:"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Proxy"}},[t("code",{pre:!0},[e._v("Proxy")])]),e._v(", we can remove the "),t("code",{pre:!0},[e._v(".driver()")]),e._v(" statement to directly use the default driver methods.")]),t("p",[e._v("Node IoC offers a proxy handler that makes this forwarding implementation very easy to do, the "),t("code",{pre:!0},[e._v("ForwardProxy")]),e._v(" handler.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("import")]),e._v(" { ForwardProxy } "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("from")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'@absolunet/ioc'")]),e._v(";\n\n"),t("span",{pre:!0,attrs:{class:"hljs-class"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("class")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("TaskService")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("extends")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("hasDriver")]),e._v("() ")]),e._v("{\n\n    "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("/* ... */")]),e._v("\n\n    "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("constructor")]),e._v("(...parameters) {\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("super")]),e._v("(...parameters);\n\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("new")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-built_in"}},[e._v("Proxy")]),e._v("("),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(", "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("new")]),e._v(" ForwardProxy());\n    }\n\n    "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("/* ... */")]),e._v("\n\n    "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("/**\n     * This method will be used by the proxy handler to forward all calls and property access.\n     * Here, we simply indicate that the driver should be used as the default instance.\n     */")]),e._v("\n    getForward() {\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".driver();\n    }\n\n}\n")])]),t("p",[e._v("The only method to implement to make the forwarding works is "),t("code",{pre:!0},[e._v("getForward")]),e._v(".\nThe "),t("code",{pre:!0},[e._v("ForwardProxy")]),e._v(" handler will first look into the trapped instance to see if the property, or the method exists.\nIf it does, then the trapped instance's property value is returned.\nOtherwise, the object returned by the "),t("code",{pre:!0},[e._v("getForward")]),e._v(" method is used, and the forwarded object's property value is returned.\nIf the result is a function, it binds the object to it.")]),t("h2",[e._v("Framework drivers")]),t("p",[e._v("The framework offers a lot of services that use drivers to allow either configuration-driven behavior or separate implementation for specific behavior.")]),t("p",[e._v("Here are the services that use drivers and their drivers:")]),t("ul",[t("li",[t("p",[t("code",{pre:!0},[e._v("cache")])]),t("ul",[t("li",[t("code",{pre:!0},[e._v("database")])]),t("li",[t("code",{pre:!0},[e._v("file")])]),t("li",[t("code",{pre:!0},[e._v("runtime")])])])]),t("li",[t("p",[t("code",{pre:!0},[e._v("db.connection")])]),t("ul",[t("li",[t("code",{pre:!0},[e._v("sqlite")])])])]),t("li",[t("p",[t("code",{pre:!0},[e._v("db.orm")])]),t("ul",[t("li",[t("code",{pre:!0},[e._v("bookshelf")]),e._v(" (default)")])])]),t("li",[t("p",[t("code",{pre:!0},[e._v("event")])]),t("ul",[t("li",[t("code",{pre:!0},[e._v("emitter")]),e._v(" (default)")]),t("li",[t("code",{pre:!0},[e._v("pubsubjs")])])])]),t("li",[t("p",[t("code",{pre:!0},[e._v("file")])]),t("ul",[t("li",[t("code",{pre:!0},[e._v("text")]),e._v(" (default)")]),t("li",[t("code",{pre:!0},[e._v("js")])]),t("li",[t("code",{pre:!0},[e._v("json")])]),t("li",[t("code",{pre:!0},[e._v("yaml")])]),t("li",[t("code",{pre:!0},[e._v("yml")]),e._v(" (alias for "),t("code",{pre:!0},[e._v("yaml")]),e._v(")")]),t("li",[t("code",{pre:!0},[e._v("null")])])])]),t("li",[t("p",[t("code",{pre:!0},[e._v("exception.handler")])]),t("ul",[t("li",[t("code",{pre:!0},[e._v("ouch")])]),t("li",[t("code",{pre:!0},[e._v("prettyError")])]),t("li",[t("code",{pre:!0},[e._v("view")])]),t("li",[t("code",{pre:!0},[e._v("console")]),e._v(" (alias for "),t("code",{pre:!0},[e._v("prettyError")]),e._v(")")]),t("li",[t("code",{pre:!0},[e._v("http.debug")]),e._v(" (alias for "),t("code",{pre:!0},[e._v("ouch")]),e._v(")")]),t("li",[t("code",{pre:!0},[e._v("http.production")]),e._v(" (alias for "),t("code",{pre:!0},[e._v("view")]),e._v(")")])])]),t("li",[t("p",[t("code",{pre:!0},[e._v("log")])]),t("ul",[t("li",[t("code",{pre:!0},[e._v("database")])]),t("li",[t("code",{pre:!0},[e._v("file")])]),t("li",[t("code",{pre:!0},[e._v("stack")])])])]),t("li",[t("p",[t("code",{pre:!0},[e._v("translator")])]),t("ul",[t("li",[t("code",{pre:!0},[e._v("file")]),e._v(" (default)")])])]),t("li",[t("p",[t("code",{pre:!0},[e._v("view.engine")])]),t("ul",[t("li",[t("code",{pre:!0},[e._v("jsrender")]),e._v(" (default)")]),t("li",[t("code",{pre:!0},[e._v("null")])])])])])])}],n=t("2877"),o={},l=Object(n["a"])(o,a,r,!1,null,null,null);s["default"]=l.exports},"2b03":function(e,s,t){"use strict";t.r(s);var a=function(){var e=this,s=e.$createElement;e._self._c;return e._m(0)},r=[function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("section",[t("h1",[e._v("Create a Web page")]),t("h2",[e._v("Introduction")]),t("p",[e._v("This tutorial will show you how to build a Web page using MVC approach with Node IoC.")]),t("p",[e._v("For this second assignment, we will create a search form to find an inspiring book with the "),t("a",{attrs:{href:"https://developers.google.com/books/docs/v1/using#PerformingSearch"}},[e._v("Google Books API")]),e._v(".\nThe fetch logic will be the same, but the implementation will be different since it will display a Web page instead of a formatted string inside the console.")]),t("p",[e._v("Here are the key concepts that will be part of this tutorial:")]),t("ul",[t("li",[e._v("The "),t("code",{pre:!0},[e._v("serve")]),e._v(" command")]),t("li",[e._v("The "),t("code",{pre:!0},[e._v("router")]),e._v(" service (through the routes file, and a view helper function)")]),t("li",[e._v("The web routes file")]),t("li",[e._v("Named routes")]),t("li",[e._v("The "),t("code",{pre:!0},[e._v("Controller")]),e._v(" class")]),t("li",[e._v("Scaffolding controller with "),t("code",{pre:!0},[e._v("make:controller")])]),t("li",[e._v("The "),t("code",{pre:!0},[e._v("http")]),e._v(" service")]),t("li",[e._v("The "),t("code",{pre:!0},[e._v("view")]),e._v(" service (through a controller method)")]),t("li",[e._v("The "),t("code",{pre:!0},[e._v("include")]),e._v(" view tag")]),t("li",[e._v("The "),t("code",{pre:!0},[e._v("dumper")]),e._v(" service (through a controller method, and a view helper function)")]),t("li",[e._v("The "),t("code",{pre:!0},[e._v("translator")]),e._v(" service (through a view helper function)")]),t("li",[e._v("The translations file")])]),t("h2",[e._v("Launch the server")]),t("p",[e._v("First, we need to start a server.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-bash"}},[e._v("node ioc serve\n")])]),t("p",[e._v("This will start a new server process over port "),t("code",{pre:!0},[e._v("8080")]),e._v(".\nTry accessing "),t("a",{attrs:{href:""}},[e._v("http://localhost:8080")]),e._v(".\nYou should see the default Web welcome page.\nIf you need to change the port, use the "),t("code",{pre:!0},[e._v("--port=8080")]),e._v(" option, with the wanted port.")]),t("p",[e._v("To develop faster, Node IoC provides a daemon feature that will relaunch the server on file change.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-bash"}},[e._v("node ioc serve --daemon\n")])]),t("p",[e._v("Once the server has started, we can, in another terminal, run the Node Manager "),t("code",{pre:!0},[e._v("watch")]),e._v(" command.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-bash"}},[e._v("npm run manager:watch\n")])]),t("p",[e._v("Now, we are ready to create our first Web page!")]),t("h2",[e._v("Create the routes")]),t("p",[e._v("Then, we need to create our routes.\nA route is a way to associate a path or a pattern to a handler.\nIn an MVC application, the handler will be a controller action.")]),t("p",[e._v("Your routes are located in the "),t("code",{pre:!0},[e._v("src/routes/web.js")]),e._v(" file.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("export")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("default")]),e._v(" (router, app) => {\n    "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("// The original comments were stripped out for easier readability.")]),e._v("\n\n    router.get("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'/'")]),e._v(",        "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'HomeController@index'")]),e._v(").name("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'home'")]),e._v(");\n    router.get("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'/example'")]),e._v(", "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'HomeController@example'")]),e._v(").name("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'example'")]),e._v(");\n\n    router.static("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'/static'")]),e._v(", app.publicPath());\n    router.static("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'/uploads'")]),e._v(", app.uploadPath("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'public'")]),e._v("));\n};\n")])]),t("p",[e._v("Let's create a route that will match the "),t("code",{pre:!0},[e._v("/inspire/book")]),e._v(" URL.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("export")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("default")]),e._v(" (router, app) => {\n    router.get("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'/'")]),e._v(",        "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'HomeController@index'")]),e._v(").name("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'home'")]),e._v(");\n    router.get("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'/example'")]),e._v(", "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'HomeController@example'")]),e._v(").name("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'example'")]),e._v(");\n\n    "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("// Your new route")]),e._v("\n    router.get("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'/inspire/book'")]),e._v(", (request, response) => {\n        response.send("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'The inspire book search page...'")]),e._v(");\n    });\n\n    router.static("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'/static'")]),e._v(", app.publicPath());\n    router.static("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'/uploads'")]),e._v(", app.uploadPath("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'public'")]),e._v("));\n};\n")])]),t("p",[e._v("Try the newly created page: "),t("a",{attrs:{href:""}},[e._v("http://localhost:8080/inspire/book")]),e._v(".")]),t("p",[e._v("You should only see a text in a blank window, with your text: "),t("code",{pre:!0},[e._v("The inspire book search page...")]),e._v(".")]),t("p",[e._v("You can also create the result page route.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[e._v("router.get("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'/inspire/book/search'")]),e._v(", (request, response) => {\n    response.send("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'The inspire book search result page...'")]),e._v(");\n});\n")])]),t("h2",[e._v("Create the controller")]),t("p",[e._v("Now, let's do the things right! A closure is a fast way to implement a route, but the code will rapidly begin to be messy, and the routes file, huge.\nWe need to split the code by responsibility.")]),t("p",[e._v("A controller has the responsibility to handle a request, and a route, to map URL patterns to a request handler.")]),t("p",[e._v("To create a controller, you can use the Node IoC command to make a quick scaffold.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-bash"}},[e._v("node ioc make:controller InspireBookController\n")])]),t("blockquote",[t("p",[e._v("This scaffold command accepts some flags to create different skeletons.")]),t("p",[e._v("the "),t("code",{pre:!0},[e._v("handler")]),e._v(" flag will create a controller with a single "),t("code",{pre:!0},[e._v("handle")]),e._v(" method.")]),t("p",[e._v("The "),t("code",{pre:!0},[e._v("resource")]),e._v(" flag will create a controller with all the CRUD methods: "),t("code",{pre:!0},[e._v("index")]),e._v(", "),t("code",{pre:!0},[e._v("create")]),e._v(", "),t("code",{pre:!0},[e._v("store")]),e._v(", "),t("code",{pre:!0},[e._v("show")]),e._v(", "),t("code",{pre:!0},[e._v("edit")]),e._v(", "),t("code",{pre:!0},[e._v("update")]),e._v(" and "),t("code",{pre:!0},[e._v("destroy")]),e._v(".")]),t("p",[e._v("The "),t("code",{pre:!0},[e._v("api")]),e._v(" flag will create a controller with all the API CRUD methods: "),t("code",{pre:!0},[e._v("index")]),e._v(", "),t("code",{pre:!0},[e._v("store")]),e._v(", "),t("code",{pre:!0},[e._v("show")]),e._v(", "),t("code",{pre:!0},[e._v("update")]),e._v(" and "),t("code",{pre:!0},[e._v("destroy")]),e._v(".")])]),t("p",[e._v("Your new controller is located under the "),t("code",{pre:!0},[e._v("src/app/http/controllers")]),e._v(" folder.")]),t("p",[e._v("Now, inside your controller, you can create your first method.\nLet's call it "),t("code",{pre:!0},[e._v("index")]),e._v(".")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-class"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("class")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("InspireBookController")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("extends")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("Controller")]),e._v(" ")]),e._v("{\n\n    index() {\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".response.send("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'The inspire book search result page inside a controller...'")]),e._v(");\n    }\n\n}\n")])]),t("p",[e._v("Then, we must link it to the route.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("export")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("default")]),e._v(" (router, app) => {\n    router.get("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'/'")]),e._v(",        "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'HomeController@index'")]),e._v(").name("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'home'")]),e._v(");\n    router.get("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'/example'")]),e._v(", "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'HomeController@example'")]),e._v(").name("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'example'")]),e._v(");\n\n    "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("// Your updated route, following 'ControllerName@method' pattern")]),e._v("\n    router.get("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'/inspire/book'")]),e._v(", "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'InspireBookController@index'")]),e._v(");\n \n    "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("// Your search route, still with a closure handler")]),e._v("\n    router.get("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'/inspire/book/search'")]),e._v(", (request, response) => {\n        response.send("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'The inspire book search result page...'")]),e._v(");\n    });\n \n    router.static("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'/static'")]),e._v(",  app.publicPath());\n    router.static("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'/uploads'")]),e._v(", app.uploadPath("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'public'")]),e._v("));\n};\n")])]),t("p",[e._v("A thing that must be understood about the controller resolving is that, normally, we must register a controller through the controller repository ("),t("code",{pre:!0},[e._v("router.controller")]),e._v(").\nHowever, the application controllers are dynamically resolved by the repository, so you don't have to manually register all of them.")]),t("p",[e._v("The pattern of a controller for resolving is "),t("code",{pre:!0},[e._v("folder.subfolder.ControllerName@method")]),e._v(", starting from the "),t("code",{pre:!0},[e._v("src/app/controllers")]),e._v(" folder.")]),t("p",[e._v("Now, let's reload our Web page again, with the same URL.\nThe request should now be handled by the controller, through the "),t("code",{pre:!0},[e._v("index")]),e._v(" method.")]),t("h2",[e._v("Render the index view")]),t("p",[e._v("The view system is already attached to the controller instance.\nYou can use the "),t("code",{pre:!0},[e._v("view")]),e._v(" method to display a rendered template.")]),t("blockquote",[t("p",[e._v("The same way the controller names are dotted-separated paths to the file from the controllers' folder, the views use the same approach.")]),t("p",[e._v("Starting from the "),t("code",{pre:!0},[e._v("resources/views")]),e._v(" folder, the view "),t("code",{pre:!0},[e._v("pages.home")]),e._v(" should be located at "),t("code",{pre:!0},[e._v("resources/views/pages/home.html")]),e._v(".")])]),t("p",[e._v("First, let's try to render an existing template, the "),t("code",{pre:!0},[e._v("pages.home")]),e._v(" view.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-class"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("class")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("InspireBookController")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("extends")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("Controller")]),e._v(" ")]),e._v("{\n\n    index() {\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".view("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'pages.home'")]),e._v(");\n    }\n\n}\n")])]),t("p",[e._v("Now, the "),t("code",{pre:!0},[e._v("/inspire/book")]),e._v(" page should display the same page as the home page.")]),t("p",[e._v("Let's define our own page template.")]),t("p",[e._v("Inside "),t("code",{pre:!0},[e._v("resources/views/pages")]),e._v(", we will create a folder called "),t("code",{pre:!0},[e._v("inspire")]),e._v(", and inside of it, a "),t("code",{pre:!0},[e._v("book")]),e._v(" folder.\nThe views' organization is yours to implement when building your own website.\nWe will keep it simple and URL-related for now, so you won't get lost through this assignment.\nFeel free to explore the best ways to organize your application.")]),t("p",[e._v("Now, inside the "),t("code",{pre:!0},[e._v("resources/views/pages/inspire/book")]),e._v(", we will create the template, "),t("code",{pre:!0},[e._v("index.html")]),e._v(".")]),t("p",[e._v("Here is a suggested content:")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-html"}},[e._v('{{include name="layouts.app"}}\n'),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[e._v("<"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[e._v("div")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("class")]),e._v("="),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v('"grid-container"')]),e._v(">")]),e._v("\n    "),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[e._v("<"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[e._v("div")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("class")]),e._v("="),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v('"grid-x text-center align-middle"')]),e._v(">")]),e._v("\n        "),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[e._v("<"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[e._v("div")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("class")]),e._v("="),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v('"cell medium-8 medium-offset-2 large-6 large-offset-3"')]),e._v(">")]),e._v("\n            "),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[e._v("<"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[e._v("h2")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("class")]),e._v("="),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v('"margin-top-3"')]),e._v(">")]),e._v("{{:~t('Search an inspiring book')}}."),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[e._v("</"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[e._v("h2")]),e._v(">")]),e._v("\n            "),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[e._v("<"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[e._v("form")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("action")]),e._v("="),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v('"/inspire/book/search"')]),e._v(">")]),e._v("\n                "),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[e._v("<"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[e._v("label")]),e._v(">")]),e._v("\n                    Search\n                    "),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[e._v("<"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[e._v("input")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("type")]),e._v("="),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v('"search"')]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("name")]),e._v("="),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v('"book"')]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("placeholder")]),e._v("="),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("\"{{:~t('What do you want to read?')}}\"")]),e._v(">")]),e._v("\n                "),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[e._v("</"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[e._v("label")]),e._v(">")]),e._v("\n                "),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[e._v("<"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[e._v("input")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("type")]),e._v("="),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v('"submit"')]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("class")]),e._v("="),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v('"button"')]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("value")]),e._v("="),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("\"{{:~t('Find something inspiring!')}}\"")]),e._v(">")]),e._v("\n            "),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[e._v("</"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[e._v("form")]),e._v(">")]),e._v("\n        "),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[e._v("</"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[e._v("div")]),e._v(">")]),e._v("\n    "),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[e._v("</"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[e._v("div")]),e._v(">")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[e._v("</"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[e._v("div")]),e._v(">")]),e._v("\n{{/include}}\n")])]),t("p",[e._v("Let's render this view.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-class"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("class")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("InspireBookController")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("extends")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("Controller")]),e._v(" ")]),e._v("{\n\n    index() {\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".view("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'pages.inspire.book.index'")]),e._v(");\n    }\n\n}\n")])]),t("p",[e._v("You should see the search form now!")]),t("p",[e._v("Node IoC provides Foundation 6 as a starting point to build your website.\nFeel free to change to whatever you prefer.")]),t("p",[e._v("The default rendering engine is "),t("a",{attrs:{href:"https://www.jsviews.com/"}},[e._v("JSRender")]),e._v(".\nSome tags and helpers are added by default by the "),t("code",{pre:!0},[e._v("view.engine")]),e._v(" service.")]),t("h3",[e._v("The "),t("em",[e._v("include")]),e._v(" tag")]),t("p",[e._v("The "),t("code",{pre:!0},[e._v("{{include}}")]),e._v(" tag indicates to load another view.\nIt needs a view "),t("code",{pre:!0},[e._v("name")]),e._v(" (the same dotted syntax previously used), at least, and an optional "),t("code",{pre:!0},[e._v("data")]),e._v(" object.\nIf you need to pass the current data to the sub-view, use "),t("code",{pre:!0},[e._v("data=#data")]),e._v(".")]),t("p",[e._v("In this case, "),t("code",{pre:!0},[e._v('{{include name="layouts.app"}}')]),e._v(" loads the application layout template.")]),t("p",[e._v("If the template contains a "),t("code",{pre:!0},[e._v("{{:slot}}")]),e._v(" instruction, it means that you can insert HTML in it.\nIt will be rendered at this precise spot.")]),t("p",[e._v("Inside the application layout slot, we print the page main HTML content.")]),t("h3",[e._v("The "),t("em",[e._v("t()")]),e._v(" helper function")]),t("p",[e._v("The "),t("code",{pre:!0},[e._v("{{:~t('some text)}}")]),e._v(" instruction prints the given text, but transformed by the "),t("code",{pre:!0},[e._v("translator")]),e._v(" service.\nIf a translation exists for the current locale, it will return the translated string.\nOtherwise, the original string is returned.")]),t("h2",[e._v("Perform the search")]),t("p",[e._v("Now that we made our first web page, let's perform a search.")]),t("p",[e._v("First, we need to change the second route handler to point to our controller.\nLet's use the "),t("code",{pre:!0},[e._v("search")]),e._v(" action method.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("// src/routes/web.js")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("export")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("default")]),e._v(" (router, app) => {\n    router.get("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'/'")]),e._v(",        "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'HomeController@index'")]),e._v(").name("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'home'")]),e._v(");\n    router.get("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'/example'")]),e._v(", "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'HomeController@example'")]),e._v(").name("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'example'")]),e._v(");\n \n    router.get("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'/inspire/book'")]),e._v(",        "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'InspireBookController@index'")]),e._v(");\n    router.get("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'/inspire/book/search'")]),e._v(", "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'InspireBookController@search'")]),e._v(");\n    \n    router.static("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'/static'")]),e._v(",  app.publicPath());\n    router.static("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'/uploads'")]),e._v(", app.uploadPath("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'public'")]),e._v("));\n};\n\n"),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("// src/app/http/controllers/InspireBookController.js")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-class"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("class")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("InspireBookController")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("extends")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("Controller")]),e._v(" ")]),e._v("{\n\n    index() {\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".view("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'pages.inspire.book.index'")]),e._v(");\n    }\n\n    search() {\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".response.send("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'Searching an inspiring book...'")]),e._v(");\n    }\n\n}\n")])]),t("p",[e._v("Now, try to submit your form.\nYou should see your "),t("code",{pre:!0},[e._v("Searching an inspiring book...")]),e._v(" text.\nNow, the routing is completely done.\nWe just need to actually perform a search and render it.")]),t("h3",[e._v("Use a route name instead of a URL")]),t("p",[e._v("We succeeded in sending a search request from a page to a route.\nHowever, let's already use good practices.")]),t("p",[e._v("We should not rely on route URL since they can easily change, and it would be a mess to maintain.")]),t("p",[e._v("The router supports route naming to make it easier to retrieve them in a more standardized way.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("export")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("default")]),e._v(" (router, app) => {\n    router.get("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'/'")]),e._v(",        "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'HomeController@index'")]),e._v(").name("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'home'")]),e._v(");\n    router.get("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'/example'")]),e._v(", "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'HomeController@example'")]),e._v(").name("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'example'")]),e._v(");\n    \n    router.get("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'/inspire/book'")]),e._v(",        "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'InspireBookController@index'")]),e._v(").name("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'inspire.book.index'")]),e._v(");\n    router.get("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'/inspire/book/search'")]),e._v(", "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'InspireBookController@search'")]),e._v(").name("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'inspire.book.search'")]),e._v(");\n    \n    router.static("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'/static'")]),e._v(",  app.publicPath());\n    router.static("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'/uploads'")]),e._v(", app.uploadPath("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'public'")]),e._v("));\n};\n")])]),t("h4",[e._v("The "),t("em",[e._v("route")]),e._v(" helper function")]),t("p",[e._v("Once the routes are named, we can replace the hard-coded URL in the form with the "),t("code",{pre:!0},[e._v("route")]),e._v(" helper function.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-html"}},[e._v('{{include name="layouts.app"}}\n'),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[e._v("<"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[e._v("div")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("class")]),e._v("="),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v('"grid-container"')]),e._v(">")]),e._v("\n    "),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[e._v("<"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[e._v("div")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("class")]),e._v("="),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v('"grid-x text-center align-middle"')]),e._v(">")]),e._v("\n        "),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[e._v("<"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[e._v("div")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("class")]),e._v("="),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v('"cell medium-8 medium-offset-2 large-6 large-offset-3"')]),e._v(">")]),e._v("\n            "),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[e._v("<"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[e._v("h2")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("class")]),e._v("="),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v('"margin-top-3"')]),e._v(">")]),e._v("{{:~t('Search an inspiring book')}}."),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[e._v("</"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[e._v("h2")]),e._v(">")]),e._v("\n            "),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[e._v("<"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[e._v("form")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("action")]),e._v("="),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("\"{{:~route('inspire.book.search')}}\"")]),e._v(">")]),e._v("\n                "),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[e._v("<"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[e._v("label")]),e._v(">")]),e._v("\n                    Search\n                    "),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[e._v("<"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[e._v("input")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("type")]),e._v("="),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v('"search"')]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("name")]),e._v("="),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v('"query"')]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("placeholder")]),e._v("="),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("\"{{:~t('What do you want to read?')}}\"")]),e._v(">")]),e._v("\n                "),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[e._v("</"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[e._v("label")]),e._v(">")]),e._v("\n                "),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[e._v("<"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[e._v("input")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("type")]),e._v("="),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v('"submit"')]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("class")]),e._v("="),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v('"button"')]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("value")]),e._v("="),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("\"{{:~t('Find something inspiring!')}}\"")]),e._v(">")]),e._v("\n            "),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[e._v("</"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[e._v("form")]),e._v(">")]),e._v("\n        "),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[e._v("</"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[e._v("div")]),e._v(">")]),e._v("\n    "),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[e._v("</"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[e._v("div")]),e._v(">")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[e._v("</"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[e._v("div")]),e._v(">")]),e._v("\n{{/include}}\n")])]),t("p",[e._v("When reloading the page, the URL in the form should be the same as it was before.\nThe main advantage is that you can now rename your URL without refactoring your whole templates that are possibly using this route URL.")]),t("h3",[e._v("Retrieve the request query")]),t("p",[e._v("We first need to retrieve the "),t("code",{pre:!0},[e._v("book")]),e._v(" parameter sent by the form.")]),t("p",[e._v("You can simply use the "),t("code",{pre:!0},[e._v("request")]),e._v(" object bound to the controller.\nIt exposes a "),t("code",{pre:!0},[e._v("query")]),e._v(" property, which represents all the query string parameters.\nThen, we can retrieve the "),t("code",{pre:!0},[e._v("book")]),e._v(" value inside the request query.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-class"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("class")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("InspireBookController")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("extends")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("Controller")]),e._v(" ")]),e._v("{\n\n    index() {\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".view("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'pages.inspire.book.index'")]),e._v(");\n    }\n\n    search() {\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".response.send("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v('`You are searching for "'),t("span",{pre:!0,attrs:{class:"hljs-subst"}},[e._v("${"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".request.query.book}")]),e._v('".`')]),e._v(");\n    }\n\n}\n")])]),t("p",[e._v("If you submitted the form with "),t("code",{pre:!0},[e._v("react")]),e._v(", you should see "),t("code",{pre:!0},[e._v('You are searching for "react".')]),e._v(".\nWe have correctly retrieved our parameter.")]),t("h3",[e._v("Search in the Google Book API")]),t("p",[e._v("Now, we need to perform a search in the "),t("a",{attrs:{href:"https://developers.google.com/books/docs/v1/using#PerformingSearc"}},[e._v("Google Book API")]),e._v(".")]),t("p",[e._v("If you already did the "),t("em",[e._v("Create a command")]),e._v(" assignment, there is nothing new here.\nWe first inject the "),t("code",{pre:!0},[e._v("http")]),e._v(" service, we make our action async, then we "),t("em",[e._v("await")]),e._v(" for the HTTP call response to finally retrieve a random book.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-class"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("class")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("InspireBookController")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("extends")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("Controller")]),e._v(" ")]),e._v("{\n\n    "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("static")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("get")]),e._v(" dependencies() {\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" ["),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'http'")]),e._v("];\n    }\n\n    index() {\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".view("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'pages.inspire.book.index'")]),e._v(");\n    }\n\n    "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("async")]),e._v(" search() {\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("const")]),e._v(" { "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("book")]),e._v(": query } = "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".request.query;\n\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("const")]),e._v(" { "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("data")]),e._v(": { "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("items")]),e._v(": books } } = "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("await")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".http.get("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'https://www.googleapis.com/books/v1/volumes'")]),e._v(", {\n            "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("params")]),e._v(": {\n                "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("q")]),e._v(": query\n            }\n        });\n    \n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("const")]),e._v(" book = books.sort("),t("span",{pre:!0,attrs:{class:"hljs-function"}},[t("span",{pre:!0,attrs:{class:"hljs-params"}},[e._v("()")]),e._v(" =>")]),e._v(" {\n            "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-built_in"}},[e._v("Math")]),e._v(".random() - "),t("span",{pre:!0,attrs:{class:"hljs-number"}},[e._v("0.5")]),e._v(";\n        }).shift();\n    \n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".response.send("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v('`You are searching for "'),t("span",{pre:!0,attrs:{class:"hljs-subst"}},[e._v("${query}")]),e._v('".`')]),e._v(");\n    }\n\n}\n")])]),t("p",[e._v("In Node.js or any CLI application, it's a reflex to print the received data in the console.\nWe can also launch the engine debugger with the "),t("code",{pre:!0},[e._v("--inspect")]),e._v(" flag (much more information "),t("a",{attrs:{href:"https://nodejs.org/en/docs/guides/debugging-getting-started/"}},[e._v("in the Node.js documentation")]),e._v(".\nHowever, for front-end developers, it is more intuitive to use the browser console such as the Chrome DevTool Console or Firebug.\nIt is still possible to launch node in inspect mode, but it may still be complicated to use if not properly configured, or with less advanced Node.js developers.")]),t("p",[e._v("Fortunately, Node IoC provides a simple service to quickly inspect some data in the browser or in the console, called "),t("code",{pre:!0},[e._v("dumper")]),e._v(".\nIt is based on the "),t("a",{attrs:{href:"https://symfony.com/doc/current/components/var_dumper.html#dump-examples-and-output"}},[e._v("Symfony VarDumper")]),e._v(" project.\nIt allows, in a development environment, to use a JSON-tree lookalike system to inspect the dumped data.\nThe base controller offers it out of the box.")]),t("p",[e._v("Let's use it!")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-class"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("class")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("InspireBookController")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("extends")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("Controller")]),e._v(" ")]),e._v("{\n\n    "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("/* ... */")]),e._v("\n\n    "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("async")]),e._v(" search() {\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("const")]),e._v(" { "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("book")]),e._v(": query } = "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".request.query;\n\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("const")]),e._v(" { "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("data")]),e._v(": { "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("items")]),e._v(": books } } = "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("await")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".http.get("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'https://www.googleapis.com/books/v1/volumes'")]),e._v(", {\n            "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("params")]),e._v(": {\n                "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("q")]),e._v(": query\n            }\n        });\n\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("const")]),e._v(" book = books.sort("),t("span",{pre:!0,attrs:{class:"hljs-function"}},[t("span",{pre:!0,attrs:{class:"hljs-params"}},[e._v("()")]),e._v(" =>")]),e._v(" {\n            "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-built_in"}},[e._v("Math")]),e._v(".random() - "),t("span",{pre:!0,attrs:{class:"hljs-number"}},[e._v("0.5")]),e._v(";\n        }).shift();\n\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".dump(book);\n\n        "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v('// return this.response.send(`You are searching for "${query}".`);')]),e._v("\n    }\n\n}\n")])]),t("p",[e._v("If you reload the page, you should see a page filled by the book data.\nYou will retrieve the dump location (the link is clickable and opens the compiled file in your configured IDE) and the dumped data.")]),t("p",[e._v("If you click on arrows, you will be able to inspect the nested objects and array values.")]),t("blockquote",[t("p",[e._v("The dumper is themeable through the "),t("code",{pre:!0},[e._v("dev.dumper")]),e._v(" configuration.")]),t("p",[e._v("Feel free to create your own theme!")])]),t("h2",[e._v("Render the search result view")]),t("p",[e._v("Now that we have a nice view of our model, let's render a web page with the data.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-class"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("class")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("InspireBookController")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("extends")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("Controller")]),e._v(" ")]),e._v("{\n\n    "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("/* ... */")]),e._v("\n\n    "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("async")]),e._v(" search() {\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("const")]),e._v(" { "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("book")]),e._v(": query } = "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".request.query;\n\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("const")]),e._v(" { "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("data")]),e._v(": { "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("items")]),e._v(": books } } = "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("await")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".http.get("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'https://www.googleapis.com/books/v1/volumes'")]),e._v(", {\n            "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("params")]),e._v(": {\n                "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("q")]),e._v(": query\n            }\n        });\n\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("const")]),e._v(" book = books.sort("),t("span",{pre:!0,attrs:{class:"hljs-function"}},[t("span",{pre:!0,attrs:{class:"hljs-params"}},[e._v("()")]),e._v(" =>")]),e._v(" {\n            "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-built_in"}},[e._v("Math")]),e._v(".random() - "),t("span",{pre:!0,attrs:{class:"hljs-number"}},[e._v("0.5")]),e._v(";\n        }).shift();\n\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".view("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'pages.inspire.book.search'")]),e._v(", { query, book });\n    }\n\n}\n")])]),t("p",[e._v("We first start by returning a rendered view with previously computed data: the current book search query, and the inspiring book.\nIn order to render the view, we need to create a view that matches the requested one.")]),t("p",[e._v("We will create a view under "),t("code",{pre:!0},[e._v("resources/views/pages/inspire/book")]),e._v(" called "),t("code",{pre:!0},[e._v("search.html")]),e._v(".\nHere is the basic template that should be rendered (feel free to customize it your own way).")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-html"}},[e._v('{{include name="layouts.app"}}\n'),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[e._v("<"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[e._v("div")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("class")]),e._v("="),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v('"grid-container"')]),e._v(">")]),e._v("\n    "),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[e._v("<"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[e._v("div")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("class")]),e._v("="),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v('"grid-x"')]),e._v(">")]),e._v("\n        "),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[e._v("<"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[e._v("div")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("class")]),e._v("="),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v('"cell"')]),e._v(">")]),e._v("\n            {{:~dump(#data)}}\n        "),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[e._v("</"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[e._v("div")]),e._v(">")]),e._v("\n    "),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[e._v("</"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[e._v("div")]),e._v(">")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[e._v("</"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[e._v("div")]),e._v(">")]),e._v("\n{{/include}}\n")])]),t("h3",[e._v("The "),t("em",[e._v("dump")]),e._v(" helper function")]),t("p",[e._v("Notices the "),t("code",{pre:!0},[e._v("{{:~dump(#data)}}")]),e._v(" statement? This acts the same as the controller's "),t("code",{pre:!0},[e._v("this.dump(data)")]),e._v(".\nHowever, it outputs the data inside the template instead of displaying a complete web page filled with the dumped value.")]),t("p",[e._v("You should see two keys inside the "),t("code",{pre:!0},[e._v("#data")]),e._v(" object: "),t("code",{pre:!0},[e._v("book")]),e._v(" (an object), and "),t("code",{pre:!0},[e._v("query")]),e._v(" (a string containing the searched book).\nThis helper is very useful.")]),t("h3",[e._v("Display the view-model data in the view")]),t("p",[e._v("Now that we know the data that we have, let's put it together in a simple Web page.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-html"}},[e._v('{{include name="layouts.app"}}\n'),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[e._v("<"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[e._v("div")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("class")]),e._v("="),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v('"grid-container"')]),e._v(">")]),e._v("\n    "),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[e._v("<"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[e._v("div")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("class")]),e._v("="),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v('"grid-x"')]),e._v(">")]),e._v("\n        "),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[e._v("<"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[e._v("div")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("class")]),e._v("="),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v('"cell margin-top-2"')]),e._v(">")]),e._v("\n            "),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[e._v("<"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[e._v("h1")]),e._v(">")]),e._v("{{:~t('Search result for:')}} \""),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[e._v("<"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[e._v("em")]),e._v(">")]),e._v("{{:query}}"),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[e._v("</"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[e._v("em")]),e._v(">")]),e._v('"'),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[e._v("</"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[e._v("h1")]),e._v(">")]),e._v("\n        "),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[e._v("</"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[e._v("div")]),e._v(">")]),e._v("\n        "),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[e._v("<"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[e._v("div")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("class")]),e._v("="),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v('"cell margin-top-1"')]),e._v(">")]),e._v("\n            "),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[e._v("<"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[e._v("div")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("class")]),e._v("="),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v('"media-object stack-for-small"')]),e._v(">")]),e._v("\n                "),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[e._v("<"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[e._v("div")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("class")]),e._v("="),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v('"media-object-section"')]),e._v(">")]),e._v("\n                    "),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[e._v("<"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[e._v("div")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("class")]),e._v("="),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v('"card text-center"')]),e._v(">")]),e._v("\n                        "),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[e._v("<"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[e._v("div")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("class")]),e._v("="),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v('"card-section separator-center"')]),e._v(">")]),e._v("\n                            "),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[e._v("<"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[e._v("div")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("class")]),e._v("="),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v('"thumbnail"')]),e._v(">")]),e._v("\n                                "),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[e._v("<"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[e._v("img")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("src")]),e._v("="),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v('"{{:book.volumeInfo.imageLinks.thumbnail}}"')]),e._v(">")]),e._v("\n                            "),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[e._v("</"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[e._v("div")]),e._v(">")]),e._v("\n                        "),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[e._v("</"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[e._v("div")]),e._v(">")]),e._v("\n                        "),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[e._v("<"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[e._v("div")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("class")]),e._v("="),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v('"card-section padding-top-0"')]),e._v(">")]),e._v("\n                            "),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[e._v("<"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[e._v("a")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("href")]),e._v("="),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v('"{{:book.volumeInfo.infoLink}}"')]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("target")]),e._v("="),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v('"_blank"')]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("class")]),e._v("="),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v('"button margin-top-1"')]),e._v(">")]),e._v("{{:~t('View on Google Books')}}"),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[e._v("</"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[e._v("a")]),e._v(">")]),e._v("\n                        "),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[e._v("</"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[e._v("div")]),e._v(">")]),e._v("\n                    "),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[e._v("</"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[e._v("div")]),e._v(">")]),e._v("\n                "),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[e._v("</"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[e._v("div")]),e._v(">")]),e._v("\n                "),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[e._v("<"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[e._v("div")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("class")]),e._v("="),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v('"media-object-section main-section"')]),e._v(">")]),e._v("\n                    "),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[e._v("<"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[e._v("h2")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("class")]),e._v("="),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v('"h3"')]),e._v(">")]),e._v("{{:book.volumeInfo.title}}"),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[e._v("</"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[e._v("h2")]),e._v(">")]),e._v("\n                    {{if book.volumeInfo.subtitle}}\n                    "),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[e._v("<"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[e._v("h3")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("class")]),e._v("="),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v('"h5 subheader"')]),e._v(">")]),e._v("{{:book.volumeInfo.subtitle}}"),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[e._v("</"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[e._v("h3")]),e._v(">")]),e._v("\n                    {{/if}}\n                    "),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[e._v("<"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[e._v("p")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("class")]),e._v("="),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v('"subheader"')]),e._v(">")]),e._v("{{:~t('Author', book.volumeInfo.authors.length)}}"),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[e._v("</"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[e._v("p")]),e._v(">")]),e._v("\n                    "),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[e._v("<"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[e._v("ul")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("class")]),e._v("="),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v('"no-bullet margin-left-2 margin-bottom-2"')]),e._v(">")]),e._v("\n                        {{for book.volumeInfo.authors}}\n                        "),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[e._v("<"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[e._v("li")]),e._v(">")]),e._v("{{:#data}}"),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[e._v("</"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[e._v("li")]),e._v(">")]),e._v("\n                        {{/for}}\n                    "),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[e._v("</"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[e._v("ul")]),e._v(">")]),e._v("\n                    "),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[e._v("<"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[e._v("p")]),e._v(">")]),e._v("{{:book.volumeInfo.description}}"),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[e._v("</"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[e._v("p")]),e._v(">")]),e._v("\n                "),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[e._v("</"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[e._v("div")]),e._v(">")]),e._v("\n            "),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[e._v("</"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[e._v("div")]),e._v(">")]),e._v("\n        "),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[e._v("</"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[e._v("div")]),e._v(">")]),e._v("\n    "),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[e._v("</"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[e._v("div")]),e._v(">")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[e._v("</"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[e._v("div")]),e._v(">")]),e._v("\n{{/include}}\n")])]),t("p",[e._v("Let's examine the things that happened here.")]),t("p",[e._v("First, we printed the current searched query in the page title.")]),t("p",[e._v("We use the "),t("code",{pre:!0},[e._v("t")]),e._v(" translation helper function to internationalize our page.")]),t("p",[e._v("Then, we printed some information about the current book.\nWe create an image tag with the thumbnail as the source.")]),t("p",[e._v("We also added a link button to the Google Books page.")]),t("p",[e._v("On the other portion of the page, we basically printed the minimalist information about the book: title, subtitle (if it exists), author(s) and description.")]),t("p",[e._v("For the author, we made a "),t("code",{pre:!0},[e._v("for")]),e._v(" loop to print all the names.")]),t("h3",[e._v("Pluralization and translation")]),t("p",[e._v("Something that we did not cover yet was the pluralization, which is part of the framework, within a standalone helper, but also within the translator service, which we use through the "),t("code",{pre:!0},[e._v("t")]),e._v(" helper function.")]),t("p",[e._v("Then "),t("code",{pre:!0},[e._v("t")]),e._v(" function can accept many kinds of parameters:")]),t("ul",[t("li",[t("code",{pre:!0},[e._v("t('my.string')")]),e._v(" -> basic translation")]),t("li",[t("code",{pre:!0},[e._v("t('my.string', 2)")]),e._v(" -> basic translation with pluralization")]),t("li",[t("code",{pre:!0},[e._v("t('my.string', { foo: 'bar' })")]),e._v(" -> translation with placeholder replacement")]),t("li",[t("code",{pre:!0},[e._v("t('my.string', { foo: 'bar' }, 2)")]),e._v(" -> translation with placeholder replacement and pluralization")])]),t("p",[e._v("Unlike the "),t("code",{pre:!0},[e._v("helper.string")]),e._v("'s "),t("code",{pre:!0},[e._v("pluralize")]),e._v(" method, the pluralization of a translation is not magic.\nIt relies on translation configuration.")]),t("p",[e._v("In our case, we used the following statement: "),t("code",{pre:!0},[e._v("t('Author', book.volumeInfo.authors.length")]),e._v(", which basically says that the word should be translated, and pluralize if there are more than one author.\nIf the value is "),t("code",{pre:!0},[e._v(">= 1")]),e._v(", the plural version, if it exists, will be used.\nSince no translation was made yet, we see "),t("code",{pre:!0},[e._v("Author")]),e._v(" as an output instead of "),t("code",{pre:!0},[e._v("Authors")]),e._v(" when we see more than one result.")]),t("p",[e._v("Let's make our first pluralizable translation!")]),t("p",[e._v("In the "),t("code",{pre:!0},[e._v("resources/lang")]),e._v(", you should see a "),t("code",{pre:!0},[e._v("translations.yaml")]),e._v(" file.\nThis file is used by default when the translation does not have any namespace (we will cover this in another section).")]),t("p",[e._v("Let's add an entry.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-yaml"}},[t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("# Custom translations")]),e._v("\n\n"),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("Author:")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("    en:")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-bullet"}},[e._v("      -")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("Author")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-bullet"}},[e._v("      -")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("Authors")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("    fr:")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("# Pour nos collègues francophones ;)")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-bullet"}},[e._v("      -")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("Auteur")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-bullet"}},[e._v("      -")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("Auteurs")]),e._v("\n")])]),t("p",[e._v("What this entry does is this:")]),t("ul",[t("li",[e._v("For a single value, the "),t("code",{pre:!0},[e._v("Author")]),e._v(" translation, in English, will be "),t("code",{pre:!0},[e._v("Author")]),e._v(".")]),t("li",[e._v("For a plural value, the "),t("code",{pre:!0},[e._v("Author")]),e._v(" translation, in English, will be "),t("code",{pre:!0},[e._v("Authors")]),e._v(".")])]),t("p",[e._v("Now, for multiple authors, we should see "),t("code",{pre:!0},[e._v("Authors")]),e._v(" instead of "),t("code",{pre:!0},[e._v("Author")]),e._v(".")]),t("p",[e._v("Here is the final result for the routes file, the controller, the two templates and the translations file:")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("// src/routes/web.js")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("export")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("default")]),e._v(" (router, app) => {\n    router.get("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'/'")]),e._v(",        "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'HomeController@index'")]),e._v(").name("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'home'")]),e._v(");\n    router.get("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'/example'")]),e._v(", "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'HomeController@example'")]),e._v(").name("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'example'")]),e._v(");\n\n    router.get("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'/inspire/book'")]),e._v(",        "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'InspireBookController@index'")]),e._v(").name("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'inspire.book.index'")]),e._v(");\n    router.get("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'/inspire/book/search'")]),e._v(", "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'InspireBookController@search'")]),e._v(").name("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'inspire.book.search'")]),e._v(");\n\n    router.static("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'/static'")]),e._v(",  app.publicPath());\n    router.static("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'/uploads'")]),e._v(", app.uploadPath("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'public'")]),e._v("));\n};\n")])]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("// src/app/http/controllers/InspireBookController.js")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("import")]),e._v(" Controller "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("from")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'./Controller'")]),e._v(";\n\n\n"),t("span",{pre:!0,attrs:{class:"hljs-class"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("class")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("InspireBookController")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("extends")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("Controller")]),e._v(" ")]),e._v("{\n\n    "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("static")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("get")]),e._v(" dependencies() {\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" ["),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'http'")]),e._v("];\n    }\n\n    index() {\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".view("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'pages.inspire.book.index'")]),e._v(");\n    }\n\n    "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("async")]),e._v(" search() {\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("const")]),e._v(" { query } = "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".request.query;\n\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("const")]),e._v(" { "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("data")]),e._v(": { "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("items")]),e._v(": books } } = "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("await")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".http.get("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'https://www.googleapis.com/books/v1/volumes'")]),e._v(", {\n            "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("params")]),e._v(": {\n                "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("q")]),e._v(": query\n            }\n        });\n\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("const")]),e._v(" book = books.sort("),t("span",{pre:!0,attrs:{class:"hljs-function"}},[t("span",{pre:!0,attrs:{class:"hljs-params"}},[e._v("()")]),e._v(" =>")]),e._v(" {\n            "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-built_in"}},[e._v("Math")]),e._v(".random() - "),t("span",{pre:!0,attrs:{class:"hljs-number"}},[e._v("0.5")]),e._v(";\n        }).shift();\n\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".view("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'pages.inspire.book.search'")]),e._v(", { book, query });\n    }\n\n}\n\n\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("export")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("default")]),e._v(" InspireBookController;\n")])]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-html"}},[t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("\x3c!-- resources/views/pages/inspire/book/index.html --\x3e")]),e._v('\n{{include name="layouts.app"}}\n'),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[e._v("<"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[e._v("div")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("class")]),e._v("="),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v('"grid-container"')]),e._v(">")]),e._v("\n    "),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[e._v("<"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[e._v("div")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("class")]),e._v("="),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v('"grid-x text-center align-middle"')]),e._v(">")]),e._v("\n        "),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[e._v("<"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[e._v("div")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("class")]),e._v("="),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v('"cell medium-8 medium-offset-2 large-6 large-offset-3"')]),e._v(">")]),e._v("\n            "),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[e._v("<"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[e._v("h2")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("class")]),e._v("="),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v('"margin-top-3"')]),e._v(">")]),e._v("{{:~t('Search an inspiring book')}}."),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[e._v("</"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[e._v("h2")]),e._v(">")]),e._v("\n            "),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[e._v("<"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[e._v("form")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("action")]),e._v("="),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("\"{{:~route('inspire.book.search')}}\"")]),e._v(">")]),e._v("\n                "),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[e._v("<"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[e._v("label")]),e._v(">")]),e._v("\n                    Search\n                    "),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[e._v("<"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[e._v("input")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("type")]),e._v("="),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v('"search"')]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("name")]),e._v("="),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v('"query"')]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("placeholder")]),e._v("="),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("\"{{:~t('What do you want to read?')}}\"")]),e._v(">")]),e._v("\n                "),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[e._v("</"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[e._v("label")]),e._v(">")]),e._v("\n                "),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[e._v("<"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[e._v("input")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("type")]),e._v("="),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v('"submit"')]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("class")]),e._v("="),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v('"button"')]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("value")]),e._v("="),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("\"{{:~t('Find something inspiring!')}}\"")]),e._v(">")]),e._v("\n            "),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[e._v("</"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[e._v("form")]),e._v(">")]),e._v("\n        "),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[e._v("</"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[e._v("div")]),e._v(">")]),e._v("\n    "),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[e._v("</"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[e._v("div")]),e._v(">")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[e._v("</"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[e._v("div")]),e._v(">")]),e._v("\n{{/include}}\n")])]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-html"}},[t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("\x3c!-- resources/views/pages/inspire/book/search.html --\x3e")]),e._v('\n{{include name="layouts.app"}}\n'),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[e._v("<"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[e._v("div")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("class")]),e._v("="),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v('"grid-container"')]),e._v(">")]),e._v("\n    "),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[e._v("<"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[e._v("div")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("class")]),e._v("="),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v('"grid-x"')]),e._v(">")]),e._v("\n        "),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[e._v("<"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[e._v("div")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("class")]),e._v("="),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v('"cell margin-top-2"')]),e._v(">")]),e._v("\n            "),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[e._v("<"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[e._v("h1")]),e._v(">")]),e._v("{{:~t('Search result for:')}} \""),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[e._v("<"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[e._v("em")]),e._v(">")]),e._v("{{:query}}"),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[e._v("</"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[e._v("em")]),e._v(">")]),e._v('"'),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[e._v("</"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[e._v("h1")]),e._v(">")]),e._v("\n        "),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[e._v("</"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[e._v("div")]),e._v(">")]),e._v("\n        "),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[e._v("<"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[e._v("div")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("class")]),e._v("="),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v('"cell margin-top-1"')]),e._v(">")]),e._v("\n            "),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[e._v("<"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[e._v("div")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("class")]),e._v("="),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v('"media-object stack-for-small"')]),e._v(">")]),e._v("\n                "),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[e._v("<"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[e._v("div")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("class")]),e._v("="),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v('"media-object-section"')]),e._v(">")]),e._v("\n                    "),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[e._v("<"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[e._v("div")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("class")]),e._v("="),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v('"card text-center"')]),e._v(">")]),e._v("\n                        "),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[e._v("<"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[e._v("div")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("class")]),e._v("="),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v('"card-section separator-center"')]),e._v(">")]),e._v("\n                            "),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[e._v("<"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[e._v("div")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("class")]),e._v("="),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v('"thumbnail"')]),e._v(">")]),e._v("\n                                "),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[e._v("<"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[e._v("img")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("src")]),e._v("="),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v('"{{:book.volumeInfo.imageLinks.thumbnail}}"')]),e._v(">")]),e._v("\n                            "),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[e._v("</"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[e._v("div")]),e._v(">")]),e._v("\n                        "),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[e._v("</"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[e._v("div")]),e._v(">")]),e._v("\n                        "),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[e._v("<"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[e._v("div")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("class")]),e._v("="),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v('"card-section padding-top-0"')]),e._v(">")]),e._v("\n                            "),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[e._v("<"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[e._v("a")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("href")]),e._v("="),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v('"{{:book.volumeInfo.infoLink}}"')]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("target")]),e._v("="),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v('"_blank"')]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("class")]),e._v("="),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v('"button margin-top-1"')]),e._v(">")]),e._v("{{:~t('View on Google Books')}}"),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[e._v("</"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[e._v("a")]),e._v(">")]),e._v("\n                        "),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[e._v("</"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[e._v("div")]),e._v(">")]),e._v("\n                    "),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[e._v("</"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[e._v("div")]),e._v(">")]),e._v("\n                "),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[e._v("</"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[e._v("div")]),e._v(">")]),e._v("\n                "),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[e._v("<"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[e._v("div")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("class")]),e._v("="),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v('"media-object-section main-section"')]),e._v(">")]),e._v("\n                    "),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[e._v("<"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[e._v("h2")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("class")]),e._v("="),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v('"h3"')]),e._v(">")]),e._v("{{:book.volumeInfo.title}}"),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[e._v("</"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[e._v("h2")]),e._v(">")]),e._v("\n                    {{if book.volumeInfo.subtitle}}\n                    "),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[e._v("<"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[e._v("h3")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("class")]),e._v("="),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v('"h5 subheader"')]),e._v(">")]),e._v("{{:book.volumeInfo.subtitle}}"),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[e._v("</"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[e._v("h3")]),e._v(">")]),e._v("\n                    {{/if}}\n                    "),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[e._v("<"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[e._v("p")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("class")]),e._v("="),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v('"subheader"')]),e._v(">")]),e._v("{{:~t('Author', book.volumeInfo.authors.length)}}"),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[e._v("</"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[e._v("p")]),e._v(">")]),e._v("\n                    "),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[e._v("<"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[e._v("ul")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("class")]),e._v("="),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v('"no-bullet margin-left-2 margin-bottom-2"')]),e._v(">")]),e._v("\n                        {{for book.volumeInfo.authors}}\n                        "),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[e._v("<"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[e._v("li")]),e._v(">")]),e._v("{{:#data}}"),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[e._v("</"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[e._v("li")]),e._v(">")]),e._v("\n                        {{/for}}\n                    "),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[e._v("</"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[e._v("ul")]),e._v(">")]),e._v("\n                    "),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[e._v("<"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[e._v("p")]),e._v(">")]),e._v("{{:book.volumeInfo.description}}"),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[e._v("</"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[e._v("p")]),e._v(">")]),e._v("\n                "),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[e._v("</"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[e._v("div")]),e._v(">")]),e._v("\n            "),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[e._v("</"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[e._v("div")]),e._v(">")]),e._v("\n        "),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[e._v("</"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[e._v("div")]),e._v(">")]),e._v("\n    "),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[e._v("</"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[e._v("div")]),e._v(">")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[e._v("</"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[e._v("div")]),e._v(">")]),e._v("\n{{/include}}\n")])]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-yaml"}},[t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("# resources/lang/translations.yaml")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("Example")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("page:")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("  en:")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("Example")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("page")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("  fr:")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("Page")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("d'exemple")]),e._v("\n\n"),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("Hello")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("world:")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("  en:")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("Hello")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("world")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("  fr:")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("Bonjour")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("le")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("monde")]),e._v("\n\n"),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("This")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("is")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("an")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("example")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("page:")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("  en:")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("This")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("is")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("an")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("example")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("page")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("  fr:")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("Ceci")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("est")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("une")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("page")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("d'exemple")]),e._v("\n\n"),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("Welcome:")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("  en:")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("Welcome")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("  fr:")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("Bienvenue")]),e._v("\n\n"),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("/create:")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("  en:")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("/create")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("  fr:")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("/creer")]),e._v("\n\n"),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("/edit:")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("  en:")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("/edit")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("  fr:")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("/editer")]),e._v("\n\n\n"),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("# Custom translations")]),e._v("\n\n"),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("Author:")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("  en:")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-bullet"}},[e._v("    -")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("Author")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-bullet"}},[e._v("    -")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("Authors")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("  fr:")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("# Pour nos collègues francophones ;)")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-bullet"}},[e._v("    -")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("Auteur")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-bullet"}},[e._v("    -")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("Auteurs")]),e._v("\n")])])])}],n=t("2877"),o={},l=Object(n["a"])(o,a,r,!1,null,null,null);s["default"]=l.exports},"2ba7":function(e,s,t){},3480:function(e,s,t){"use strict";t.r(s);var a=function(){var e=this,s=e.$createElement;e._self._c;return e._m(0)},r=[function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("section",[t("h1",[e._v("Lifecycle")]),t("h2",[e._v("Introduction")]),t("p",[e._v("The application has an opinionated bootstrapping process.\nYou can find all the bootstrapping process within your own application, under "),t("code",{pre:!0},[e._v("src/bootstrap")]),e._v(".\nIf you need to alter the bootstrapping process, you can change the behavior in those files.")]),t("h2",[e._v("Overview")]),t("p",[e._v("The default Node IoC lifecycle starts from the framework but is mainly dictated by the application bootstrapper.\nIt starts by loading the application, bootstrapping the service providers, then handling the CLI request, and finally terminating the process.\nThe next paragraphs explain in depth the different bootstrapping stages.")]),t("h3",[e._v("Load and configure the application")]),t("p",[e._v("First, the application is loaded from the framework package.\nThe package exposes classes and mixins.\nYou will not find any instances in the exposed items.\nThe "),t("code",{pre:!0},[e._v("Application")]),e._v(" class can be directly used to make an instance of Node IoC application, with "),t("code",{pre:!0},[e._v("Applicatiuon.make()")]),e._v(" method.")]),t("p",[e._v("Once the application has been instantiated, the application must give basic information that is configurable for extending and testing purposes.")]),t("p",[e._v("First, we must give the base folder of the application, which would normally be the current working directory ("),t("code",{pre:!0},[e._v("process.cwd()")]),e._v(").\nHowever, since the working directory can be altered, in order to keep the code predictable, the working directory is manually given to the application instance.")]),t("p",[e._v("Second, we give the current Node.js "),t("code",{pre:!0},[e._v("module")]),e._v(" instance, which is the "),t("code",{pre:!0},[e._v("src/index.js")]),e._v(" module reference inside the bootstrapper.\nThe application container uses this module to require files and packages, so no need to worry about packages tree-shaking issues.\nYour packages version will be used, even if it creates conflicts with other required versions.")]),t("p",[e._v("When the configuration is done, the bootstrapper binds the two main handlers: the "),t("code",{pre:!0},[e._v("kernel")]),e._v(", which is by default located at "),t("code",{pre:!0},[e._v("src/app/console/Kernel.js")]),e._v(", and the "),t("code",{pre:!0},[e._v("exception.handler")]),e._v(", which is by default located at "),t("code",{pre:!0},[e._v("src/app/exceptions/Handler.js")]),e._v(".")]),t("p",[e._v("The application instance contains four core bootstrappers that cannot be replaced since they are used by the core items in the framework:")]),t("ul",[t("li",[e._v("EventServiceProvider")]),t("li",[e._v("FileServiceProvider")]),t("li",[e._v("SupportServiceProvider")]),t("li",[e._v("ConfigServiceProvider")])]),t("h3",[e._v("Instantiate the kernel")]),t("p",[e._v("Now that everything has been configured, the application can run.")]),t("p",[e._v("The kernel is first instantiated.\nWhen it occurs, it will automatically register the core service providers of the framework.\nThose service providers contain all the useful services to bring Node IoC to life.\nHere are the core kernel bootstrappers:")]),t("ul",[t("li",[e._v("CacheServiceProvider,")]),t("li",[e._v("LogServiceProvider,")]),t("li",[e._v("HttpServiceProvider,")]),t("li",[e._v("SecurityServiceProvider,")]),t("li",[e._v("DatabaseServiceProvider,")]),t("li",[e._v("TranslationServiceProvider,")]),t("li",[e._v("ValidationServiceProvider,")]),t("li",[e._v("ViewServiceProvider")]),t("li",[e._v("TestServiceProvider (for non-production process)")])]),t("p",[e._v("The Console service provider adds the ConsoleServiceProvider in the bootstrappers list.")]),t("p",[e._v("However, instantiating the kernel will not boot the service providers.\nThey will only be registered in the application.")]),t("p",[e._v("Your application and module service providers are not yet registered in the application.\nIt will happen when the application boots.")]),t("h3",[e._v("Bootstrap application")]),t("p",[e._v("Not that all the core service providers have been registered into the application, we can start the application.")]),t("p",[e._v("It will first call the "),t("code",{pre:!0},[e._v("register")]),e._v(" method of all the registered service providers, followed by the "),t("code",{pre:!0},[e._v("boot")]),e._v(" method.")]),t("p",[e._v("Inside the "),t("code",{pre:!0},[e._v("register")]),e._v(" method, we must assume that no services are available yet.\nYou should expose the services that your application or module is providing.")]),t("p",[e._v("Inside the "),t("code",{pre:!0},[e._v("boot")]),e._v(" method, all the service providers have been registered, we can now assume that the services are available.\nIt is a good time to use the configuration, the command registrar, the router, etc.")]),t("h4",[e._v("Register service providers")]),t("p",[e._v("When the application boots, it will first register the four core application service providers.\nThe last one, the ConfigServiceProvider, will break the rule of assuming that no service is available since it is directly linked to the application bootstrap process and is strongly bound to the good behavior of your application.")]),t("p",[e._v("It will register all the service providers that are configured under the "),t("code",{pre:!0},[e._v("app.providers")]),e._v(" configuration key.\nYou can add your service providers under the "),t("code",{pre:!0},[e._v("config/app.yaml")]),e._v(" file.")]),t("p",[e._v("It will register all the service providers into the application.")]),t("p",[e._v("Then, the real registration begins.")]),t("p",[e._v("The application will loop through all the registered service providers to first instantiate them, and then to call the "),t("code",{pre:!0},[e._v("register")]),e._v(" method.\nDuring that time, service providers are allowed to register other service providers.\nThose will be put in the current queue.")]),t("p",[e._v("You will only have two opportunities to register a service provider programmatically: before or during the registering process and after the booting process.\nIf you need to act after all the services are exposed, you can take a look at the "),t("code",{pre:!0},[e._v("this.app.onBooted()")]),e._v(" hook.")]),t("p",[e._v("During this phase, you can bind your own services in the application container, and load your configuration.")]),t("h4",[e._v("Boot service providers")]),t("p",[e._v("After all service providers are registered, they are booted through the "),t("code",{pre:!0},[e._v("boot")]),e._v(" method.\nDuring this phase, you can assume that the services are all registered.\nFeel free to use "),t("code",{pre:!0},[e._v("config")]),e._v(", "),t("code",{pre:!0},[e._v("command")]),e._v(", "),t("code",{pre:!0},[e._v("file")]),e._v(", "),t("code",{pre:!0},[e._v("router")]),e._v(", etc.")]),t("p",[e._v("During this phase, you can either interact with those services or initialize your own services.\nSince a service binding will not instantiate the class or call the closure, you will need to use "),t("code",{pre:!0},[e._v("this.app.make('my.service')")]),e._v(" to instantiate and initialize your service at least once (depending on its status as a singleton in the container).")]),t("p",[e._v("Common tasks done during this phase are registering commands, creating routes, adding translations, etc.")]),t("h3",[e._v("Handle request")]),t("p",[e._v("When the application has booted, the kernel will handle the request.\nIf you are using the console kernel, which is already the case with a default Node IoC application, the handling process goes through "),t("code",{pre:!0},[e._v("beforeHandling")]),e._v(" and "),t("code",{pre:!0},[e._v("afterHandling")]),e._v(" internal hooks.\nThe default application console kernel already loads the application commands for you, so you don't have to manually register them.")]),t("p",[e._v("Once the "),t("code",{pre:!0},[e._v("beforeHandling")]),e._v(" hook has been called, the real handling process starts.\nThe kernel will resolve the current command through the command registrar, which have access to the command repository and the Yargs engine.\nIt will bootstrap the engine with the commands stored in the repository, and execute the command through the command runner.")]),t("p",[e._v("When the handling has completed without any error, the "),t("code",{pre:!0},[e._v("afterHandling")]),e._v(" internal hook is called in the console kernel.\nIf an error occurs during the handling process, it will not be called.")]),t("h4",[e._v("Preprocess")]),t("p",[e._v("First, the command "),t("code",{pre:!0},[e._v("preprocess")]),e._v(" method is called.\nThis method has the ability to alter the received arguments from the CLI.\nBy default, the arguments are not altered, but you may change them if you need to.\nThe returned value will then be passed as the "),t("code",{pre:!0},[e._v("argv")]),e._v(".")]),t("h4",[e._v("Handle")]),t("p",[e._v("The most common case is that you will need to handle the CLI request.\nIn the "),t("code",{pre:!0},[e._v("handle")]),e._v(" method, the command process the request.\nIt may output data in the terminal, call other services, etc.\nIt plays the same role as a controller (or a handler) in a Web MVC/MVA application.")]),t("h4",[e._v("ForwardCall")]),t("p",[e._v("It may happen that a created command only pre-processes/post-processes data.\nIn those cases, the "),t("code",{pre:!0},[e._v("handle")]),e._v(" method may not be called.\nIf a "),t("code",{pre:!0},[e._v("forward")]),e._v(" property exists in the command instance, the value, that represents an underlying command name that will handle the process, will be used to forward the call to the specified command instance.")]),t("p",[e._v("Let's say for instance that "),t("code",{pre:!0},[e._v("foo")]),e._v(" and "),t("code",{pre:!0},[e._v("private:foo")]),e._v(" command exists, and only "),t("code",{pre:!0},[e._v("foo")]),e._v(" is visible through the CLI since the "),t("code",{pre:!0},[e._v("private:foo")]),e._v(" command has a "),t("code",{pre:!0},[e._v("private")]),e._v(" policy (we will go into this later).\n"),t("code",{pre:!0},[e._v("foo")]),e._v(" can then forward the call to "),t("code",{pre:!0},[e._v("private:foo")]),e._v(", but preprocess the input before calling "),t("code",{pre:!0},[e._v("private:foo")]),e._v(".")]),t("p",[e._v("If the signature of "),t("code",{pre:!0},[e._v("foo")]),e._v(" is "),t("code",{pre:!0},[e._v("foo [--bar]")]),e._v(", where "),t("code",{pre:!0},[e._v("[--bar]")]),e._v(" is an optional flag, and the signature of "),t("code",{pre:!0},[e._v("private:foo")]),e._v(" is "),t("code",{pre:!0},[e._v("private:foo <type>")]),e._v(", where "),t("code",{pre:!0},[e._v("<type>")]),e._v(" is a required parameter, the "),t("code",{pre:!0},[e._v("<type>")]),e._v(" parameter can be preprocessed from the "),t("code",{pre:!0},[e._v("[--bar]")]),e._v(" flag.")]),t("p",[e._v("It may be useful when using third party commands that remain private or scope to given policies in order to prevent command pollution in the CLI "),t("code",{pre:!0},[e._v("list")]),e._v(" command.")]),t("h4",[e._v("Postprocess")]),t("p",[e._v("Finally, when the command has handled the request, or an underlying command has handled the request for the current command, the current command can act before the request termination.")]),t("h3",[e._v("Terminate process")]),t("p",[e._v("When the kernel has finished handling the request, it terminates the request.\nIt will first call an internal hook called "),t("code",{pre:!0},[e._v("terminating")]),e._v(", so you can act before terminating the process.")]),t("p",[e._v("When terminating, the process will exit, if specified to exit.\nBy default, the kernel is configured to exit the process when terminating.\nYou can alter this behavior by calling "),t("code",{pre:!0},[e._v("kernel.shouldExit(false)")]),e._v(" to prevent process exit.\nHowever, if the process should exit, it will exit with code 0 or 1, depending on if an exception has been handled by the "),t("code",{pre:!0},[e._v("exception.handler")]),e._v(" instance.")])])}],n=t("2877"),o={},l=Object(n["a"])(o,a,r,!1,null,null,null);s["default"]=l.exports},"40d5":function(e,s,t){"use strict";var a=t("c674"),r=t.n(a);r.a},"43d5":function(e,s,t){"use strict";t.r(s);var a=function(){var e=this,s=e.$createElement;e._self._c;return e._m(0)},r=[function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("section",[t("h1",[e._v("Service provider")]),t("h2",[e._v("Introduction")]),t("p",[e._v("In Node IoC, as some other platforms do (Laravel, Angular.js, Java, .NET, etc), the main way to expose services and to be part of the bootstrapping process is through the service providers.\nEssentially, they act as their own module managers.\nThey bind the services into the application, propose a basic configuration, register commands, models, views, routes, controllers and other entities.")]),t("h2",[e._v("Write service providers")]),t("p",[e._v("Writing a service provider is very simple.\nYou can do it in two ways.\nThe first is by creating a file containing a single service provider class that extends the "),t("code",{pre:!0},[e._v("ServiceProvider")]),e._v(" class provided by the framework.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("import")]),e._v(" { ServiceProvider } "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("from")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'@absolunet/ioc'")]),e._v(";\n\n"),t("span",{pre:!0,attrs:{class:"hljs-class"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("class")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("SomeServiceProvider")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("extends")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("ServiceProvider")]),e._v(" ")]),e._v("{\n\n    "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("/**\n     * Register the service provider.\n     */")]),e._v("\n    register() {\n        "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("//")]),e._v("\n    }\n\n    "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("/**\n     * Register the service provider.\n     */")]),e._v("\n    boot() {\n        "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("//")]),e._v("\n    }\n\n}\n\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("export")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("default")]),e._v(" SomeServiceProvider;\n")])]),t("p",[e._v("The other way requires that you have proper local configuration ("),t("code",{pre:!0},[e._v("app.env")]),e._v(" configuration must be "),t("code",{pre:!0},[e._v("local")]),e._v(").\nYou can use the following command:")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-bash"}},[e._v("node ioc make:provider SomeServiceProvider\n")])]),t("p",[e._v("This will create a service provider scaffold inside "),t("code",{pre:!0},[e._v("src/app/providers")]),e._v(".")]),t("p",[e._v("All you have to do is to implement the wanted methods, "),t("code",{pre:!0},[e._v("register")]),e._v(" and "),t("code",{pre:!0},[e._v("boot")]),e._v(".")]),t("h3",[e._v("The register method")]),t("p",[e._v("The register method is called during the first step of the application booting process.\nWhen the application boots, it starts by registering the core service providers, which also add the configured service providers in the application to be booted.")]),t("p",[e._v("In this method, as explained earlier, you should consider that no services are available yet.")]),t("p",[e._v("You should only bind your own services in the application container to make them available to others during the booting process.")]),t("p",[e._v("You can also, if necessary, register other service providers during this phase.\nNevertheless, it is a better practice to use the "),t("code",{pre:!0},[e._v("app.provider")]),e._v(" configuration to register service providers.")]),t("p",[e._v("However, since you are using the application that bootstraps the providers that bind "),t("code",{pre:!0},[e._v("event")]),e._v(", "),t("code",{pre:!0},[e._v("file")]),e._v(", "),t("code",{pre:!0},[e._v("config")]),e._v(" and "),t("code",{pre:!0},[e._v("env")]),e._v(", you can assume that they will be available.\nHowever, don't forget to check that the services exist before using them during the registering process.")]),t("p",[e._v("Considering this, the base service provider class offers a "),t("code",{pre:!0},[e._v("loadConfigFromFolder")]),e._v(" method that accepts path segments as arguments.\nThis method will search in the given folder for any configuration file and merge them in the configuration within the repository.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("import")]),e._v(" { ServiceProvider }  "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("from")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'@absolunet/ioc'")]),e._v(";\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("import")]),e._v(" OtherServiceProvider "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("from")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'@namespace/ioc-module'")]),e._v(";\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("import")]),e._v(" SomeService          "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("from")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'./services/SomeService'")]),e._v(";\n\n"),t("span",{pre:!0,attrs:{class:"hljs-class"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("class")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("SomeServiceProvider")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("extends")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("ServiceProvider")]),e._v(" ")]),e._v("{\n\n    register() {\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".app.register(OtherServiceProvider);\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".loadConfigFromFolder(__dirname, "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'..'")]),e._v(", "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'config'")]),e._v(");\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".app.bind("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'some.service'")]),e._v(", SomeService);\n    }\n\n}\n")])]),t("h3",[e._v("The boot method")]),t("p",[e._v("After all the service providers have been properly registered, the booting phase begins.\nIn the same order, the service providers are booted.\nThose who have been registered in the application during the registering process will be put at the end of the queue.")]),t("p",[e._v("During this phase, all services are available and ready to use.\nYou can bootstrap your own services, use other services and interact with them.")]),t("p",[e._v("An easy example would be to register custom commands.\nBy default, the console kernel registers them for you, but if you are developing a module, for instance, you would have to register the commands manually.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("import")]),e._v(" { ServiceProvider } "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("from")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'@absolunet/ioc'")]),e._v(";\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("import")]),e._v(" SomeCommand         "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("from")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'./commands/SomeCommand'")]),e._v(";\n\n"),t("span",{pre:!0,attrs:{class:"hljs-class"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("class")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("SomeServiceProvider")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("extends")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("ServiceProvider")]),e._v(" ")]),e._v("{\n\n    boot() {\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".loadCommands([\n            SomeCommand\n        ]);\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".app.make("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'some.service'")]),e._v(").prepare();\n    }\n\n}\n")])]),t("h2",[e._v("Register service providers")]),t("p",[e._v("To register service providers, there are two ways to do it.")]),t("p",[e._v("The first one is by using the application "),t("code",{pre:!0},[e._v("register")]),e._v(" method.\nIt accepts any resolvable as value (class, instance, factory or path/module).\nIt should be used only if necessary, as if it needs some logic before registering it.")]),t("p",[e._v("The other way to do it, considered a better practice, would be from the configuration.")]),t("p",[e._v("In your "),t("code",{pre:!0},[e._v("config")]),e._v(" folder, you can find the "),t("code",{pre:!0},[e._v("app.yaml")]),e._v(" configuration file.\nThe "),t("code",{pre:!0},[e._v("providers")]),e._v(" key in this file contains an array of paths, each path pointing to a service provider.")]),t("p",[e._v("By default, you will have your two application service providers:")]),t("ul",[t("li",[e._v("AppServiceProvider")]),t("li",[e._v("RouteServiceProvider")])]),t("p",[e._v("The grammar used to include those files is made such as you can either fill a resolvable module, an absolute path or a relative path from the base path of the application, prefixed by "),t("code",{pre:!0},[e._v("@/")]),e._v(".")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-yaml"}},[t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("# config/app.yaml")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("# ...")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("providers:")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-bullet"}},[e._v("  -")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'@namespace/ioc-module'")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("# This module main file exposes the service provider as a default export")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-bullet"}},[e._v("  -")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'/path/to/my/ServiceProvider'")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-bullet"}},[e._v("  -")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'@/dist/node/app/providers/AppServiceProvider'")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("# The '@/' portion at the beginning indicates 'the application base path'")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-bullet"}},[e._v("  -")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'@/dist/node/app/providers/RouteServiceProvider'")]),e._v("\n")])])])}],n=t("2877"),o={},l=Object(n["a"])(o,a,r,!1,null,null,null);s["default"]=l.exports},"47d0":function(e,s,t){"use strict";var a=t("f270"),r=t.n(a);r.a},"4ddb":function(e,s,t){"use strict";t.r(s);var a=function(){var e=this,s=e.$createElement;e._self._c;return e._m(0)},r=[function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("section",[t("h1",[e._v("Installation")]),t("h2",[e._v("Server requirements")]),t("p",[e._v("The Node IoC has some basic server requirements.\nYou need to have a globally installed Node.js binary at version "),t("code",{pre:!0},[e._v(">= 12")]),e._v(".\nIt was tested on Nginx 1.16.1, as well as on Apache 2.0.\nIt was also tested locally on a Windows 10 distribution, but nothing has been tested on a Windows IIS server yet.")]),t("p",[e._v("You will also need NPM at version "),t("code",{pre:!0},[e._v(">=6.9.0")]),e._v(" (stable) or Yarn at version "),t("code",{pre:!0},[e._v(">=1.19.1")]),e._v(" (stable)")]),t("h2",[e._v("Create a new Node IoC application")]),t("p",[e._v("To create a new Node IoC application, you may clone (or download) the official "),t("a",{attrs:{href:"https://github.com/absolunet/node-ioc-app"}},[e._v("Node IoC application scaffold")]),e._v(".\nThis repository is always up to date to the last framework version.\nIt provides everything needed to quickly start a new Node.js project.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-bash"}},[t("span",{pre:!0,attrs:{class:"hljs-built_in"}},[e._v("cd")]),e._v(" [your-working-directory]\ngit "),t("span",{pre:!0,attrs:{class:"hljs-built_in"}},[e._v("clone")]),e._v(" https://github.com/absolunet/node-ioc-app.git [your-application-name]\n"),t("span",{pre:!0,attrs:{class:"hljs-built_in"}},[e._v("cd")]),e._v(" [your-application-name]\n")])]),t("p",[e._v("With this method, you will download the Git history as well.\nSimply delete the "),t("code",{pre:!0},[e._v(".git")]),e._v(" folder and start a fresh history with "),t("code",{pre:!0},[e._v("git init")]),e._v(" (if you are working with Git as your SVN)")]),t("p",[e._v("Now that the application has been downloaded, install the project dependencies, with the development dependencies so\nyou can test your application.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-bash"}},[e._v("npm install\n"),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("# or")]),e._v("\nyarn\n")])]),t("p",[t("em",[e._v("From now on, NPM will be used for examples")])]),t("h2",[e._v("Compile source code")]),t("p",[e._v("The application, as well as the framework, was built with the latest ES6+ features.\nIn order to properly work on an older environment, without experimental flags or unstable implementation, they rely on Babel transpiler, which basically converts EcmaScript Modules (ESM) to CommonJS, the default Node.js modular system.\nThat being said, you are free to use any JavaScript preprocessor you want, such as TypeScript.\nHowever, the application comes with vanilla JavaScript only, without any TypeScript definition.")]),t("h3",[e._v("Node Manager")]),t("p",[e._v("To compile your code, "),t("a",{attrs:{href:"https://absolunet.com"}},[e._v("Absolunet")]),e._v(" built a "),t("a",{attrs:{href:"https://github.com/absolunet/node-manager"}},[e._v("Node Manager")]),e._v(" to facilitate code compilation, outdated dependencies reports, package deployment, API documentation generation, and much more.\nBy the way, feel free to check the amazing "),t("a",{attrs:{href:"https://github.com/absolunet"}},[e._v("Absolunet public packages")]),e._v("!")]),t("h3",[e._v("Compile using Node Manager")]),t("p",[e._v("To compile the source code, simply run the manager task:")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-bash"}},[e._v("npm run manager:build\n")])]),t("p",[e._v("You can also use the build watch feature, so you can quickly develop without having to manually compile your source code.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-bash"}},[e._v("npm run manager:watch\n")])]),t("p",[e._v("Node Manager uses Webpack bundler under the hood.\nYou won't have to bother all the compilation configuration, everything is already set up for you.\nIf you feel that some additional configuration is needed, please read the official "),t("a",{attrs:{href:"https://documentation.absolunet.com/node-manager"}},[e._v("Node Manager documentation")]),e._v(".")]),t("h2",[e._v("Run CLI")]),t("p",[e._v("Now that your application has been compiled, you are ready to use Node IoC.\nThe basic command to run your application CLI must start by "),t("code",{pre:!0},[e._v("node ioc")]),e._v(", followed by your command.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-bash"}},[e._v("node ioc\n")])]),t("p",[e._v("This should display the list of available command, that should look like this:")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-text"}},[e._v("Node IoC\n\nUsage:\n  command [arguments] [options]\n\nAvailable commands:\n   env           Display the application environment.\n   list          List all available commands.\n   serve         Serve the application.\n  cache\n   cache:clear   Flush the application cache.\n   cache:forget  Remove an item from the cache.\n\nOptions:\n  --help         Show help\n  --version      Show version number\n  -v, --verbose  Adjust the verbosity of the command\n")])]),t("p",[e._v("You can also use this alias")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-bash"}},[e._v("node ioc list\n")])]),t("p",[e._v("When you start using the application, you will only have a few commands available, for multiple reasons:")]),t("ul",[t("li",[e._v("Your environment has not been set yet")]),t("li",[e._v("You don't have any module installed")]),t("li",[e._v("You have not built your own commands yet")])]),t("h2",[e._v("Run server")]),t("p",[e._v("One of the available commands is called "),t("code",{pre:!0},[e._v("serve")]),e._v(".\nIt starts your application HTTP server, which is powered by Express.")]),t("p",[e._v("To start the server, use this command:")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-bash"}},[e._v("node ioc serve\n")])]),t("p",[e._v("You should see "),t("code",{pre:!0},[e._v("This is serving on port 8080...")]),e._v(" appearing, indicating that your server has successfully started.\nYou can now visit your application website through "),t("a",{attrs:{href:"http://localhost:8080"}},[e._v("http://localhost:8080")]),e._v(".\nA basic website scaffold comes with the application for example purpose, but feel free to change whatever you want.")]),t("p",[e._v("The port remains configurable with the "),t("code",{pre:!0},[e._v("--port")]),e._v(" option.\nIf you want to know how a command works, you can use the "),t("code",{pre:!0},[e._v("--help")]),e._v(" flag.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-bash"}},[e._v("node ioc serve --"),t("span",{pre:!0,attrs:{class:"hljs-built_in"}},[e._v("help")]),e._v("\n")])]),t("p",[e._v("It will show you something like this:")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-text"}},[e._v("ioc serve\n\nServe the application.\n\nOptions:\n  --help          Show help                                                                                    [boolean]\n  --version       Show version number                                                                          [boolean]\n  -v, --verbose   Adjust the verbosity of the command                                                            [count]\n  --port          Port to use to serve the application.                                         [string] [default: 8080]\n  --daemon        Use a daemon to automatically restart the serve process when a file has changed.             [boolean]\n  --silent        Silently run the process without any console output.                                         [boolean]\n  --start-silent  Silently start the process, but still output data in the console afterward.                  [boolean]\n")])]),t("h2",[e._v("Configuration")]),t("h3",[e._v("Configure Node.js HTTP proxy")]),t("p",[e._v("In a conventional server, the ports 80 and 443 are already reserved in order to serve content.\nWith this constraint, a reverse proxy must be configured to redirect port 80 (or 443) requests to the application port (8080 by default).")]),t("h4",[e._v("Apache")]),t("p",[e._v("Here is the basic configuration for Apache server.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-apacheconfig"}},[e._v('<VirtualHost *:80>\n    ServerName myApp\n    ServerAlias my-app.example.com\n    DocumentRoot /var/www/my_app\n\n    ProxyRequests Off\n    ProxyPreserveHost On\n    ProxyVia Full\n\n\n    <Directory "/">\n        Options -Indexes +FollowSymLinks\n        AllowOverride None\n        Require all granted\n\n        # Here, we indicate that any requests made to "http://my-app.example.com"\n        # domain, on port 80, is actually made to "http://localhost:8080".\n        # If a request to the page "http://my-app.example.com/foo/bar" is made,\n        # apache will resolve the response through "http://localhost:8080/foo/bar".\n\n        ProxyPass http://localhost:8080\n        ProxyPassReverse http://localhost:8080\n    </Directory>\n\n    <Proxy *>\n        Require all granted\n    </Proxy>\n</VirtualHost>\n')])]),t("h4",[e._v("Nginx")]),t("p",[e._v("Here is the basic configuration for Nginx server.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":""}},[e._v('server {\n    index index.html;\n    server_name my-app.example.com;\n    root /var/www/my_app;\n    listen 80;\n\n    location / {\n\n        # Here, we indicate that any request made to "http://my-app.example.com"\n        # domain, on port 80, is actually made to "http://localhost:8080".\n        # If a request to the page "http://my-app.example.com/foo/bar" is made,\n        # nginx will resolve the response through "http://localhost:8080/foo/bar".\n\n        proxy_pass http://localhost:8080;\n        proxy_http_version 1.1;\n        proxy_set_header Upgrade $http_upgrade;\n        proxy_set_header Connection \'upgrade\';\n        proxy_set_header Host $host;\n        proxy_cache_bypass $http_upgrade;\n    }\n}\n')])]),t("h3",[e._v("Configure process management")]),t("p",[e._v("Since Node.js is an engine that is not bootstrapped my the Apache or the Nginx server, it must be started manually.\nThe "),t("code",{pre:!0},[e._v("node ioc serve")]),e._v(" starts a new process that listens to the HTTP port 8080.\nHowever, in order to make this process automatically started on server boot, a process manager can be a very good help to monitor the process and ensure that it is fully running anytime.")]),t("h4",[e._v("PM2")]),t("p",[t("a",{attrs:{href:"http://pm2.keymetrics.io/"}},[e._v("PM2")]),e._v(" is one of the most popular "),t("em",[e._v("Node.js")]),e._v(" production process managers.\nIt allows to easily manage, start, stop, restart, and monitor processes.")]),t("p",[e._v("First, install the package globally.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-bash"}},[e._v("npm install -g pm2\n")])]),t("p",[e._v("Then, go to your application directory and run the command to create the pm2 service instance.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-bash"}},[e._v("pm2 start "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v('"node ioc serve"')]),e._v(" --name "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v('"my-app"')]),e._v("\n")])]),t("p",[e._v("This will first create the "),t("code",{pre:!0},[e._v("my-app")]),e._v(" process into PM2, then it will start the process.\nYour application will then run at port 8080.\nThe reverse proxy will then do the trick to enable your website over port 80 or 443.")]),t("p",[e._v("You can stop the process by running the following command.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-bash"}},[e._v("pm2 stop my-app\n")])]),t("p",[e._v("If you want to restart it, simply use your process name.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-bash"}},[e._v("pm2 start my-app\n")])]),t("p",[e._v("To enable PM2 to start on server boot, please follow the "),t("a",{attrs:{href:"http://pm2.keymetrics.io/docs/usage/startup/"}},[e._v("official documentation")]),e._v(".")]),t("h3",[e._v("Configuration files")]),t("p",[e._v("Node IoC makes it very easy to manage packages and framework behavior through configuration files.\nThose files are located under the "),t("code",{pre:!0},[e._v("config")]),e._v(" folder.\nThe configuration system supports "),t("code",{pre:!0},[e._v(".yaml")]),e._v(", "),t("code",{pre:!0},[e._v("yml")]),e._v(", "),t("code",{pre:!0},[e._v(".js")]),e._v(" and "),t("code",{pre:!0},[e._v(".json")]),e._v(" files.\nBy default, "),t("code",{pre:!0},[e._v(".yaml")]),e._v(" files are being used, mostly for readability.\nIf you are using "),t("code",{pre:!0},[e._v(".js")]),e._v(" files, make sure you are using common.js syntax ("),t("code",{pre:!0},[e._v("module.exports = {}")]),e._v(") instead of EcmaScript modules ("),t("code",{pre:!0},[e._v("export default {}")]),e._v("), since those files are never compiled.")]),t("p",[e._v("However, here are the key points:")]),t("ul",[t("li",[e._v("A configuration can contain any type of JSON-compatible value: null, string, number, boolean, object, or array")]),t("li",[e._v("Dotted string notation is used to access configuration; the config keys must not contain dots")]),t("li",[e._v("The configuration namespaces are the file names (eg: "),t("code",{pre:!0},[e._v("foo.bar")]),e._v(" references to the "),t("code",{pre:!0},[e._v("bar")]),e._v(" first-level key inside "),t("code",{pre:!0},[e._v("foo.yaml")]),e._v(" file)")]),t("li",[e._v("To reference the application root path, the value must start by "),t("code",{pre:!0},[e._v("@/")]),e._v(" (eg: "),t("code",{pre:!0},[e._v("@/storage/logs/ioc.log")]),e._v(")")]),t("li",[e._v("To reference the home directory path the value must start by "),t("code",{pre:!0},[e._v("~/")]),e._v(" (eg: "),t("code",{pre:!0},[e._v("~/.ssh/id_rsa.pub")]),e._v(")")]),t("li",[e._v("To reference an environment variable, the value must contain double mustaches (eg: "),t("code",{pre:!0},[e._v("{{SOME_VARIABLE}}")]),e._v(")")]),t("li",[e._v("To reference an environment variable with a fallback value, you must use a pipe to separate the variable from the default value (eg: "),t("code",{pre:!0},[e._v("{{SOME_VARIABLE|default value}}")]),e._v(")")]),t("li",[e._v("An environment variable can be used inside a value (eg: "),t("code",{pre:!0},[e._v("foo_{{SOME_VARIABLE}}_bar")]),e._v(", "),t("code",{pre:!0},[e._v("{{SOME_VARIABLE|table_name}}.column_name")]),e._v(")")])]),t("h3",[e._v("Environment")]),t("p",[e._v("The environment is very useful to quickly adapt the configuration from a local machine to the production server.\nThe configuration can directly reference the environment variable with the double mustache syntax.\nHowever, to ensure that the environment remains simple to manage, a "),t("code",{pre:!0},[e._v(".env")]),e._v(" file can be used in your application.\nEvery key-value pair will be merged in the existing environment during your application execution time.\nA "),t("code",{pre:!0},[e._v(".env.example")]),e._v(" is provided by default in the application repository.\nSimply copy the file with the name "),t("code",{pre:!0},[e._v(".env")]),e._v(" and change the appropriate values, such as "),t("code",{pre:!0},[e._v("APP_ENV")]),e._v(", that will specify the application environment, such as "),t("code",{pre:!0},[e._v("local")]),e._v(", "),t("code",{pre:!0},[e._v("test")]),e._v(", "),t("code",{pre:!0},[e._v("staging")]),e._v(" or "),t("code",{pre:!0},[e._v("production")]),e._v(".\nThe environment repository can be used to safely retrieve environment variable (eg: "),t("code",{pre:!0},[e._v("app.make('env').get('APP_ENV', 'production')")]),e._v(" (get "),t("code",{pre:!0},[e._v("APP_ENV")]),e._v(" environment variable value, with "),t("code",{pre:!0},[e._v("production")]),e._v(" as default value)).\nIf the file does not exist, the current environment will still be accessible through the application and the environment repository.")]),t("h3",[e._v("Directory permissions")]),t("p",[e._v("The whole project must be accessible in "),t("em",[e._v("read")]),e._v(" mode for your application, in order to require and execute JavaScript files and read configuration and environment files.\nHowever, the "),t("code",{pre:!0},[e._v("storage")]),e._v(" directory must be writable by your application, since logs, cache, SQLite database and uploaded files are stored in this directory.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-bash"}},[e._v("sudo chgrp -R www-data storage\nsudo chmod -R ug+rwx storage\n")])])])}],n=t("2877"),o={},l=Object(n["a"])(o,a,r,!1,null,null,null);s["default"]=l.exports},"4e29":function(e,s,t){},5172:function(e,s,t){},"556a":function(e,s,t){"use strict";t.r(s);var a=function(){var e=this,s=e.$createElement;e._self._c;return e._m(0)},r=[function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("section",[t("h1",[e._v("Configuration")]),t("h2",[e._v("Introduction")]),t("p",[e._v("The configuration system is one of the simplest concepts of Node IoC, but surely one of the most powerful ones.\nIt allows using module services without caring about passing options or instantiating the same class again and again.")]),t("p",[e._v("It mainly relies on the files located in the "),t("code",{pre:!0},[e._v("config")]),e._v(" directory and the "),t("code",{pre:!0},[e._v("config")]),e._v(" repository, powered by the evaluator and grammar services.")]),t("p",[e._v("Parallel to the configuration system, the environment variables are also very useful to use for sensitive data, or configuration that may change over different environments.\nThe environment variables are, like most of the modern applications, located in the "),t("code",{pre:!0},[e._v(".env")]),e._v(" file.")]),t("h2",[e._v("Files")]),t("p",[e._v("The configuration files are by default located in the "),t("code",{pre:!0},[e._v("config")]),e._v(" folder of a Node IoC application.\nThe configuration is written in "),t("code",{pre:!0},[e._v("yaml")]),e._v(" files, but the repository handles "),t("code",{pre:!0},[e._v(".yaml")]),e._v(", "),t("code",{pre:!0},[e._v(".yml")]),e._v(", "),t("code",{pre:!0},[e._v(".json")]),e._v(" and "),t("code",{pre:!0},[e._v(".js")]),e._v(" files.\nFor the JavaScript files, they must be written in CommonJS since they are not compiled by Babel.")]),t("p",[e._v("Each file represents a namespace, which name is the file name itself.\nFor instance, the "),t("code",{pre:!0},[e._v("app.yaml")]),e._v(" file represents the "),t("code",{pre:!0},[e._v("app")]),e._v(" namespace.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-yaml"}},[t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("# config/example.yaml")]),e._v("\n\n"),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("key:")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("value")]),e._v("\n\n"),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("options:")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("    foo:")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("bar")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("    baz:")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-literal"}},[e._v("true")]),e._v("\n")])]),t("p",[e._v("Here, we could access the value from the "),t("code",{pre:!0},[e._v("example.key")]),e._v(" key to get "),t("code",{pre:!0},[e._v('"value"')]),e._v(".\nWe could also get "),t("code",{pre:!0},[e._v("example.options")]),e._v(" to get an object matching "),t("code",{pre:!0},[e._v('{ foo: "bar", baz: true }')]),e._v(", and so on.")]),t("p",[e._v("We could also use folders to create namespaces.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-yaml"}},[t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("# config/namespace/file.yaml")]),e._v("\n\n"),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("key:")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("value")]),e._v("\n")])]),t("p",[e._v("Here, the "),t("code",{pre:!0},[e._v("namespace")]),e._v(" configuration key would match "),t("code",{pre:!0},[e._v('{ file: { key: "value" } }')]),e._v(", "),t("code",{pre:!0},[e._v("namespace.file.key")]),e._v(" would equal "),t("code",{pre:!0},[e._v('"value"')]),e._v(".")]),t("h2",[e._v("The config repository")]),t("p",[e._v("To access the configuration, the "),t("code",{pre:!0},[e._v("config")]),e._v(" repository can be injected in any makeable class.\nIt allows us to get values from loaded configuration files, but also to manipulate them.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("const")]),e._v(" configRepository = app.make("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'config'")]),e._v(");\n\nconfigRepository.get("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'app.name'")]),e._v("); "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v('// "Node IoC"')]),e._v("\nconfigRepository.get("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'view.extensions'")]),e._v("); "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v('// ["html", "jshtml"]')]),e._v("\n\nconfigRepository.set("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'app.name'")]),e._v(", "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'My application'")]),e._v(");\nconfigRepository.get("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'app.name'")]),e._v("); "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v('// "My application"')]),e._v("\n\nconfigRepository.get("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'app.unknown'")]),e._v(", "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'default value'")]),e._v("); "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v('// "default value"')]),e._v("\nconfigRepository.get("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'app.unknown'")]),e._v("); "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("// null")]),e._v("\n")])]),t("p",[e._v("This repository allows accessing and mutating configuration, but also to load configuration files.")]),t("p",[e._v("Given the following file tree:")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":""}},[e._v("- custom\n    - config\n        - foo.yaml -> key: value\n        - bar.yaml -> key: other value\n        - namespace\n            - baz.yaml -> key: nested value\n")])]),t("p",[e._v("You can load all configuration files from a single method and keep its relative tree as configuration namespaces.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("const")]),e._v(" configRepository = app.make("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'config'")]),e._v(");\n\nconfigRepository.loadConfigFromFolder("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'/custom/config'")]),e._v(");\nconfigRepository.get("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'foo'")]),e._v("); "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v('// { key: "value" }')]),e._v("\nconfigRepository.get("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'bar'")]),e._v("); "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v('// { key: "other value" }')]),e._v("\nconfigRepository.get("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'namespace'")]),e._v("); "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v('// { baz: { key: "nested value" } }')]),e._v("\n")])]),t("h2",[e._v("The config.grammar service")]),t("p",[e._v("To make sure the configuration is mostly static and predictable, YAML files are used by default instead of JavaScript files, which may add dynamic values.\nIt is not recommended, but still available if you need it.")]),t("p",[e._v("However, some values are normally based on others, or on application core configuration, such as base path.")]),t("p",[e._v("The "),t("code",{pre:!0},[e._v("config.grammar")]),e._v(" service is used by default by the configuration repository to parse each value.\nIt allows using a specific grammar in the configuration, tokens, if you will, to be replaced by dynamic values.")]),t("p",[e._v("There are mainly three tokens parsed across configuration values:")]),t("ul",[t("li",[t("p",[t("code",{pre:!0},[e._v("@/")])]),t("blockquote",[t("p",[e._v("Represents the root of the application")])])]),t("li",[t("p",[t("code",{pre:!0},[e._v("~/")])]),t("blockquote",[t("p",[e._v("Represents the root of the home directory")])])]),t("li",[t("p",[t("code",{pre:!0},[e._v("{{...}}")])]),t("blockquote",[t("p",[e._v("Represents environment variable value")])])])]),t("p",[e._v("Let's examine each token.")]),t("h3",[e._v("The "),t("strong",[e._v("at")]),e._v("/ token")]),t("p",[e._v("Given the "),t("code",{pre:!0},[e._v("/path/to/app")]),e._v(" application absolute path, here are the parsed values for given entries:")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-yaml"}},[t("span",{pre:!0,attrs:{class:"hljs-bullet"}},[e._v("-")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'foo/bar'")]),e._v("    "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v('# "foo/bar"')]),e._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-bullet"}},[e._v("-")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'@foo/bar'")]),e._v("   "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v('# "@foo/bar"')]),e._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-bullet"}},[e._v("-")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'@/foo/bar'")]),e._v("  "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v('# "/path/to/app/foo/bar"')]),e._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-bullet"}},[e._v("-")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'/foo/@/bar'")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v('# "/foo/@/bar"')]),e._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-bullet"}},[e._v("-")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'@/'")]),e._v("         "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v('# "/path/to/app/"')]),e._v("\n")])]),t("p",[e._v("The only way it may be parsed is if the string starts by "),t("code",{pre:!0},[e._v('"@/"')])]),t("h3",[e._v("The ~/ token")]),t("p",[e._v("Given the "),t("code",{pre:!0},[e._v("/Users/name")]),e._v(" root path, here are the parsed values for given entries:")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-yaml"}},[t("span",{pre:!0,attrs:{class:"hljs-bullet"}},[e._v("-")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'foo/bar'")]),e._v("    "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v('# "foo/bar"')]),e._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-bullet"}},[e._v("-")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'~foo/bar'")]),e._v("   "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v('# "@foo/bar"')]),e._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-bullet"}},[e._v("-")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'~/foo/bar'")]),e._v("  "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v('# "/Users/name/foo/bar"')]),e._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-bullet"}},[e._v("-")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'/foo/@/bar'")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v('# "/foo/@/bar"')]),e._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-bullet"}},[e._v("-")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'~/'")]),e._v("         "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v('# "/Users/name/"')]),e._v("\n")])]),t("p",[e._v("The only way it may be parsed is if the string starts by "),t("code",{pre:!0},[e._v('"~/"')])]),t("h3",[e._v("The {{}} token")]),t("p",[e._v("This token requires the environment repository, which will be explored afterward.")]),t("p",[e._v("Given the "),t("code",{pre:!0},[e._v('APP_NAME="Node IoC')]),e._v(" environment variable, here are the parsed values for given entries:")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-yaml"}},[t("span",{pre:!0,attrs:{class:"hljs-bullet"}},[e._v("-")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'"),t("span",{pre:!0,attrs:{class:"hljs-template-variable"}},[e._v("{{APP_NAME}}")]),e._v("'")]),e._v("                "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v('# "Node IoC"')]),e._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-bullet"}},[e._v("-")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'"),t("span",{pre:!0,attrs:{class:"hljs-template-variable"}},[e._v("{{}}")]),e._v("'")]),e._v("                        "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v('# "{{}}"')]),e._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-bullet"}},[e._v("-")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'"),t("span",{pre:!0,attrs:{class:"hljs-template-variable"}},[e._v("{{...}}")]),e._v("'")]),e._v("                     "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v('# "{{...}}"')]),e._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-bullet"}},[e._v("-")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'"),t("span",{pre:!0,attrs:{class:"hljs-template-variable"}},[e._v("{{APP_NAME}}")]),e._v("'")]),e._v("                "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v('# "Node IoC"')]),e._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-bullet"}},[e._v("-")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'"),t("span",{pre:!0,attrs:{class:"hljs-template-variable"}},[e._v("{{APP_NAME|My Application}}")]),e._v("'")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v('# "Node IoC"')]),e._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-bullet"}},[e._v("-")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'"),t("span",{pre:!0,attrs:{class:"hljs-template-variable"}},[e._v("{{UNKNOWN}}")]),e._v("'")]),e._v("                 "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("# null")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-bullet"}},[e._v("-")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'"),t("span",{pre:!0,attrs:{class:"hljs-template-variable"}},[e._v("{{UNKNOWN|Default value}}")]),e._v("'")]),e._v("   "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v('# "Default value"')]),e._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-bullet"}},[e._v("-")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'"),t("span",{pre:!0,attrs:{class:"hljs-template-variable"}},[e._v("{{UNKNOWN|}}")]),e._v("'")]),e._v("                "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("# null")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-bullet"}},[e._v("-")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'"),t("span",{pre:!0,attrs:{class:"hljs-template-variable"}},[e._v("{{UNKNOWN|Default|Value}}")]),e._v("'")]),e._v("   "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v('# "Default|Value"')]),e._v("\n")])]),t("p",[e._v("If the double braces contain alphanumeric or underscore characters ("),t("code",{pre:!0},[e._v("w+")]),e._v("), it will be parsed as an environment variable.\nIf the environment variable is followed by a pipe, the following value, from the first character after the pipe until the closing braces, is parsed as the fallback value.")]),t("h2",[e._v("The env repository")]),t("p",[e._v("The environment repository is the reference for your application when it seeks environment variable values.\nInstead of using "),t("code",{pre:!0},[e._v("process.env")]),e._v(", we can rely on an injectable repository that can be easily mocked for testing purposes.")]),t("p",[e._v("The environment repository is used by the "),t("code",{pre:!0},[e._v("config.grammar")]),e._v(" service to evaluate environment tokens.")]),t("p",[e._v("The environment repository can be used the same way as the configuration repository to get a single value.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("const")]),e._v(" environmentRepository = app.make("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'env'")]),e._v(");\n\nenvironmentRepository.get("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'APP_ENV'")]),e._v(");                  "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v('// "production"')]),e._v("\nenvironmentRepository.get("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'APP_ENV'")]),e._v(", "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'local'")]),e._v(");         "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v('// "production"')]),e._v("\nenvironmentRepository.get("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'UNKNOWN'")]),e._v(");                  "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("// null")]),e._v("\nenvironmentRepository.get("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'UNKNOWN'")]),e._v(", "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'Default value'")]),e._v("); "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v('// "Default value"')]),e._v("\n\nenvironmentRepository.all();                 "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v('// { APP_ENV: "production", ... }')]),e._v("\nenvironmentRepository.all() === process.env; "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("// false")]),e._v("\n\nenvironmentRepository.has("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'APP_ENV'")]),e._v("); "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("// true")]),e._v("\nenvironmentRepository.has("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'UNKNOWN'")]),e._v("); "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("// false ")]),e._v("\n")])]),t("p",[e._v("It can also be used to load environment files.\nBy default, it loads the "),t("code",{pre:!0},[e._v(".env")]),e._v(" file at the application root.\nYou can load another file if you need to.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("const")]),e._v(" environmentRepository = app.make("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'env'")]),e._v(");\n\nenvironmentRepository.setFromFile("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'/path/to/.env.staging'")]),e._v(");\nenvironmentRepository.get("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'APP_ENV'")]),e._v("); "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v('// "staging"')]),e._v("\n")])]),t("h2",[e._v("The evaluator service")]),t("p",[e._v("Finally, the evaluator service is used to parse data that are normally decoded as a string by "),t("code",{pre:!0},[e._v("dot-env")]),e._v(" and "),t("code",{pre:!0},[e._v("js-yaml")]),e._v(".")]),t("p",[e._v("It will evaluate a single primitive value and returns its evaluated value.\nHowever, it does not rely on "),t("code",{pre:!0},[e._v("eval()")]),e._v(", which could lead to injection or unexpected behavior.")]),t("p",[e._v("Here is the evaluation schema:")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("const")]),e._v(" evaluator = app.make("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'evaluator'")]),e._v(");\n\nevaluator.evaluate("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'null'")]),e._v(");         "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("// null")]),e._v("\nevaluator.evaluate("),t("span",{pre:!0,attrs:{class:"hljs-literal"}},[e._v("null")]),e._v(");           "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("// null")]),e._v("\nevaluator.evaluate("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'NULL'")]),e._v(");         "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v('// "NULL"')]),e._v("\nevaluator.evaluate("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'undefined'")]),e._v(");    "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("// null")]),e._v("\nevaluator.evaluate();               "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("// null")]),e._v("\nevaluator.evaluate("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'true'")]),e._v(");         "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("// true")]),e._v("\nevaluator.evaluate("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'1.23'")]),e._v(");         "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("// 1.23")]),e._v("\nevaluator.evaluate("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'some string'")]),e._v(");  "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v('// "some string"')]),e._v("\nevaluator.evaluate({ "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("foo")]),e._v(": "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'bar'")]),e._v(" }); "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v('// { foo: "bar" }')]),e._v("\n")])]),t("p",[e._v("It treats all "),t("code",{pre:!0},[e._v("null")]),e._v(" and "),t("code",{pre:!0},[e._v("undefined")]),e._v(" values as "),t("code",{pre:!0},[e._v("null")]),e._v(", but consider that the values "),t("code",{pre:!0},[e._v('"null"')]),e._v(" and "),t("code",{pre:!0},[e._v('"undefined"')]),e._v(" are also "),t("code",{pre:!0},[e._v("null")]),e._v(".")]),t("p",[e._v("Booleans ("),t("code",{pre:!0},[e._v("true")]),e._v(", "),t("code",{pre:!0},[e._v("false")]),e._v(", "),t("code",{pre:!0},[e._v('"true"')]),e._v(" and "),t("code",{pre:!0},[e._v('"false"')]),e._v(") are converts to real booleans, either "),t("code",{pre:!0},[e._v("true")]),e._v(" or "),t("code",{pre:!0},[e._v("false")]),e._v(".")]),t("p",[e._v("A "),t("code",{pre:!0},[e._v("NaN")]),e._v(" or "),t("code",{pre:!0},[e._v('"NaN"')]),e._v(" value results in "),t("code",{pre:!0},[e._v("NaN")]),e._v(".")]),t("p",[e._v("A parsable number is parsed as a floating number.\nAn integer value, such as "),t("code",{pre:!0},[e._v("1")]),e._v(", "),t("code",{pre:!0},[e._v('"2"')]),e._v(" or "),t("code",{pre:!0},[e._v('"-1"')]),e._v(", and a floating value, such as "),t("code",{pre:!0},[e._v("1.23")]),e._v(", "),t("code",{pre:!0},[e._v('"4.56"')]),e._v(" and "),t("code",{pre:!0},[e._v('"-7.89"')]),e._v(", are treated as floating number and are parsed through "),t("code",{pre:!0},[e._v("parseFloat()")]),e._v(".\nNote that the decimal separator must be a point, not a comma.")]),t("p",[e._v("This service will be used by the "),t("code",{pre:!0},[e._v("env")]),e._v(" repository directly and by the "),t("code",{pre:!0},[e._v("config")]),e._v(" repository through the "),t("code",{pre:!0},[e._v("config.grammar")]),e._v(" service when accessing a value.")])])}],n=t("2877"),o={},l=Object(n["a"])(o,a,r,!1,null,null,null);s["default"]=l.exports},"56d7":function(e,s,t){"use strict";t.r(s);var a=t("2b0e"),r=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("main-layout",[t("router-view")],1)},n=[],o=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",[t("off-canvas",{attrs:{name:"main-menu"},scopedSlots:e._u([{key:"offcanvas",fn:function(){return[t("div",{staticClass:"card"},[t("div",{staticClass:"card-section"},[t("h1",{staticClass:"h2 separator-center margin-vertical-1",domProps:{textContent:e._s(e.siteName)}})])]),t("sections-menu")]},proxy:!0}])},[t("top-bar"),t("main",{staticClass:"main"},[e._t("default")],2),t("small-footer")],1)],1)},l=[],p=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",[t("div",{ref:"offCanvas",staticClass:"off-canvas position-left",attrs:{id:"offcanvas-"+this.name}},[e._t("offcanvas")],2),t("div",{staticClass:"off-canvas-content",attrs:{"data-off-canvas-content":""}},[e._t("default")],2)])},v=[],i=t("1157"),c=t.n(i),_=t("e14e"),h={props:{name:String},data:function(){return{$offCanvas:null}},mounted:function(){this.$offCanvas=new _["a"].OffCanvas(c()(this.$refs.offCanvas),{transition:"overlap",contentScroll:!1})},watch:{$route:function(){this.$offCanvas&&this.$offCanvas.close()}}},d=h,u=t("2877"),m=Object(u["a"])(d,p,v,!1,null,null,null),g=m.exports,j=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("nav",[e._l(e.menus,function(s,a){return[s.children.length>0?t("div",{key:a,staticClass:"card"},[t("div",{staticClass:"card-divider"},[t("h2",{staticClass:"h6",domProps:{textContent:e._s(e.getMenuLabel(s.name))}})]),t("div",{staticClass:"card-section"},[t("ul",{staticClass:"vertical menu no-bullet"},e._l(s.children,function(a){var r=a.name;return t("li",{key:r},[t("router-link",{attrs:{to:e.buildLinkFromMenu(s,r)},domProps:{textContent:e._s(e.getMenuLabel(r))}})],1)}),0)])]):e._e()]})],2)},f=[],y=[{name:"getting-started",children:[{name:"installation",children:[]},{name:"directory-structure",children:[]}]},{name:"architecture",children:[{name:"lifecycle",children:[]},{name:"container",children:[]},{name:"service-provider",children:[]}]},{name:"first-steps",children:[{name:"create-a-command",children:[]},{name:"create-a-web-page",children:[]},{name:"create-an-api-endpoint",children:[]},{name:"create-a-service",children:[]}]},{name:"basics",children:[{name:"configuration",children:[]},{name:"commands",children:[]},{name:"routing",children:[]},{name:"views",children:[]}]},{name:"data",children:[{name:"database",children:[]},{name:"models",children:[]},{name:"factories",children:[]},{name:"migrations-and-seeders",children:[]},{name:"http-client",children:[]},{name:"cache",children:[]}]},{name:"going-deeper",children:[{name:"exception-handling",children:[]},{name:"drivers",children:[]},{name:"events",children:[]},{name:"file-system",children:[]},{name:"helpers",children:[]},{name:"log",children:[]},{name:"multiple-inheritances",children:[]},{name:"security",children:[]},{name:"translation",children:[]},{name:"validation",children:[]}]},{name:"tests",children:[{name:"test-commands",children:[]},{name:"test-class",children:[]}]}],w={computed:{locale:function(){return this.$route.params.locale},fallbackLocale:function(){return this.$i18n.fallbackLocale},locales:function(){var e=this,s={};return this.$i18n.availableLocales.filter(function(s){return s!==e.locale}).forEach(function(t){s[t]=e.getCurrentPathAlias(t)}),s},currentPathPattern:function(){var e=this;return this.$route.path.replace(this.$route.matched[this.$route.matched.length-1].regex,function(s){var t={};Object.keys(e.$route.params).forEach(function(s){t[e.$route.params[s]]=s});for(var a=arguments.length,r=new Array(a>1?a-1:0),n=1;n<a;n++)r[n-1]=arguments[n];return r.reduce(function(e,s){return"pathMatch"===t[s]?e:"locale"===t[s]?e.replace(new RegExp("^/[^/]+/".concat(s,"(/.*)?$")),"$1"):e.replace(new RegExp("/".concat(s,"(/.*)?$")),"/:".concat(t[s],"$1"))},s)})},currentOriginalPathPattern:function(){var e=this.currentPathPattern,s="path.alias.".concat(e);return this.$te(s)?this.$t(s):e},currentLocalizedPath:function(){return this.getCurrentPathAlias()}},methods:{getCurrentPathAlias:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.locale,s=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return this.getPathAlias(this.currentOriginalPathPattern,e,s)},getPathAlias:function(e){var s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.locale,t=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],a="path.original.".concat(e),r=this.formatPathFromCurrent(this.$te(a,s)?this.$t(a,s):e,s);return t?r:this.removeLocaleFromPath(r)},formatPathFromCurrent:function(e){var s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,t=this.$route.params,a=Object.keys(t).reduce(function(e,s){return e.replace(new RegExp(":".concat(s),"gu"),t[s])},e);return s?this.formatLocalePath(s,a):a},formatLocalePath:function(e,s){return"".concat(this.$router.resolve({name:"home",params:{locale:e}}).href).concat(s)},removeLocaleFromPath:function(e){return this.$i18n.availableLocales.reduce(function(e,s){return e.replace(new RegExp("^/".concat(s)),"")},e)}}},b=t("4a27"),k=t.n(b),T={methods:{getMenuLabel:function(e){var s="menu.".concat(e);return this.$te(s)?this.$t(s):isNaN(e)?k.a.sentence(e):e}}},x={mixins:[w,T],computed:{menus:function(){return y}},methods:{buildLinkFromMenu:function(e){var s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return this.getPathAlias("/".concat(e.name,"/").concat(s||e.children[0].name))}}},C=x,I=(t("8cf7"),Object(u["a"])(C,j,f,!1,null,"3b7314e8",null)),S=I.exports,A=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("footer",[t("license"),e._v(" "),t("copyrights"),t("span",{staticClass:"made"},[e._v("\n        "+e._s(e.$t("Made with"))+" "),t("span",{staticClass:"catch-phrase",domProps:{textContent:e._s(e.catchPhrase)}}),e._v(" "+e._s(e.$t("by"))+"\n        "),t("a",{attrs:{href:e.$t("app.author.link"),rel:"external",target:"_blank"}},[t("author-logo"),e._v("\n            "+e._s(e.$t("app.author.name"))+"\n        ")],1)])],1)},P=[],q=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("span",[e._v("© "+e._s(e.date))])},N=[],E={computed:{date:function(){var e=new Date,s=this.$te("app.date.since")?this.$t("app.date.since"):e.getFullYear(),t=this.$te("app.date.to")?this.$t("app.date.to"):e.getFullYear();return"".concat(s).concat(s.toString()===t.toString()||parseInt(s)>=parseInt(t)?"":"-".concat(t))}}},H=E,L=Object(u["a"])(H,q,N,!1,null,null,null),R=L.exports,M=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("a",{attrs:{href:e.$t("license.link"),target:"_blank"},domProps:{textContent:e._s(e.$t("license.type"))}})},F=[],B={},D=Object(u["a"])(B,M,F,!1,null,null,null),O=D.exports,$={data:function(){return{catchPhrase:""}},components:{License:O,Copyrights:R},mounted:function(){this.updateCatchPhrase()},watch:{"$route.params.locale":function(){this.updateCatchPhrase()}},methods:{updateCatchPhrase:function(){var e=this.$i18n.locale,s=this.$i18n.messages[e]||{},t=s.catchPhrases,a=void 0===t?{}:t,r=Object.values(a);this.catchPhrase=r[Math.floor(Math.random()*r.length)]}}},U=$,W=(t("47d0"),Object(u["a"])(U,A,P,!1,null,"d9383f7a",null)),Y=W.exports,z=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{ref:"topBar",staticClass:"top-bar"},[t("div",{staticClass:"top-bar-wrapper grid-container"},[t("div",{staticClass:"top-bar-left"},[t("logo")],1),t("div",{staticClass:"top-bar-right"},[t("ul",{staticClass:"menu secondary no-bullet"},[e.$te("app.repository")?t("li",[t("a",{staticClass:"github-link",attrs:{href:e.$t("app.repository"),target:"_blank"}},[t("span",{staticClass:"github-text",domProps:{textContent:e._s(e.$t("View on GitHub"))}})])]):e._e(),t("li",[t("language-switcher",{attrs:{options:{alignment:"right"}}})],1),e._m(0)])])])])},J=[function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("li",{staticClass:"hide-for-large offcanvas-toggle-wrapper"},[t("button",{staticClass:"offcanvas-toggle",attrs:{type:"button","data-open":"offcanvas-main-menu"}})])}],G=function(){var e=this,s=e.$createElement,t=e._self._c||s;return e.hasMultipleLocales?t("dropdown",{attrs:{size:"tiny",options:e.options},scopedSlots:e._u([{key:"label",fn:function(){return[e._v(e._s(e.upper(e.locale)))]},proxy:!0}],null,!1,2113421949)},[t("ul",{staticClass:"vertical menu no-bullet"},e._l(e.locales,function(s,a){return t("li",{key:a},[t("router-link",{attrs:{to:s},domProps:{textContent:e._s(e.upper(a))}})],1)}),0)]):e._e()},V=[],K=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("span",[t("button",{staticClass:"button is-dropdown-submenu-parent",attrs:{"data-toggle":e.id,type:"button"}},[e._t("label")],2),t("div",{ref:"dropdown",staticClass:"dropdown-pane",class:e.size,attrs:{id:e.id,"data-auto-focus":"true"}},[e._t("default")],2)])},Q=[],Z={data:function(){return{$dropdown:null}},computed:{id:function(){return"dropdown-".concat(this._uid)}},props:{options:{type:Object,required:!1,default:function(){return{}}},size:{type:String,required:!1,default:""}},mounted:function(){var e=Object.assign({closeOnClick:!0},this.options);this.$dropdown=new _["a"].Dropdown(c()(this.$refs.dropdown),e)}},X=Z,ee=Object(u["a"])(X,K,Q,!1,null,null,null),se=ee.exports,te={mixins:[w],components:{Dropdown:se},props:{options:{type:Object,required:!1,default:function(){return{}}}},computed:{hasMultipleLocales:function(){return Object.keys(this.locales).length>0}},methods:{upper:function(e){return e.toUpperCase()}}},ae=te,re=Object(u["a"])(ae,G,V,!1,null,null,null),ne=re.exports,oe=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("router-link",{staticClass:"logo",attrs:{to:e.homePage}},[t("logo",{attrs:{alt:e.siteName}})],1)},le=[],pe={computed:{homePage:function(){return{name:"home",params:{locale:this.$route.params.locale}}},siteName:function(){return this.$t("app.name")}}},ve=pe,ie=Object(u["a"])(ve,oe,le,!1,null,null,null),ce=ie.exports,_e={components:{LanguageSwitcher:ne,Logo:ce},data:function(){return{$sticky:null}},computed:{siteName:function(){return this.$t("app.name")}},mounted:function(){this.$sticky=new _["a"].Sticky(c()(this.$refs.topBar),{stickyOn:"small",marginTop:0})}},he=_e,de=(t("f1be"),t("2191"),Object(u["a"])(he,z,J,!1,null,"6fe8e3d0",null)),ue=de.exports,me={components:{OffCanvas:g,SectionsMenu:S,SmallFooter:Y,TopBar:ue},computed:{siteName:function(){return this.$t("app.name")}}},ge=me,je=(t("700d"),Object(u["a"])(ge,o,l,!1,null,null,null)),fe=je.exports,ye={components:{MainLayout:fe}},we=ye,be=Object(u["a"])(we,r,n,!1,null,null,null),ke=be.exports,Te=t("a925"),xe=function(e){return new a["a"]({render:function(s){return s(e)}}).$mount().$el.outerHTML},Ce={en:{content:{getting_started__installation:xe(t("4ddb").default),getting_started__directory_structure:xe(t("2233").default),architecture__lifecycle:xe(t("3480").default),architecture__container:xe(t("8dbe").default),architecture__service_provider:xe(t("43d5").default),first_steps__create_a_command:xe(t("9407").default),first_steps__create_a_web_page:xe(t("2b03").default),first_steps__create_an_api_endpoint:xe(t("d74c").default),first_steps__create_a_service:xe(t("1a3e").default),basics__configuration:xe(t("556a").default),basics__commands:xe(t("27a9").default),basics__routing:xe(t("effd").default),basics__views:xe(t("a967").default),data__database:xe(t("666f").default),data__models:xe(t("879b").default),data__factories:xe(t("907f").default),data__migrations_and_seeders:xe(t("86c3").default),data__http_client:xe(t("dc90").default),data__cache:xe(t("a100").default),going_deeper__exception_handling:xe(t("cdef").default),going_deeper__drivers:xe(t("2a32").default),going_deeper__events:xe(t("604c").default),going_deeper__file_system:xe(t("6718").default),going_deeper__helpers:xe(t("bece").default),going_deeper__log:xe(t("1c95").default),going_deeper__multiple_inheritances:xe(t("d13c").default),going_deeper__security:xe(t("1ade").default),going_deeper__translation:xe(t("eb8a").default),going_deeper__validation:xe(t("14ac").default),tests__test_commands:xe(t("c9b9").default),tests__test_class:xe(t("083a").default)}}},Ie=t("26d5");a["a"].use(Te["a"]);var Se={en:Ie},Ae=new Te["a"]({locale:"en",fallbackLocale:"en",messages:Object.assign({},Ce)});Object.keys(Se).forEach(function(e){var s=Se[e].path||{};delete Se[e].path,Ae.mergeLocaleMessage(e,Se[e]);var t={};Object.keys(s).forEach(function(e){t[s[e]]=e}),Ae.mergeLocaleMessage(e,{path:{original:s,alias:t}})});var Pe=Ae,qe=t("8c4f"),Ne=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("home")},Ee=[],He=(t("77fb"),{}),Le=Object(u["a"])(He,Ne,Ee,!1,null,"90186d28",null),Re=Le.exports,Me=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{staticClass:"grid-container margin-top-2"},[t("div",{staticClass:"grid-x grid-margin-x"},[t("div",{staticClass:"large-3 cell show-for-large"},[t("sections-menu")],1),t("div",{staticClass:"large-9 cell"},[t("breadcrumbs"),t("doc-content")],1)])])},Fe=[],Be=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("nav",{attrs:{"aria-label":e.$t("You are here")+":",role:"navigation"}},[t("ul",{staticClass:"breadcrumbs no-bullet"},[e.breadcrumbs.length>0?t("li",[t("router-link",{attrs:{to:e.home},domProps:{textContent:e._s(e.$t("Home"))}})],1):e._e(),e._l(e.breadcrumbs,function(s,a){return t("li",{key:s.url,class:{disabled:!s.url}},[a!==e.breadcrumbs.length-1&&s.url?t("router-link",{attrs:{to:s.url},domProps:{textContent:e._s(s.label)}}):a!==e.breadcrumbs.length-1?t("span",{domProps:{textContent:e._s(s.label)}}):t("span",[t("span",{staticClass:"show-for-sr"},[e._v("Current: ")]),e._v(" "+e._s(s.label)+"\n            ")])],1)})],2)])},De=[],Oe={mixins:[T],computed:{home:function(){return{name:"home",params:{locale:this.$route.params.locale}}},breadcrumbs:function(){var e=this,s=this.$route,t=s.path,a=s.params.locale,r=t.replace(new RegExp("^(?:/)?[^/]*".concat(a,"(?<slash>/)?"),"u"),"$<slash>"),n=r.split("/").filter(Boolean);return n.map(function(s,a){var o=t.replace("".concat(r),n.slice(0,a+1).reduce(function(e,s){return"".concat(e,"/").concat(s)},"")),l=e.getMenuLabel(s),p=e.$i18n.locale;return new RegExp("\\/".concat(p,"(?:\\/[\\w-]+)?\\/?$"),"u").test(o)?{label:l}:{url:o,label:l}}).filter(function(s,t,a){return!a.slice(0,t-1).some(function(e){var t=e.url;return t===s.url})&&!e.$i18n.availableLocales.includes(s.label.toLowerCase())})}}},$e=Oe,Ue=Object(u["a"])($e,Be,De,!1,null,null,null),We=Ue.exports,Ye=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",[e.content?t("div",{staticClass:"doc-content-wrapper"},[t("h1",{staticClass:"doc-title",domProps:{textContent:e._s(e.title)}}),t("hr"),e.menu&&e.menu.length>0?t("nav",[t("doc-page-menu",{attrs:{menu:e.menu}}),t("hr")],1):e._e(),t("div",{staticClass:"doc-content",domProps:{innerHTML:e._s(e.content)}})]):t("div",{staticClass:"not-found",domProps:{textContent:e._s(e.$t("error.404"))}})])},ze=[],Je=t("d825"),Ge=t.n(Je),Ve="h1,h2,h3,h4,h5,h6",Ke={mixins:[w,T],mounted:function(){this.updateTitle()},watch:{title:function(){this.updateTitle()}},computed:{content:function(){var e=this.contentKey,s=this.$te(e)?this.$t(e):null;if(!s)return s;var t=c()(s);t.find("h1").remove();var a=[];return t.find(Ve).each(function(){var e=c()(this),s=k.a.slug(Ge()(e.text())),t=s,r=1;while(a.indexOf(t)>-1)t="".concat(s,"-").concat(r++);a.push(t),e.attr("id",t)}),t.wrap("<div>").parent().html()},contentKey:function(){return"content.".concat(this.getCurrentPathAlias(this.fallbackLocale,!1).slice(1).replace(/\//g,"__").replace(/[\x2D\.]/g,"_").replace(new RegExp("^.*__".concat(this.fallbackLocale,"__")),""))},title:function(){return this.getMenuLabel(this.getCurrentPathAlias().split("/").reverse()[0])},menu:function(){var e=this.content;if(!e)return null;var s=[];return c()(e).find(Ve).each(function(){for(var e=c()(this),t=parseInt(this.tagName.charAt(1))-1,a=s,r=1;r<t;r++)a=a[a.length-1].children;a.push({label:e.text(),anchor:k.a.slug(Ge()(e.text())),children:[]})}),s}},methods:{updateTitle:function(){var e=document.head.querySelector("title"),s=e.innerText.split("|"),t=s[s.length-1];e.innerText="".concat(this.title," | ").concat(t)}}},Qe=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("ul",{staticClass:"vertical menu no-bullet"},e._l(e.menu,function(s,a){return t("li",{key:a+"-"+s.anchor},[t("a",{attrs:{href:"#"+s.anchor},domProps:{textContent:e._s(s.label)}}),s.children&&s.children.length>0?t("doc-page-menu",{staticClass:"nested",attrs:{menu:s.children}}):e._e()],1)}),0)},Ze=[],Xe={name:"doc-page-menu",props:{menu:{type:Array,required:!1,default:function(){return[]}}}},es=Xe,ss=(t("2833"),Object(u["a"])(es,Qe,Ze,!1,null,"6c49e61a",null)),ts=ss.exports,as={mixins:[Ke],components:{DocPageMenu:ts}},rs=as,ns=(t("fc92"),t("cecb"),Object(u["a"])(rs,Ye,ze,!1,null,"3234e164",null)),os=ns.exports,ls={components:{Breadcrumbs:We,SectionsMenu:S,DocContent:os}},ps=ls,vs=Object(u["a"])(ps,Me,Fe,!1,null,null,null),is=vs.exports,cs=t("64f6"),_s=t.n(cs),hs=[{path:"".concat(_s.a,":locale"),name:"home",component:Re},{path:"".concat(_s.a,":locale/*"),name:"page",component:is}],ds=function(e,s,t){var a=e.path.replace(/\/$/,"");Boolean(a)&&a!==e.path?t(a):t()},us=function(e,s,t){e.params.locale?(Pe.locale=e.params.locale,t()):t({name:"home",params:{locale:Pe.fallbackLocale}})},ms=[ds,us];a["a"].use(qe["a"]);var gs=new qe["a"]({mode:"history",routes:hs,scrollBehavior:function(e,s,t){return t||{x:0,y:0}}});ms.forEach(function(e){return gs.beforeEach(e)});var js=gs;a["a"].config.productionTip=!1;var fs=function(e){return e(ke)},ys=new a["a"]({i18n:Pe,router:js,render:fs}),ws=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{staticClass:"home-content"},[t("div",{staticClass:"section jumbotron"},[t("div",{staticClass:"jumbotron-image",staticStyle:{"background-image":"url('https://images.unsplash.com/photo-1478088702756-f16754aaf0c4?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=1650&q=80')"}}),t("sparks"),t("div",{staticClass:"grid-container jumbotron-content"},[t("div",{staticClass:"grid-x"},[t("div",{staticClass:"cell medium-10 large-8"},[t("p",{staticClass:"h2 jumbotron-text"},[e._v(e._s(e.$t("A complete Node.js ecosystem with an elegant syntax to drive sparkling ideas")))]),t("router-link",{staticClass:"button",attrs:{to:e.docLink},domProps:{textContent:e._s(e.$t("Get started!"))}})],1)])])],1),t("section",{staticClass:"section about"},[t("div",{staticClass:"grid-container"},[t("div",{staticClass:"grid-x"},[e._m(0),t("div",{staticClass:"cell medium-4 medium-offset-1"},[t("div",{staticClass:"card shadow padding-1 first-steps"},[e._m(1),t("div",{staticClass:"card-section"},[t("router-link",{staticClass:"button",attrs:{to:e.createACommandLink}},[e._v("Take your first step")])],1)])])])])]),t("section",{staticClass:"section features"},[t("div",{staticClass:"grid-container"},[t("div",{staticClass:"grid-x"},[t("div",{staticClass:"cell large-6"},[t("ul",{staticClass:"margin-bottom-0"},[t("li",[e._v("Simple, yet powerful, "),t("router-link",{attrs:{to:e.containerLink}},[e._v("dependency injection container")])],1),t("li",[e._v("Complete "),t("router-link",{attrs:{to:e.commandLink}},[e._v("CLI command system")]),e._v(" powered by "),t("a",{attrs:{href:"http://yargs.js.org",target:"_blank"}},[e._v("Yargs")])],1),t("li",[e._v("Full "),t("router-link",{attrs:{to:e.routingLink}},[e._v("routing and HTTP handling")]),e._v(" powered by "),t("a",{attrs:{href:"https://expressjs.com",target:"_blank"}},[e._v("Express")])],1),t("li",[t("a",{attrs:{href:"http://knexjs.org",target:"_blank"}},[e._v("Knex.js")]),e._v(" "),t("router-link",{attrs:{to:e.databaseLink}},[e._v("database connections")]),e._v(" with "),t("a",{attrs:{href:"https://bookshelfjs.org",target:"_blank"}},[e._v("Bookshelf ORM")])],1),t("li",[t("router-link",{attrs:{to:e.cacheLink}},[e._v("Cache")]),e._v(" system with multiple back-ends")],1)])]),t("div",{staticClass:"cell large-6"},[t("ul",{staticClass:"margin-bottom-0"},[t("li",[t("router-link",{attrs:{to:e.configLink}},[e._v("Configuration")]),e._v(" over code approach")],1),e._m(2),t("li",[t("router-link",{attrs:{to:e.serviceProviderLink}},[e._v("Modular")]),e._v(" structure with simple integration")],1),t("li",[e._v("Complete and powerful "),t("a",{attrs:{href:"https://jestjs.io/",target:"_blank"}},[e._v("Jest")]),e._v(" integration for testing with a "),t("router-link",{attrs:{to:e.testClassLink}},[e._v("class-based")]),e._v(" approach, like "),t("a",{attrs:{href:"https://phpunit.de",target:"_blank"}},[e._v("PHPUnit (PHP)")]),e._v(" or "),t("a",{attrs:{href:"https://nunit.org",target:"_blank"}},[e._v("NUnit (C#)")])],1)])])])])]),e._m(3),t("section",{staticClass:"section packages"},[t("div",{staticClass:"grid-container"},[t("p",{staticClass:"lead"},[e._v("Out-of-the-box package implementations:")]),t("div",{staticClass:"grid-x"},e._l(e.packageGroups,function(s,a){return t("div",{key:a,staticClass:"cell medium-3"},[t("ul",{staticClass:"margin-bottom-0"},e._l(s,function(s){return t("li",{key:s},[t("a",{attrs:{href:"https://npmjs.com/package/"+s,target:"_blank"},domProps:{textContent:e._s(s)}})])}),0)])}),0)])]),t("section",{staticClass:"section"},[t("div",{staticClass:"grid-container"},[t("p",{staticClass:"lead"},[e._v("Want to make a difference?")]),t("div",{staticClass:"grid-x"},[e._m(4),e._m(5),e._m(6),e._m(7),t("div",{staticClass:"cell medium-4"},[e._m(8),t("p",[e._v("to "),t("router-link",{attrs:{to:e.serviceProviderLink}},[e._v("extend")]),e._v(" the framework")],1)]),e._m(9)])])])])},bs=[function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{staticClass:"cell medium-7"},[t("p",[e._v("Node IoC is a "),t("a",{attrs:{href:"https://nodejs.org",target:"_blank"}},[e._v("Node.js")]),e._v(" framework designed to help developers create elegant and well-designed applications, for both the Web and the CLI.")]),t("p",[e._v("Easy to use for beginners, but strong enough for advanced JavaScript engineers, it was built with the developers in mind to make their life easier when it comes to building simple to complex application architecture, with a scalable, modular approach.")]),t("p",[e._v("Based on "),t("em",[t("a",{attrs:{href:"(https://en.wikipedia.org/wiki/SOLID"}},[e._v("SOLID")])]),e._v(" principles, it comes out with a lot of features that remove the pain of crafting new applications:")])])},function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{staticClass:"card-section"},[t("p",{staticClass:"separator-left"},[e._v("Our simple step-by-step tutorial will show you how to craft your first application the proper way in minutes, so you can start building something amazing today!")])])},function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("li",[e._v("Multiple 3rd-party integrations such as "),t("a",{attrs:{href:"https://github.com/mroderick/PubSubJS",target:"_blank"}},[e._v("PubSubJS")]),e._v(", "),t("a",{attrs:{href:"https://hapi.dev/family/joi",target:"_blank"}},[e._v("joi")]),e._v(", "),t("a",{attrs:{href:"https://www.jsviews.com",target:"_blank"}},[e._v("JsRender")]),e._v(" and much more")])},function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("section",{staticClass:"section inspirations"},[t("div",{staticClass:"grid-container"},[t("div",{staticClass:"grid-x"},[t("div",{staticClass:"cell medium-10 medium-offset-1 large-8 large-offset-2 text-center"},[t("p",[e._v("Node IoC was mostly inspired by "),t("a",{attrs:{href:"https://laravel.com",target:"_blank"}},[e._v("Laravel")]),e._v(" and "),t("a",{attrs:{href:"https://symfony.com",target:"_blank"}},[e._v("Symfony")]),e._v(" for the structure, as well by "),t("a",{attrs:{href:"https://angularjs.org",target:"_blank"}},[e._v("Angular.js")]),e._v(" for the dependency injection approach.")]),t("p",[e._v("The key that makes Node IoC a better platform to start with is that it is based on all the best things that have been made in JavaScript so far: it unifies the most popular tools and makes implementing them under a complex application feel like a breeze.")])])])])])},function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{staticClass:"cell medium-4"},[t("p",{staticClass:"margin-bottom-0"},[t("strong",[e._v("Send us some feedback")])]),t("p",[e._v("at "),t("a",{attrs:{href:"mailto:opensource@absolunet.com"}},[e._v("opensource@absolunet.com")])])])},function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{staticClass:"cell medium-4"},[t("p",{staticClass:"margin-bottom-0"},[t("strong",[e._v("Propose a feature")])]),t("p",[e._v("on "),t("a",{attrs:{href:"https://github.com/absolunet/node-ioc/issues/new?assignees=&labels=enhancement&template=feature_request.md&title=%5BFEATURE%5D",target:"_blank"}},[e._v("GitHub")])])])},function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{staticClass:"cell medium-4"},[t("p",{staticClass:"margin-bottom-0"},[t("strong",[e._v("Open an issue")])]),t("p",[e._v("on "),t("a",{attrs:{href:"https://github.com/absolunet/node-ioc/issues/new/choose",target:"_blank"}},[e._v("GitHub")])])])},function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{staticClass:"cell medium-4"},[t("p",{staticClass:"margin-bottom-0"},[t("strong",[e._v("Create a pull request")])]),t("p",[e._v("on "),t("a",{attrs:{href:"https://github.com/absolunet/node-ioc/pulls",target:"_blank"}},[e._v("GitHub")])])])},function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("p",{staticClass:"margin-bottom-0"},[t("strong",[e._v("Create a package")])])},function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{staticClass:"cell medium-4"},[t("p",{staticClass:"margin-bottom-0"},[t("strong",[e._v("...become one of us!")])]),t("p",[t("a",{attrs:{href:"https://absolunet.com/en/careers/",target:"_blank"}},[e._v("Join Absolunet for your dream job")])])])}],ks=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("canvas",{ref:"canvas",staticClass:"sparks-canvas"})},Ts=[];function xs(e){return Ss(e)||Is(e)||Cs()}function Cs(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function Is(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function Ss(e){if(Array.isArray(e)){for(var s=0,t=new Array(e.length);s<e.length;s++)t[s]=e[s];return t}}function As(e,s){if(!(e instanceof s))throw new TypeError("Cannot call a class as a function")}function Ps(e,s){for(var t=0;t<s.length;t++){var a=s[t];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function qs(e,s,t){return s&&Ps(e.prototype,s),t&&Ps(e,t),e}var Ns=function(){function e(s){As(this,e),this.context=s,this.x=this.generateRandomInteger(0,s.width),this.y=this.generateRandomInteger(0,s.height),this.color=this.generateColor(),this.direction=this.generateRandomDirection(),this.speed=this.generateRandomSpeed(),this.size=this.generateRandomSize()}return qs(e,[{key:"move",value:function(){this.direction+=.1*Math.random()-.05,this.x+=Math.cos(this.direction)*this.speed,this.y+=Math.sin(this.direction)*this.speed,this.x<-this.size?this.x=this.context.width+this.size:this.x>this.context.width+this.size&&(this.x=-this.size),this.y<-this.size?this.y=this.context.height+this.size:this.y>this.context.height+this.size&&(this.y=-this.size)}},{key:"generateRandomInteger",value:function(e,s){return Math.floor(Math.random()*(s-e))+e}},{key:"generateColor",value:function(){var e=this.generateRandomInteger(150,255),s=this.generateRandomInteger(50,e),t=this.generateRandomInteger(0,Math.min(e,s)),a=this.generateRandomAlpha();return{r:e,g:s,b:t,a:a}}},{key:"generateRandomAlpha",value:function(){return.5*Math.random()+.2}},{key:"generateRandomDirection",value:function(){return Math.random()*Math.PI/2-Math.PI/4*3}},{key:"generateRandomSpeed",value:function(){return 3*Math.random()}},{key:"generateRandomSize",value:function(){return this.generateRandomInteger(3,10)}},{key:"css",get:function(){var e=this.color,s=e.r,t=e.g,a=e.b,r=e.a;return"rgba(".concat(s,", ").concat(t,", ").concat(a,", ").concat(r,")")}}]),e}(),Es={mounted:function(){var e=this.$refs.canvas,s=e.getContext("2d"),t=[],a=function(){var t=e.parentNode,a=t.offsetWidth,r=t.offsetHeight;e.width=a,e.height=r,s.filter="blur(2px)"},r=function(){s.clearRect(0,0,e.width,e.height)},n=function e(){r(),t.forEach(function(e){e.move(),s.beginPath(),s.fillStyle=e.css,s.arc(e.x,e.y,e.size,0,2*Math.PI,!0),s.closePath(),s.fill()}),window.requestAnimationFrame(e)};a(),r(),t.push.apply(t,xs(xs(new Array(10).keys()).map(function(){return new Ns(e)}))),window.requestAnimationFrame(n),window.addEventListener("resize",a)}},Hs=Es,Ls=(t("a199"),Object(u["a"])(Hs,ks,Ts,!1,null,"e9dc56d2",null)),Rs=Ls.exports,Ms={components:{Sparks:Rs},beforeCreate:function(){document.body.classList.add("home-page")},beforeDestroy:function(){document.body.classList.remove("home-page")},data:function(){return{packages:["@absolunet/fsp","@absolunet/fss","@absolunet/private-registry","@absolunet/terminal","@hapi/joi","axios","bookshelf","dotenv","express","faker","inquirer","jsrender","knex","moment","nodemon","ouch","pretty-error","pubsub-js","yargs"]}},computed:{docLink:function(){return this.getLink("/getting-started/installation")},containerLink:function(){return this.getLink("/architecture/container")},commandLink:function(){return this.getLink("/basics/commands")},routingLink:function(){return this.getLink("/basics/routing")},databaseLink:function(){return this.getLink("/data/database")},cacheLink:function(){return this.getLink("/data/cache")},configLink:function(){return this.getLink("/basics/configuration")},serviceProviderLink:function(){return this.getLink("/architecture/service-provider")},testClassLink:function(){return this.getLink("/tests/test-class")},createACommandLink:function(){return this.getLink("/first-steps/create-a-command")},packageGroups:function(){return this.packages.reduce(function(e,s,t,a){var r=Math.floor(t/a.length*4);return e[r]=e[r]||[],e[r].push(s),e},[])}},methods:{getLink:function(e){return"".concat(this.$route.path).concat(this.$t("path.original.".concat(e)))}}},Fs=Ms,Bs=(t("40d5"),Object(u["a"])(Fs,ws,bs,!1,null,"6202f982",null)),Ds=Bs.exports,Os=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("span",{staticClass:"author-logo"})},$s=[],Us=(t("1cba"),{}),Ws=Object(u["a"])(Us,Os,$s,!1,null,"0087add2",null),Ys=Ws.exports,zs=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("svg",{staticClass:"logo",attrs:{viewBox:"0 0 183.2 72.102",xmlns:"http://www.w3.org/2000/svg"}},[t("g",{attrs:{id:"svgGroup","stroke-linecap":"round","fill-rule":"evenodd",fill:"#ff5252"}},[t("path",{attrs:{d:"M 0 0.701 L 17.1 0.701 L 17.1 71.401 L 0 71.401 L 0 0.701 Z",id:"0","vector-effect":"non-scaling-stroke"}}),t("path",{attrs:{d:"M 63.727 15.978 A 34.175 34.175 0 0 0 55 14.901 A 37.45 37.45 0 0 0 51.45 15.066 A 30.484 30.484 0 0 0 40.1 18.351 Q 33.5 21.801 29.75 28.301 A 27.002 27.002 0 0 0 26.88 35.589 A 34.111 34.111 0 0 0 26 43.501 A 36.07 36.07 0 0 0 26.366 48.724 A 27.818 27.818 0 0 0 29.75 58.701 Q 33.5 65.201 40.1 68.651 A 29.26 29.26 0 0 0 46.2 71.01 A 34.326 34.326 0 0 0 55 72.101 Q 63.3 72.101 69.85 68.651 Q 76.4 65.201 80.15 58.701 A 27.002 27.002 0 0 0 83.02 51.413 A 34.111 34.111 0 0 0 83.9 43.501 A 36.07 36.07 0 0 0 83.534 38.279 A 27.818 27.818 0 0 0 80.15 28.301 Q 76.4 21.801 69.85 18.351 A 28.846 28.846 0 0 0 63.727 15.978 Z M 55 29.701 A 10.866 10.866 0 0 0 47.014 32.979 A 13.133 13.133 0 0 0 46.75 33.251 A 11.419 11.419 0 0 0 44.186 37.75 Q 43.646 39.473 43.477 41.545 A 24.098 24.098 0 0 0 43.4 43.501 A 21.48 21.48 0 0 0 43.727 47.376 Q 44.447 51.295 46.75 53.701 A 10.937 10.937 0 0 0 54.695 57.198 A 13.52 13.52 0 0 0 55 57.201 A 11.24 11.24 0 0 0 59.818 56.184 A 11.09 11.09 0 0 0 63.2 53.701 Q 65.971 50.762 66.415 45.565 A 24.266 24.266 0 0 0 66.5 43.501 A 21.763 21.763 0 0 0 66.161 39.532 Q 65.443 35.664 63.2 33.251 A 10.693 10.693 0 0 0 55.456 29.709 A 13.225 13.225 0 0 0 55 29.701 Z",id:"1","vector-effect":"non-scaling-stroke"}}),t("path",{attrs:{d:"M 158.9 26.301 L 140.8 26.301 A 17.132 17.132 0 0 0 137.144 20.666 A 16.306 16.306 0 0 0 134.65 18.601 Q 130.5 15.801 124.8 15.801 A 16.546 16.546 0 0 0 118.793 16.854 A 14.853 14.853 0 0 0 112.7 21.301 A 18.896 18.896 0 0 0 108.926 28.867 Q 108.207 31.685 108.114 35.007 A 35.611 35.611 0 0 0 108.1 36.001 A 29.816 29.816 0 0 0 108.681 42.068 Q 109.735 47.138 112.7 50.651 A 14.86 14.86 0 0 0 123.532 56.061 A 19.664 19.664 0 0 0 124.8 56.101 A 19.459 19.459 0 0 0 129.949 55.447 A 15.788 15.788 0 0 0 134.65 53.301 Q 138.8 50.501 140.8 45.701 L 158.9 45.701 A 35.36 35.36 0 0 1 154.557 56.787 A 31.418 31.418 0 0 1 147.45 64.851 A 31.619 31.619 0 0 1 133.083 71.303 A 43.745 43.745 0 0 1 125.1 72.001 Q 114.8 72.001 107 67.451 Q 99.2 62.901 94.95 54.701 A 37.854 37.854 0 0 1 91.036 41.726 A 47.512 47.512 0 0 1 90.7 36.001 A 44.326 44.326 0 0 1 91.899 25.494 A 36.472 36.472 0 0 1 94.95 17.301 Q 99.2 9.101 107 4.551 A 33.268 33.268 0 0 1 119.504 0.361 A 42.316 42.316 0 0 1 125.1 0.001 A 42.236 42.236 0 0 1 135.301 1.173 A 31.145 31.145 0 0 1 147.45 7.101 A 31.845 31.845 0 0 1 158.231 23.624 A 40.791 40.791 0 0 1 158.9 26.301 Z",id:"2","vector-effect":"non-scaling-stroke"}}),t("path",{attrs:{d:"M 165.5 54.301 L 183.2 54.301 L 183.2 71.401 L 165.5 71.401 L 165.5 54.301 Z",id:"3","vector-effect":"non-scaling-stroke"}})])])},Js=[],Gs=(t("bd84"),{}),Vs=Object(u["a"])(Gs,zs,Js,!1,null,"3b17fe27",null),Ks=Vs.exports;a["a"].component("home",Ds),a["a"].component("logo",Ks),a["a"].component("author-logo",Ys),ys.$mount("#app")},"604c":function(e,s,t){"use strict";t.r(s);var a=function(){var e=this,s=e.$createElement;e._self._c;return e._m(0)},r=[function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("section",[t("h1",[e._v("Events")]),t("h2",[e._v("Introduction")]),t("p",[e._v("Events are part of a lot of JavaScript packages and frameworks.\nIn Node.js, the "),t("code",{pre:!0},[e._v("EventEmitter")]),e._v(" from the "),t("code",{pre:!0},[e._v("events")]),e._v(" core package can be used to subscribe and dispatch events.\nHowever, a singleton is needed in order to work across multiple files or packages.")]),t("p",[e._v("Node IoC makes it very simple to use events in an application or in a module without having to worry about singletons or event the concrete engine under it.")]),t("h2",[e._v("The event dispatcher")]),t("p",[e._v("The "),t("code",{pre:!0},[e._v("event")]),e._v(" dispatcher can be injected anywhere in your application.\nThis is the first service to be attached to the container.\nIt implements an interface similar to the original "),t("code",{pre:!0},[e._v("EventEmitter")]),e._v(".")]),t("ul",[t("li",[t("code",{pre:!0},[e._v("on(event, listener)")])]),t("li",[t("code",{pre:!0},[e._v("off(event, listener)")])]),t("li",[t("code",{pre:!0},[e._v("once(event, listener)")])]),t("li",[t("code",{pre:!0},[e._v("emit(event, payload = {})")])]),t("li",[t("code",{pre:!0},[e._v("removeListeners(event)")])]),t("li",[t("code",{pre:!0},[e._v("removeAllListeners()")])])]),t("p",[e._v("You can choose the implementation from the "),t("code",{pre:!0},[e._v("events.default")]),e._v(" configuration key, between "),t("code",{pre:!0},[e._v("emitter")]),e._v(" to use the default "),t("code",{pre:!0},[e._v("EventEmitter")]),e._v(", or "),t("code",{pre:!0},[e._v("pubsubjs")]),e._v(" to use "),t("a",{attrs:{href:"https://github.com/mroderick/PubSubJS"}},[e._v("PubSubJS")]),e._v(".")]),t("h2",[e._v("Lifecycle events")]),t("p",[e._v("Since some packages, or even your own application, could want to bind to the lifecycle events, and the "),t("code",{pre:!0},[e._v("event")]),e._v(" dispatcher would normally not be attached yet, the application offers two methods to listen to events before the lifecycle starts:")]),t("ul",[t("li",[t("p",[t("code",{pre:!0},[e._v("app.onBooting(listener)")])]),t("blockquote",[t("p",[e._v("Will attach a listener to the "),t("code",{pre:!0},[e._v("application.booting")]),e._v(" event")])])]),t("li",[t("p",[t("code",{pre:!0},[e._v("app.onBooted(listener)")])]),t("blockquote",[t("p",[e._v("Will attach a listener to the "),t("code",{pre:!0},[e._v("application.booted")]),e._v(" event")])])])]),t("p",[e._v("Also, some hooks are available in the console kernel.\nBy default, they are declared in your application's console kernel.\nThe only implemented one in a fresh application is "),t("code",{pre:!0},[e._v("beforeHandling")]),e._v(", to load application commands.\nHere are the different hooks:")]),t("ul",[t("li",[t("code",{pre:!0},[e._v("beforeHandling")])]),t("li",[t("code",{pre:!0},[e._v("afterHandling")])]),t("li",[t("code",{pre:!0},[e._v("terminating")])])])])}],n=t("2877"),o={},l=Object(n["a"])(o,a,r,!1,null,null,null);s["default"]=l.exports},"64f6":function(e,s){e.exports="/docs-node-ioc/"},"666f":function(e,s,t){"use strict";t.r(s);var a=function(){var e=this,s=e.$createElement;e._self._c;return e._m(0)},r=[function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("section",[t("h1",[e._v("Database")]),t("h2",[e._v("Introduction")]),t("p",[e._v("Node IoC offers an elegant wrapper over "),t("a",{attrs:{href:"http://knexjs.org/"}},[e._v("Knex.js")]),e._v(" to create database connections.\nIt currently supports configurable and dynamic connections for both single-database website or multi-tenant application with many databases.\nBy default, Node IoC supports "),t("code",{pre:!0},[e._v("SQLite")]),e._v(" connections, but additional connector drivers can be developed to enable Knex.js supported database engines.")]),t("h2",[e._v("Configuration")]),t("p",[e._v("To quickly set up a database connection, the "),t("code",{pre:!0},[e._v("database.yaml")]),e._v(" configuration file is already prepared to enable basic environment-driven database connections.")]),t("p",[e._v("First, you can enable or disable the database commands from the "),t("code",{pre:!0},[e._v("enabled")]),e._v(" configurable flag.\nHowever, setting it to "),t("code",{pre:!0},[e._v("false")]),e._v(" does not mean that all the database features are disabled.\nThey are only disabled from the CLI.\nTo help you properly use the commands, you can change the commands namespace.\nBy default, "),t("code",{pre:!0},[e._v("db")]),e._v(" will be used, to create "),t("code",{pre:!0},[e._v("db:migrate")]),e._v(", "),t("code",{pre:!0},[e._v("db:seed")]),e._v(" and so on.")]),t("p",[e._v("The "),t("code",{pre:!0},[e._v("default")]),e._v(" key represents the default database connection name to use when making a connection.")]),t("p",[e._v("By default, the "),t("code",{pre:!0},[e._v("sqlite")]),e._v(" and the "),t("code",{pre:!0},[e._v("mysql")]),e._v(" connection names are defined, which use the driver of the same name underneath.")]),t("p",[e._v("The key difference between the name and the driver is that the name is the unique identifier of the configured connection, while the driver is the engine used to establish a database connection with the proper SQL grammar.\nYou could create an "),t("code",{pre:!0},[e._v("etl")]),e._v(" database connection with the "),t("code",{pre:!0},[e._v("sqlite")]),e._v(" driver for integration processes, for instance.\nIt is yours to create the connections that suit you.")]),t("p",[e._v("To help Knex.js and Node IoC find your different database-related JavaScript files, the "),t("code",{pre:!0},[e._v("paths")]),e._v(" key maps the "),t("code",{pre:!0},[e._v("factories")]),e._v(", "),t("code",{pre:!0},[e._v("migrations")]),e._v(", "),t("code",{pre:!0},[e._v("models")]),e._v(" and "),t("code",{pre:!0},[e._v("seeders")]),e._v(" folders.\nEach key represents the entities, or the folder type if you will, and the value represents the relative path from the "),t("code",{pre:!0},[e._v("path.database")]),e._v(" absolute path, normally located under "),t("code",{pre:!0},[e._v("src/database")]),e._v(".\nSo, for the "),t("code",{pre:!0},[e._v("factories: some/factories")]),e._v(" mapping, we would retrieve the model factories under "),t("code",{pre:!0},[e._v("src/database/some/factories")]),e._v(".")]),t("p",[e._v("Finally, the "),t("code",{pre:!0},[e._v("migration_table")]),e._v(" will be used for all your databases when using migrations, which will be discussed in the following chapters.\nBy default, the "),t("code",{pre:!0},[e._v("migrations")]),e._v(" table name is used.")]),t("h2",[e._v("Connection builder")]),t("p",[e._v("The easiest way to establish a Knex.js connection is through the Connection builder, injectable through "),t("code",{pre:!0},[e._v("db")]),e._v(".\nYou can instantiate your default connection the easy way.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("const")]),e._v(" connection = app.make("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'db'")]),e._v(").getConnection(); "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("// Knex {}")]),e._v("\n")])]),t("p",[e._v("You can also create a connection by configuration name.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("const")]),e._v(" sqliteConnection = app.make("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'db'")]),e._v(").getConnection("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'sqlite'")]),e._v(");\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("const")]),e._v(" mySqlConnection  = app.make("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'db'")]),e._v(").getConnection("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'mysql'")]),e._v(");\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("const")]),e._v(" etlConnection    = app.make("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'db'")]),e._v(").getConnection("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'etl'")]),e._v(");\n")])]),t("p",[e._v("Thanks to JavaScript proxies, you can directly use Knex.js connection methods on the connection builder.\nIt will get the default instance and forward the call to it under the hood.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("const")]),e._v(" users = "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("await")]),e._v(" app.make("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'db'")]),e._v(").select().table("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'users'")]),e._v(");\n")])]),t("h2",[e._v("Connector")]),t("p",[e._v("If you need to create a dynamic connection without using the configuration, the "),t("code",{pre:!0},[e._v("db.connection")]),e._v(" service helps you create a Knex.js instance.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("const")]),e._v(" connection = app.make("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'db.connection'")]),e._v(")\n    .driver("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'sqlite'")]),e._v(")\n    .getOrCreateConnection("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'custom_name'")]),e._v(", {\n        "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("filename")]),e._v(": "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'/path/to/my/database.sqlite'")]),e._v("\n    }); "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("// Knex {}")]),e._v("\n\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("const")]),e._v(" otherConnection = app.make("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'db.connection'")]),e._v(")\n    .driver("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'sqlite'")]),e._v(")\n    .getOrCreateConnection("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'custom_name'")]),e._v(", {\n        "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("filename")]),e._v(": "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'/path/to/other/database.sqlite'")]),e._v("\n    }); "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("// Knex {}")]),e._v("\n\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("const")]),e._v(" etlConnection = app.make("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'db.connection'")]),e._v(")\n    .driver("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'sqlite'")]),e._v(")\n    .getOrCreateConnection("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'custom_etl'")]),e._v(", {\n        "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("filename")]),e._v(": "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'/path/to/my/etl.sqlite'")]),e._v("\n    });\n\n"),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("// The other connection uses the first given connection since the call retrieved an existing connection by name.")]),e._v("\nconnection === otherConnection; "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("// true")]),e._v("\n\nconnection === etlConnection; "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("// false")]),e._v("\n")])]),t("p",[e._v("The connector has all the available drivers registered in it.\nYou can then establish dedicated connections through the appropriate driver and then get a database connection.\nThe configuration for the dedicated drivers can be retrieved in the "),t("a",{attrs:{href:"http://knexjs.org/#Installation-client"}},[e._v("official Knex.js documentation")]),e._v(".\nThe configuration object sent in the connection creation methods uses the same schema as the Knex "),t("code",{pre:!0},[e._v("connection")]),e._v(" configuration model.")])])}],n=t("2877"),o={},l=Object(n["a"])(o,a,r,!1,null,null,null);s["default"]=l.exports},6718:function(e,s,t){"use strict";t.r(s);var a=function(){var e=this,s=e.$createElement;e._self._c;return e._m(0)},r=[function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("section",[t("h1",[e._v("File system")]),t("h2",[e._v("Introduction")]),t("p",[e._v("In Node IoC, the file system is way more than the default "),t("code",{pre:!0},[e._v("fs")]),e._v(" module.\nIt mainly relies on two packages, "),t("code",{pre:!0},[e._v("@absolunet/fsp")]),e._v(" and "),t("code",{pre:!0},[e._v("@absolunet/fss")]),e._v(", which offers the same methods, one in sync mode and the other in async, promise-based mode.")]),t("h2",[e._v("The file manager")]),t("p",[e._v("The file manager is a service that interacts with the file system with some intelligence when it comes to content.\nIt offers "),t("code",{pre:!0},[e._v("load")]),e._v(", "),t("code",{pre:!0},[e._v("loadAsync")]),e._v(", "),t("code",{pre:!0},[e._v("write")]),e._v(" and "),t("code",{pre:!0},[e._v("writeAsync")]),e._v(" methods that will handle the file type and decode it the simplest way possible.")]),t("p",[e._v("For instance, a "),t("code",{pre:!0},[e._v(".js")]),e._v(" file will be parsed, executed, and the exported data will be returned.\nHowever, when writing "),t("code",{pre:!0},[e._v(".js")]),e._v(" file, plain text is used.\n"),t("code",{pre:!0},[e._v(".json")]),e._v(", "),t("code",{pre:!0},[e._v(".yaml")]),e._v(" and "),t("code",{pre:!0},[e._v(".yml")]),e._v(" files return parsed objects when read and can write from JSON serializable data, such as an array or an object.")]),t("p",[e._v("Other helper methods are also exposed, such as "),t("code",{pre:!0},[e._v("scandir")]),e._v(" and "),t("code",{pre:!0},[e._v("exists")]),e._v(", but it helps a lot when attempting to load files with some logic.")]),t("p",[e._v("For instance, "),t("code",{pre:!0},[e._v("findFirst")]),e._v(" inspect the file system for the wanted files.\nWhen a file exists, the path is returned, without going any further.\n"),t("code",{pre:!0},[e._v("loadFirst")]),e._v(" and "),t("code",{pre:!0},[e._v("loadFirstAsync")]),e._v(" do the exact same thing, except that the file is parsed by the proper driver, and the value is returned.")]),t("p",[e._v("Also, you can load the content of all the files in a given folder with "),t("code",{pre:!0},[e._v("loadInFolder")]),e._v(".")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("const")]),e._v(" fileManager = app.make("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'file'")]),e._v(");\n\nfileManager.loadInFolder("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'/path/to/folder'")]),e._v(");\n"),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("/*\n{\n    'file': 'Parsed content', // /path/to/folder/file.txt\n    'other': { key: 'value' } // /path/to/folder/other.yaml\n}\n*/")]),e._v("\n")])]),t("p",[e._v("The "),t("code",{pre:!0},[e._v("loadRecursivelyInFolder")]),e._v(" does the exact same thing, but recursively for files in subfolders.")]),t("h2",[e._v("The file engine")]),t("p",[e._v("Basically, the "),t("code",{pre:!0},[e._v("file.engine")]),e._v(" service is just a decorator over "),t("code",{pre:!0},[e._v("file.system.sync")]),e._v(".\nIt also exposes "),t("code",{pre:!0},[e._v("async")]),e._v(" and "),t("code",{pre:!0},[e._v("sync")]),e._v(" properties that are reflecting the two file systems.")]),t("h2",[e._v("The async file system")]),t("p",[e._v("The async file system can be directly injected through "),t("code",{pre:!0},[e._v("file.system.async")]),e._v(".\nThis instance exposes all the "),t("code",{pre:!0},[e._v("@absolunet/fsp")]),e._v(" methods, plus some other utilities, which all of them are promise-based.\nYou can, therefore, use ES2017 "),t("code",{pre:!0},[e._v("async/await")]),e._v(".\nThe methods and their parameters are exactly the same as the ones provided in the sync file system.")]),t("h2",[e._v("The sync file system")]),t("p",[e._v("The sync file system can be directly injected through "),t("code",{pre:!0},[e._v("file.system.sync")]),e._v(".\nThis instance exposes all the "),t("code",{pre:!0},[e._v("@absolunet/fss")]),e._v(" methods, plus some other utilities, which all of them are synchronous.\nThe methods and their parameters are exactly the same as the ones provided in the async file system.")])])}],n=t("2877"),o={},l=Object(n["a"])(o,a,r,!1,null,null,null);s["default"]=l.exports},"700d":function(e,s,t){"use strict";var a=t("2ba7"),r=t.n(a);r.a},7438:function(e,s,t){},"77fb":function(e,s,t){"use strict";var a=t("d703"),r=t.n(a);r.a},"86c3":function(e,s,t){"use strict";t.r(s);var a=function(){var e=this,s=e.$createElement;e._self._c;return e._m(0)},r=[function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("section",[t("h1",[e._v("Migrations and seeders")]),t("h2",[e._v("Introduction")]),t("p",[e._v("Migrations are mostly used to build your database schema in an incremental, "),t("em",[e._v("agile")]),e._v(" approach.\nIt allows you to build the schema of your database one table, one column at the time, and ensure that it can evolve when you are adding new features that require your schema to change.")]),t("p",[e._v("Seeders, on the other hand, are used to feed your database with data, mostly fake data from factories, for developing purposes.\nIt helps you quickly create a prototype with hundreds or thousands of table entries with a single command.\nIt also allows you to test the impact of a large database without being in production yet.")]),t("h2",[e._v("Migrations")]),t("h3",[e._v("The make:migration command")]),t("p",[e._v("To create a migration class file, you can use the following command.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-bash"}},[e._v("node ioc make:migration CreateUsersTable\n")])]),t("p",[e._v("This will create the "),t("code",{pre:!0},[e._v("12345678901234_CreateUsersTable.js")]),e._v(" file, under the "),t("code",{pre:!0},[e._v("src/database/migrations")]),e._v(" folder.\nThe prefix is the date it was created, to prevent running migrations that were created later to run before mode recent migrations.")]),t("p",[e._v("This will create a file that contains two methods: "),t("code",{pre:!0},[e._v("up")]),e._v(" and "),t("code",{pre:!0},[e._v("down")]),e._v(".\nThe "),t("code",{pre:!0},[e._v("up")]),e._v(" method is used when running the migration, while the "),t("code",{pre:!0},[e._v("down")]),e._v(" method will be used when rollbacking.")]),t("p",[e._v("If your migration class name starts with both "),t("code",{pre:!0},[e._v("Create")]),e._v(", "),t("code",{pre:!0},[e._v("Drop")]),e._v(" or "),t("code",{pre:!0},[e._v("Delete")]),e._v(", there will be a default scaffold, so you can quickly craft your table schema.")]),t("p",[e._v("To implement the migration, you can use the "),t("code",{pre:!0},[e._v("this.connection.schema")]),e._v(" Knex.js schema instance and either create a table with "),t("code",{pre:!0},[e._v("createTable()")]),e._v(", alter it with "),t("code",{pre:!0},[e._v("table()")]),e._v(" or drop it with "),t("code",{pre:!0},[e._v("dropTableIfNotExists()")]),e._v(".\nFor further explanation and API documentation, you can read the "),t("a",{attrs:{href:"http://knexjs.org/#Schema"}},[e._v("official Knex.js documentation")]),e._v(".")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-class"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("class")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("CreateUsersTable")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("extends")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("Migration")]),e._v(" ")]),e._v("{\n\n    "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("async")]),e._v(" up() {\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("await")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".connection.schema.createTable("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'users'")]),e._v(", (table) => {\n            table.uuid("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'id'")]),e._v(").primary();\n            "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("// Other columns you would like")]),e._v("\n            table.timestamps();\n        });\n    }\n\n    "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("async")]),e._v(" down() {\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("await")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".connection.schema.dropTableIfExists("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'users'")]),e._v(");\n    }\n\n}\n")])]),t("h3",[e._v("The db:migrate command")]),t("p",[e._v("To run your latest migrations, the "),t("code",{pre:!0},[e._v("db:migrate")]),e._v(" command will run, from the least to the most recent class, based on their names (a simple "),t("code",{pre:!0},[e._v("sort()")]),e._v(" is done under the hood), the "),t("code",{pre:!0},[e._v("up")]),e._v(" method.\nHowever, the database keeps track of all the migrations that were already run, so the same migration will never be run twice.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":""}},[e._v("node ioc db:migrate\n\n  Migrating latest migrations\n\n ✔  Migrated: 12345678901234_CreateUsersTable.js\n\n\nnode ioc db:migrate\n\n  Migrating latest migrations\n\n  Already up to date\n")])]),t("h3",[e._v("The db:migrate:rollback command")]),t("p",[e._v("You can, instead of running up the migration, running them down, to rollback their actions.\nThis command, unlike the "),t("code",{pre:!0},[e._v("db:migrate")]),e._v(" that uses the "),t("code",{pre:!0},[e._v("up")]),e._v(" method, uses the "),t("code",{pre:!0},[e._v("down")]),e._v(" method on all migrations that were already run.\nIt will start with the last ran migration to the first one.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":""}},[e._v("node ioc db:migrate\n\n  Migrating latest migrations\n\n  ✔  Migrated: 12345678901234_CreateUsersTable.js\n\n\nnode ioc db:migrate:rollback\n\n  Migration #1 rollback successful!\n\n  ✔  Rolled back: 12345678901234_CreateUsersTable.js\n\n\nnode ioc db:migrate:rollback\n\n  Rolling back last migration batch\n\n  No migration rollback to run\n")])]),t("h3",[e._v("The db:migrate:refresh command")]),t("p",[e._v("If you need to restart all over your database schema, the "),t("code",{pre:!0},[e._v("db:migrate:refresh")]),e._v(" will start by rollbacking all ran migrations, like "),t("code",{pre:!0},[e._v("db:migrate:rollback")]),e._v(" does, until no migration rollbacks can be run.\nThen, all available migrations will run up, like "),t("code",{pre:!0},[e._v("db:migrate")]),e._v(" does.")]),t("h3",[e._v("The db:migrate:fresh command")]),t("p",[e._v("This command simply flushes the entire database to run all migrations afterward.\nThis is very useful when working in a local environment to restore the database to the most recent state without having to worry about rollback issues.")]),t("h3",[e._v("The db:migrate:status command")]),t("p",[e._v("This command helps you get a quick overview of the migrations that were run, and those which are pending to run.\nIt simply prints a table with all the migrations and their status.")]),t("h2",[e._v("Seeders")]),t("p",[e._v("When the migrations are run, you have a database schema ready to be used for insertion.\nTo quickly insert fake data in your database, the "),t("code",{pre:!0},[e._v("src/database/seeds/DatabaseSeeder.js")]),e._v(" class may come in help.\nThis class will be run with the "),t("code",{pre:!0},[e._v("db:seed")]),e._v(" command, and this class can, and should, run other seeders.")]),t("p",[e._v("A seeder only has the "),t("code",{pre:!0},[e._v("seed")]),e._v(" method, unlike the migrations with "),t("code",{pre:!0},[e._v("up")]),e._v(" and "),t("code",{pre:!0},[e._v("down")]),e._v(".\nWhen running a seeder, insertion of fake records in the database can be done.")]),t("h3",[e._v("The make:seeder command")]),t("p",[e._v("To create a seeder, the "),t("code",{pre:!0},[e._v("make:seeder")]),e._v(" command will create a small scaffold to quickly implement a table seeder.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-bash"}},[e._v("node ioc make:seeder UsersTableSeeder\n")])]),t("p",[e._v("In a seeder, you have access to the model factories and the models, with the "),t("code",{pre:!0},[e._v("factory")]),e._v(" and the "),t("code",{pre:!0},[e._v("model")]),e._v(" methods.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-class"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("class")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("UsersTableSeeder")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("extends")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("Seeder")]),e._v(" ")]),e._v("{\n\n    "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("async")]),e._v(" seed() {\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("await")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".factory("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'user'")]),e._v(", "),t("span",{pre:!0,attrs:{class:"hljs-number"}},[e._v("100")]),e._v(").save(); "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("// Generate 100 User {} in a Collection {}, then save it in the database")]),e._v("\n    }\n\n}\n")])]),t("p",[e._v("To call a seeder, go in your "),t("code",{pre:!0},[e._v("DatabaseSeeder")]),e._v(" class and implement the "),t("code",{pre:!0},[e._v("seed")]),e._v(" method by calling the "),t("code",{pre:!0},[e._v("run")]),e._v(" method, which will run other seeders by either name or class instance.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-class"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("class")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("DatabaseSeeder")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("extends")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("Seeder")]),e._v(" ")]),e._v("{\n\n    "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("async")]),e._v(" seed() {\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("await")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".run([\n            "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'UsersTableSeeder'")]),e._v("\n        ]);\n    }\n\n}\n")])]),t("h3",[e._v("The db:seed command")]),t("p",[e._v("To run your database seeder, simply run the "),t("code",{pre:!0},[e._v("db:seed")]),e._v(" command.\nIt will, by default, run the "),t("code",{pre:!0},[e._v("DatabaseSeeder.js")]),e._v(" file and ignore all the others.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":""}},[e._v("node ioc db:seed\n\n  Seeding database\n\n  Seed successful!\n\n  ✔  Seeded: DatabaseSeeder.js\n")])]),t("p",[e._v("Since you have used the "),t("code",{pre:!0},[e._v("run")]),e._v(" method, with the "),t("code",{pre:!0},[e._v('"UsersTableSeeder"')]),e._v(", your custom seeder was run as well.")]),t("p",[e._v("You can, however, manually run a single seeder file, with the "),t("code",{pre:!0},[e._v("--file")]),e._v(" option.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":""}},[e._v("node ioc db:seed --file=UsersTableSeeder\n\n  Seeding database\n\n  Seed successful!\n\n  ✔  Seeded: UsersTableSeeder.js\n")])])])}],n=t("2877"),o={},l=Object(n["a"])(o,a,r,!1,null,null,null);s["default"]=l.exports},"879b":function(e,s,t){"use strict";t.r(s);var a=function(){var e=this,s=e.$createElement;e._self._c;return e._m(0)},r=[function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("section",[t("h1",[e._v("Models")]),t("h2",[e._v("Introduction")]),t("p",[e._v("The database models may be very useful for simple relations, creation and manipulation of database entities.\nAlong with "),t("a",{attrs:{href:"http://knexjs.org"}},[e._v("Knex.js")]),e._v(", Node IoC offers an implementation of "),t("a",{attrs:{href:"https://bookshelfjs.org"}},[e._v("Bookshelf.js")]),e._v(" ORM with class-based models.\nThe real models that will drive the queries will be the Bookshelf models, but the Node IoC model acts as a decorator that can evolve very easily and can inherit from other classes and mixins.")]),t("p",[e._v("All the models are by default in the "),t("code",{pre:!0},[e._v("src/database/models")]),e._v(" folder.")]),t("h2",[e._v("Auto-registration")]),t("p",[e._v("By default, the "),t("code",{pre:!0},[e._v("db.model")]),e._v(" repository loads the whole models' folder and automatically register them.\nThe name is used to retrieve the model unique name, in "),t("code",{pre:!0},[e._v("camelCase")]),e._v(".\nSo, the "),t("code",{pre:!0},[e._v("User")]),e._v(" model will be called "),t("code",{pre:!0},[e._v('"user"')]),e._v(".")]),t("h2",[e._v("The make:model command")]),t("p",[e._v("To create a model class file, the "),t("code",{pre:!0},[e._v("make:model")]),e._v(" generator command is very useful.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-bash"}},[e._v("node ioc make:model User\n")])]),t("p",[e._v("This example would create the "),t("code",{pre:!0},[e._v("src/database/models/User.js")]),e._v(" model file.")]),t("p",[e._v("Since the model is normally your key source for database query, the command offers multiple scaffolding at once with additional flags.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-bash"}},[e._v("node ioc make:model User --migration\n")])]),t("p",[e._v("The "),t("code",{pre:!0},[e._v("--migration")]),e._v(" flag will create the "),t("code",{pre:!0},[e._v("CreateUsersTable")]),e._v(" migration at the same time.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-bash"}},[e._v("node ioc make:model User --factory\n")])]),t("p",[e._v("The "),t("code",{pre:!0},[e._v("--factory")]),e._v(" flag will create the "),t("code",{pre:!0},[e._v("UserFactory")]),e._v(" model factory at the same time.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-bash"}},[e._v("node ioc make:model User --seeder\n")])]),t("p",[e._v("The "),t("code",{pre:!0},[e._v("--seeder")]),e._v(" flag will create the "),t("code",{pre:!0},[e._v("UsersTableSeeder")]),e._v(" seeder at the same time.")]),t("p",[e._v("If you want all these files at the same time, instead of giving all the flags, the "),t("code",{pre:!0},[e._v("--all")]),e._v(" works the same way.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-bash"}},[e._v("node ioc make:model User --all\n")])]),t("p",[e._v("This command creates these files:")]),t("ul",[t("li",[t("code",{pre:!0},[e._v("src/database/factories/UserFactory.js")])]),t("li",[t("code",{pre:!0},[e._v("src/database/migrations/CreateUsersTable.js")])]),t("li",[t("code",{pre:!0},[e._v("src/database/models/User.js")])]),t("li",[t("code",{pre:!0},[e._v("src/database/seeds/UsersTableSeeder.js")])])]),t("h2",[e._v("The Model class")]),t("p",[e._v('A normal model class will define the different attributes of a Bookshelf model, in a way that you can be more verbose and use "private" methods and attributes if you need them.\nA regular scaffold generates the model, which extends the base Node IoC '),t("code",{pre:!0},[e._v("Model")]),e._v(" class.")]),t("h3",[e._v("Default attributes")]),t("p",[e._v("To set default attributes, the "),t("code",{pre:!0},[e._v("defaults")]),e._v(" accessor can be implemented, which should return an object of column-value pairs.\nBy default, the "),t("code",{pre:!0},[e._v("defaults")]),e._v(" accessor returns an empty object.")]),t("h3",[e._v("Timestamps")]),t("p",[e._v("A regular model would normally have timestamps, with "),t("code",{pre:!0},[e._v("created_at")]),e._v(" and "),t("code",{pre:!0},[e._v("updated_at")]),e._v(" columns.\nIf for any reason, your model does not have those columns, you can set the "),t("code",{pre:!0},[e._v("timestamps")]),e._v(" accessor to "),t("code",{pre:!0},[e._v("false")]),e._v(".\nIt is set to "),t("code",{pre:!0},[e._v("true")]),e._v(" by default.")]),t("h3",[e._v("Primary key")]),t("p",[e._v("To use a specific primary key column name, you can implement the "),t("code",{pre:!0},[e._v("key")]),e._v(" accessor.\nIt is set to "),t("code",{pre:!0},[e._v('"id"')]),e._v(" by default.")]),t("h3",[e._v("Primary key type")]),t("p",[e._v("Node IoC assumes that your application needs to scale.\nIt offers "),t("code",{pre:!0},[e._v("uuid")]),e._v(" as the primary key type by default.\nIf you want another type, such as "),t("code",{pre:!0},[e._v("integer")]),e._v(", you can specify it in the "),t("code",{pre:!0},[e._v("keyType")]),e._v(" accessor.")]),t("h3",[e._v("Table name")]),t("p",[e._v("The table name is guessed by the model based on the class name.\nIt simply converts it from PascalCase to snake_case and pluralizes it, so "),t("code",{pre:!0},[e._v("CustomProduct")]),e._v(" table would be guessed as "),t("code",{pre:!0},[e._v("custom_products")]),e._v(".\nTo explicitly set it, you can implement the "),t("code",{pre:!0},[e._v("tableName")]),e._v(" accessor.")]),t("h3",[e._v("Relations")]),t("p",[e._v("Relations are a huge part of any SQL architecture.\nNode IoC offers a verbose way to define relations.\nBookshelf normally accepts functions like "),t("code",{pre:!0},[e._v("roles()")]),e._v(", "),t("code",{pre:!0},[e._v("categories()")]),e._v(" and so on, directly in the definition object.")]),t("p",[e._v("The model automatically takes the methods that end with "),t("code",{pre:!0},[e._v("Relation")]),e._v(" as relation definition.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-class"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("class")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("User")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("extends")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("Model")]),e._v(" ")]),e._v("{\n\n    accountRelation(model) {\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" model.hasOne("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'account'")]),e._v(");\n    }\n\n    rolesRelation(model) {\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" model.belongsToMany("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'role'")]),e._v(");\n    }\n\n}\n")])]),t("p",[e._v("All those methods will be used to define relations, so they can be eager-loaded when fetching data.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("const")]),e._v(" User = app.make("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'db.model'")]),e._v(").get("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'user'")]),e._v(");\n\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("const")]),e._v(" { "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("models")]),e._v(": [user] } = "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("await")]),e._v(" User.fetchAll();\nuser.relations.roles; "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("// Collection {}")]),e._v("\n")])]),t("h3",[e._v("Initialize model")]),t("p",[e._v("You can take action when the model is initialized by Bookshelf by implementing the "),t("code",{pre:!0},[e._v("boot")]),e._v(" method.\nIt is empty by default.")])])}],n=t("2877"),o={},l=Object(n["a"])(o,a,r,!1,null,null,null);s["default"]=l.exports},"8cf7":function(e,s,t){"use strict";var a=t("5172"),r=t.n(a);r.a},"8dbe":function(e,s,t){"use strict";t.r(s);var a=function(){var e=this,s=e.$createElement;e._self._c;return e._m(0)},r=[function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("section",[t("h1",[e._v("Container")]),t("h2",[e._v("Introduction")]),t("p",[e._v("In any IoC application, the Container is the central point of action when it comes to dependency resolving.\nIts role is to store the different bindings, to resolve those bindings, to manage the dependency injection process, etc.\nNode IoC makes no exception about this and offers all the basic features a container should provide.")]),t("p",[e._v("The container is, in fact, the base class of the application.\nYou can directly use the container features through the application.")]),t("h2",[e._v("Bindings and singletons")]),t("p",[e._v("First, the container offers two main methods to bind elements: the "),t("code",{pre:!0},[e._v("bind")]),e._v(" and the "),t("code",{pre:!0},[e._v("singleton")]),e._v(" methods.")]),t("p",[e._v("When using "),t("code",{pre:!0},[e._v("bind")]),e._v(", we associate an abstract (a string) to a concrete (a class, a factory, an instance, a primitive type value, etc.).\nIf a value was already bound with the same abstract, it is overwritten at this moment.\nWhen making the abstract, the concrete is resolved.\nThe resolving algorithm is described below.")]),t("p",[e._v("When using "),t("code",{pre:!0},[e._v("singleton")]),e._v(", the same thing happens.\nThe key difference is that when making the instance, the first made instance will be stored as a singleton and returned each time the container is asked to make this abstract instead of making the instance every time.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-class"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("class")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("SomeServiceProvider")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("extends")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("ServiceProvider")]),e._v(" ")]),e._v("{\n\n    register() {\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".app.bind("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'foo'")]),e._v(", "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'Foo'")]),e._v("); "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("// The 'foo' abstract will result in 'Foo' as the concrete.")]),e._v("\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".app.bind("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'bar'")]),e._v(", { "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("key")]),e._v(": "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'value'")]),e._v(" }); "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("// The 'bar' abstract will result in the object as the concrete.")]),e._v("\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".app.bind("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'baz'")]),e._v(", () => { "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("// The 'baz' abstract will result in a newly created object each time it will be made.")]),e._v("\n            "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" { "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("key")]),e._v(": "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'value'")]),e._v(" };\n        });\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".app.bind("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'qux'")]),e._v(", QuxService); "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("// The 'qux' abstract will result in a QuxService instance.")]),e._v("\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".app.singleton("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'once'")]),e._v(", SomeService); "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("// The 'once' abstract will result in a SOmeService instance, but if made twice, the same instance will be returned both time.")]),e._v("\n    }\n\n    boot() {\n        "),t("span",{pre:!0,attrs:{class:"hljs-built_in"}},[e._v("console")]),e._v(".log("),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".app.make("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'bar'")]),e._v(") === "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".app.make("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'bar'")]),e._v(")); "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("// true, since the concrete is an object.")]),e._v("\n        "),t("span",{pre:!0,attrs:{class:"hljs-built_in"}},[e._v("console")]),e._v(".log("),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".app.make("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'baz'")]),e._v(") === "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".app.make("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'baz'")]),e._v(")); "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("// false, the closure is called twice to create two distinct objects that serialize to the same string.")]),e._v("\n        "),t("span",{pre:!0,attrs:{class:"hljs-built_in"}},[e._v("console")]),e._v(".log("),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".app.make("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'qux'")]),e._v(") === "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".app.make("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'qux'")]),e._v(")); "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("// false, the class will is instantiated twice.")]),e._v("\n        "),t("span",{pre:!0,attrs:{class:"hljs-built_in"}},[e._v("console")]),e._v(".log("),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".app.make("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'qux'")]),e._v(").constructor === "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".app.make("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'qux'")]),e._v(").constructor); "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("// true, the class remains the same for all the instances.")]),e._v("\n        "),t("span",{pre:!0,attrs:{class:"hljs-built_in"}},[e._v("console")]),e._v(".log("),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".app.make("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'once'")]),e._v(") === "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".app.make("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'once'")]),e._v(")); "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("// true, 'once' is treated as a singleton and will not be instantiated twice, except if specified.")]),e._v("\n    }\n\n}\n")])]),t("h2",[e._v("Resolve abstracts")]),t("h3",[e._v("The make method")]),t("p",[e._v("When binding a concrete to an abstract, it is to be resolved by another entity through the container.")]),t("p",[e._v("The container offers a simple method to get the concrete from an abstract: "),t("code",{pre:!0},[e._v("make")]),e._v(".\nIt accepts the abstract name as an argument and will process everything for us, from the resolving to the instantiation with dependency injection.")]),t("p",[e._v("If you have bound "),t("code",{pre:!0},[e._v("{ key: 'value' }")]),e._v(" to the "),t("code",{pre:!0},[e._v("bar")]),e._v(" abstract, then "),t("code",{pre:!0},[e._v("app.make('bar')")]),e._v(" will results in "),t("code",{pre:!0},[e._v("{ key: 'value' }")]),e._v(".")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[e._v("app.make("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'some.service'")]),e._v("); "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("// SomeService {}")]),e._v("\n")])]),t("p",[e._v("You can make any bound abstract, and the container will resolve it for you.")]),t("p",[e._v("However, if you need to use all the rich container features when it comes to instantiation, you can use the "),t("code",{pre:!0},[e._v("make")]),e._v(" method with a concrete instead of an abstract.")]),t("p",[e._v("If you have a "),t("code",{pre:!0},[e._v("SomeService")]),e._v(" class that you need to instantiate on the fly, simply make it, it will return you a "),t("code",{pre:!0},[e._v("SomeService")]),e._v(" instance by following all the resolving steps.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[e._v("app.make(SomeService); "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("// SomeService {}")]),e._v("\n")])]),t("p",[e._v("To push it furthermore, let's say that you have a singleton of the "),t("code",{pre:!0},[e._v("once")]),e._v(" abstract.\nMaking "),t("code",{pre:!0},[e._v("once")]),e._v(" twice will not create a new instance.\nIf you need another one regardless of the binding state, you could do something like "),t("code",{pre:!0},[e._v("app.make(app.make('once').constructor)")]),e._v(".\nIt will create a new instance of the "),t("code",{pre:!0},[e._v("once")]),e._v(" concrete class.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[e._v("app.singleton("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'once'")]),e._v(", SomeService);\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("const")]),e._v(" once = app.make("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'once'")]),e._v("); "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("// SomeService {}")]),e._v("\nonce === app.make("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'once'")]),e._v("); "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("// true")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("const")]),e._v(" other = app.make(app.make("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'once'")]),e._v(").constructor); "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("// SomeService {}")]),e._v("\nonce === other; "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("// false")]),e._v("\n")])]),t("h3",[e._v("The resolve method")]),t("p",[e._v("The "),t("code",{pre:!0},[e._v("resolve")]),e._v(" method does the same thing as the "),t("code",{pre:!0},[e._v("make")]),e._v(" method.\nIf the given abstract should be a singleton, it will be stored as a singleton.\nHowever, it won't consider the singleton when resolving the abstract, so don't expect to receive the same concrete twice.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[e._v("app.singleton("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'once'")]),e._v(", SomeService);\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("const")]),e._v(" once = app.resolve("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'once'")]),e._v("); "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("// SomeService {}")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("const")]),e._v(" other = app.resolve("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'once'")]),e._v("); "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("// SomeService {}")]),e._v("\nonce === other; "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("// false")]),e._v("\nonce === app.make("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'once'")]),e._v("); "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("// true, the first instance will still be kept as a singleton")]),e._v("\n")])]),t("h2",[e._v("Aliases")]),t("p",[e._v("Aliasing an abstract can be useful to keep simple abstract names, while still having the binding secured with a namespaced abstract.")]),t("p",[e._v("Let's say that you have a binding called "),t("code",{pre:!0},[e._v("namespace.foo.bar.baz")]),e._v(" and you want to have it available with "),t("code",{pre:!0},[e._v("baz")]),e._v(".\nSimply call "),t("code",{pre:!0},[e._v("app.alias('baz', 'namespace.foo.bar.baz')")]),e._v(".\nWhen making "),t("code",{pre:!0},[e._v("baz")]),e._v(", the "),t("code",{pre:!0},[e._v("namespace.foo.bar.baz")]),e._v(" concrete will be returned.\nIt still handles singleton as it would be with the original abstract.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[e._v("app.singleton("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'foo'")]),e._v(", SomeService);\napp.alias("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'bar'")]),e._v(", "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'foo'")]),e._v(");\napp.alias("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'baz'")]),e._v(", "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'bar'")]),e._v(");\napp.make("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'foo'")]),e._v(") === app.make("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'bar'")]),e._v("); "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("// true")]),e._v("\napp.make("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'foo'")]),e._v(") === app.make("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'baz'")]),e._v("); "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("// true")]),e._v("\n")])]),t("h2",[e._v("Decorators")]),t("p",[e._v("Decorators are a very effective way to enhance the available features within a class instance.\nIn Node IoC, the decorators are simply closures in which we transform the value to either a new one or in the same one with enhanced or transformed behavior.\nIt acts the same way as a reducer, so you must return a value at the end of the decorator.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[e._v("app.bind("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'foo'")]),e._v(", SomeService);\napp.decorate("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'foo'")]),e._v(", (someService) => {\n    someService.prepareSomething();\n\n    "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" someService;\n});\napp.decorate("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'foo'")]),e._v(", (someService) => {\n    "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("new")]),e._v(" SomeServiceDecorator(someService);\n});\n")])]),t("h2",[e._v("Tags")]),t("p",[e._v("Tagging is a feature that allows abstract grouping.\nIn OOP, with interfaces, it is usually used to group concretes that share the same interface.")]),t("p",[e._v("The best example would be loggers: one that logs into a file and another that logs through ElasticSearch.\nBoth of them expose the same API that returns the same value types but is implemented in two different ways.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[e._v("app.singleton("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'logger.file'")]),e._v(", FileLogger);\napp.singleton("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'logger.elasticsearch'")]),e._v(", ElasticSearchLogger);\napp.tag(["),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'logger.file'")]),e._v(", "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'logger.elasticsearch'")]),e._v("], "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'loggers'")]),e._v(");\n\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("const")]),e._v(" loggers = app.make("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'loggers'")]),e._v(");\n"),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("/*\n * It returns a dictionary that pairs abstract to resolved concretes attached to the resolved tag.\n *\n * {\n *     'logger.file':          FileLogger {},\n *     'logger.elasticsearch': ElasticSearchLogger {}\n * }\n */")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("await")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-built_in"}},[e._v("Object")]),e._v(".values(loggers).map("),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("async")]),e._v(" (logger) => {\n    "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("await")]),e._v(" logger.log("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'Something to log'")]),e._v(");\n});\n")])]),t("h2",[e._v("Dependency injection")]),t("p",[e._v("The most powerful tool in the Node IoC container is the dependency injection system.\nIt was mostly inspired by the "),t("a",{attrs:{href:"https://docs.angularjs.org/guide/di#-inject-property-annotation"}},[e._v("Angular.js")]),e._v(" dependency injection approach in terms of usage, but some magic was added to the recipe for easier user-end implementation.")]),t("p",[e._v("To request dependencies in a class instance, you must implement a static getter called "),t("code",{pre:!0},[e._v("dependencies")]),e._v(".")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-class"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("class")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("SomeService")]),e._v("  ")]),e._v("{\n\n    "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("static")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("get")]),e._v(" dependencies() {\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" ["),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'app'")]),e._v(", "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'config'")]),e._v("]\n    }\n\n    "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("constructor")]),e._v("(...parameters) {\n        "),t("span",{pre:!0,attrs:{class:"hljs-built_in"}},[e._v("console")]),e._v(".log(parameters);\n    }\n\n}\n\napp.make(SomeService); "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("// console -> [Application {}, ConfigRepository {}]")]),e._v("\n\n")])]),t("p",[e._v("If a dependency cannot be resolved, it will throw an error.")]),t("p",[e._v("This is where the "),t("code",{pre:!0},[e._v("make")]),e._v(" and the "),t("code",{pre:!0},[e._v("resolve")]),e._v(" methods add a new feature: dependency injection overwriting.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-class"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("class")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("SomeService")]),e._v("  ")]),e._v("{\n\n    "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("static")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("get")]),e._v(" dependencies() {\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" ["),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'app'")]),e._v(", "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'config'")]),e._v("];\n    }\n\n    "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("constructor")]),e._v("(...parameters) {\n        "),t("span",{pre:!0,attrs:{class:"hljs-built_in"}},[e._v("console")]),e._v(".log(parameters);\n    }\n\n}\n\n"),t("span",{pre:!0,attrs:{class:"hljs-class"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("class")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("FakeConfigRepository")]),e._v(" ")]),e._v("{} "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("// To be implemented...")]),e._v("\n\n\napp.make(SomeService, {\n    "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("config")]),e._v(": app.make(FakeConfigRepository)\n}); "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("// console -> [Application {}, FakeConfigRepository {}]")]),e._v("\n")])]),t("p",[e._v("When overwriting dependency injection, the required dependency concrete bound in the container will not be instantiated.")]),t("p",[e._v("The fun part is that the container automatically binds the different injected concrete in the class instance as accessors.\nThe name is transformed into a "),t("code",{pre:!0},[e._v("camelCase")]),e._v(" representation of the abstract.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-class"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("class")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("SomeService")]),e._v("  ")]),e._v("{\n\n    "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("static")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("get")]),e._v(" dependencies() {\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" ["),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'app'")]),e._v(", "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'config'")]),e._v(", "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'router.handler'")]),e._v("];\n    }\n\n}\n\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("const")]),e._v(" someService = app.make(SomeService);\n"),t("span",{pre:!0,attrs:{class:"hljs-built_in"}},[e._v("console")]),e._v(".log(someService.app);          "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("// Application {}")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-built_in"}},[e._v("console")]),e._v(".log(someService.config);       "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("// ConfigRepository {}")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-built_in"}},[e._v("console")]),e._v(".log(someService.routerHander); "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("// Handler {}")]),e._v("\n")])]),t("p",[e._v("It also binds the application to the instance with the "),t("code",{pre:!0},[e._v("[@absolunet/private-registry](https://github.com/absolunet/node-private-registry)")]),e._v(" library.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("import")]),e._v(" __ "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("from")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'@absolunet/private-registry'")]),e._v(";\n\n"),t("span",{pre:!0,attrs:{class:"hljs-class"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("class")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("SomeService")]),e._v("  ")]),e._v("{\n\n    "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("static")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("get")]),e._v(" dependencies() {\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" ["),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'app'")]),e._v(", "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'config'")]),e._v(", "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'router.handler'")]),e._v("];\n    }\n\n}\n\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("const")]),e._v(" someService = app.make(SomeService);\n__(someService).get("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'app'")]),e._v(");            "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("// Application {}")]),e._v("\n__(someService).get("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'config'")]),e._v(");         "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("// ConfigRepository {}")]),e._v("\n__(someService).get("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'router.handler'")]),e._v("); "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("// Handler {}")]),e._v("\n")])]),t("h2",[e._v("Resolving algorithm")]),t("p",[e._v("The main resolving algorithm handles all the previously described features but has much more power under the hood.")]),t("ul",[t("li",[e._v("Abstract resolution")]),t("li",[e._v("Tag resolution")]),t("li",[e._v("Alias resolution")]),t("li",[e._v("Concrete resolution")]),t("li",[e._v("File path resolution (through "),t("code",{pre:!0},[e._v("require()")]),e._v(")")]),t("li",[e._v("Class instantiation")]),t("li",[e._v("Factory call")]),t("li",[e._v("Object extension")]),t("li",[e._v("Concrete decoration")]),t("li",[e._v("Singleton management")])]),t("p",[e._v("First, when trying to make concrete from either an abstract or an object, the contains checks if a singleton exists with the given abstract name.\nIf the abstract is not a string, it will always return a fresh instance.\nIf a singleton exists, it is returned without going any further.")]),t("p",[e._v("If a singleton is not found, then the concrete is resolved.")]),t("p",[e._v("To resolve the concrete, it starts by checking if the given abstract is bound to the container, either as an abstract or as an alias.\nIf it is the case, the concrete is retrieved, along with a singleton flag.")]),t("p",[e._v("Otherwise, if the abstract is a valid tag, the tagged concretes are resolved through the same process within a loop to resolve all the tagged abstracts.")]),t("p",[e._v("Otherwise, if the abstract is a string, it assumes that it must be either a path, or a module that can be required.\nIt attempts to require it.")]),t("p",[e._v("Otherwise, the abstract is considered a concrete.")]),t("p",[e._v("Then, when a concrete has been found, it builds it by following those rules:")]),t("ul",[t("li",[e._v("If it is a class or a regular function, it returns a new instance with dependency injection, if present.")]),t("li",[e._v("Otherwise, if it is a function, it calls it and returns the received value.")]),t("li",[e._v("Otherwise, it treats it as an object and merges the dependency overwrites in it, if provided.")])]),t("p",[e._v("Now that the build has been done, all the decorators, in order of bindings, decorates the built instance.")]),t("p",[e._v("After the final object has been created, if the abstract was bound as a singleton, the object is stored in order to be retrieved later.")]),t("p",[e._v("Finally, the instance is returned.")])])}],n=t("2877"),o={},l=Object(n["a"])(o,a,r,!1,null,null,null);s["default"]=l.exports},"907f":function(e,s,t){"use strict";t.r(s);var a=function(){var e=this,s=e.$createElement;e._self._c;return e._m(0)},r=[function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("section",[t("h1",[e._v("Factories")]),t("h2",[e._v("Introduction")]),t("p",[e._v("Model factories are very useful when it comes to testing and prototyping applications.\nIt allows you to create random model instances and database records with data that may seem real by using "),t("a",{attrs:{href:"https://github.com/marak/faker.js"}},[e._v("Faker.js")]),e._v(".")]),t("p",[e._v("The "),t("code",{pre:!0},[e._v("db.factory")]),e._v(" service will help you quickly create fake models from your fake model schemas.")]),t("h2",[e._v("Model factory")]),t("p",[e._v("A model factory is a simple class that links a model name to a fake schema for a quick scaffold.\nIt has a "),t("code",{pre:!0},[e._v("model")]),e._v(" accessor, which returns the model identifier in the "),t("code",{pre:!0},[e._v("db.model")]),e._v(" repository.\nThe "),t("code",{pre:!0},[e._v("make")]),e._v(" method is then used to get a fake data object to create a model instance.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-class"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("class")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("UserFactory")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("extends")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("Factory")]),e._v(" ")]),e._v("{\n\n    "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("get")]),e._v(" model() {\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'User'")]),e._v("\n    }\n\n    make(faker) {\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" {\n            "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("name")]),e._v(":     faker.name.findName(),\n            "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("email")]),e._v(":    faker.internet.email(),\n            "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("password")]),e._v(": faker.internet.password()\n        };\n    }\n\n}\n")])]),t("h2",[e._v("Auto-registration")]),t("p",[e._v("By default, all the model factories defined in the "),t("code",{pre:!0},[e._v("src/database/factories")]),e._v(" folders will be automatically registered in the factory service.\nOtherwise, the "),t("code",{pre:!0},[e._v("register")]),e._v(" method is defined, so you can manually define model factories.")]),t("p",[e._v("Given the "),t("code",{pre:!0},[e._v("UserFactory")]),e._v(" that has the "),t("code",{pre:!0},[e._v("model")]),e._v(" set to "),t("code",{pre:!0},[e._v("User")]),e._v(", the following registration would work.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("const")]),e._v(" factory = app.make("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'db.factory'")]),e._v(");\n\nfactory.register(UserFactory); "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v('// By default, will be registered as "User" based on its "model" accessor.')]),e._v("\nfactory.register(UserFactory, "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'Admin'")]),e._v("); "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v('// Instead of being registered as "User", the model factory will be registered as "Admin", for the "Admin model.')]),e._v("\n")])]),t("h3",[e._v("The make:factory command")]),t("p",[e._v("This command will help you quickly scaffold a model factory class file.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-bash"}},[e._v("node ioc make:factory UserFactory\n")])]),t("p",[e._v("If you are creating a model, you can also use the "),t("code",{pre:!0},[e._v("--factory")]),e._v(" flag, or the "),t("code",{pre:!0},[e._v("--all")]),e._v(" flag with migration and seeder.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-bash"}},[e._v("node ioc make:model User --factory\n")])]),t("p",[e._v("This will create a "),t("code",{pre:!0},[e._v("src/database/factories/UserFactory")]),e._v(" file, linked to the "),t("code",{pre:!0},[e._v("User")]),e._v(" model.")]),t("p",[e._v("The command will simply assume that the name, without the suffix "),t("code",{pre:!0},[e._v("Factory")]),e._v(", will be the model name.")]),t("h2",[e._v("Make a model from a factory")]),t("p",[e._v("To make a model based on the factory schema, the "),t("code",{pre:!0},[e._v("db.factory")]),e._v(" offers the "),t("code",{pre:!0},[e._v("make")]),e._v(" method, that accepts the following arguments:")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("const")]),e._v(" factory = app.make("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'db.factory'")]),e._v(");\n\nfactory.make("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'User'")]),e._v("); "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("// User {}")]),e._v("\nfactory.make("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'User'")]),e._v(", { "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("password")]),e._v(": "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'1234567890'")]),e._v(" }); "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("// User {} with specific password")]),e._v("\nfactory.make("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'User'")]),e._v(", "),t("span",{pre:!0,attrs:{class:"hljs-number"}},[e._v("2")]),e._v("); "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("// Collection {} with 2 User {}")]),e._v("\nfactory.make("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'User'")]),e._v(", { "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("password")]),e._v(": "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'1234567890'")]),e._v(" }, "),t("span",{pre:!0,attrs:{class:"hljs-number"}},[e._v("3")]),e._v("); "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("// Collection {} with 2 User {}, with specific password")]),e._v("\n")])]),t("p",[e._v("If you only want the data, without a Model instance, the "),t("code",{pre:!0},[e._v("get")]),e._v(" method will return the model factory instance.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("const")]),e._v(" factory = app.make("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'db.factory'")]),e._v(");\n\nfactory.get("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'User'")]),e._v("); "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("// UserFactory {}")]),e._v("\nfactory.get("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'User'")]),e._v(").make(); "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v('// { name: "John Smith", email: "john.smith@example.com", password: "3x@mp1e" }')]),e._v("\n")])])])}],n=t("2877"),o={},l=Object(n["a"])(o,a,r,!1,null,null,null);s["default"]=l.exports},9407:function(e,s,t){"use strict";t.r(s);var a=function(){var e=this,s=e.$createElement;e._self._c;return e._m(0)},r=[function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("section",[t("h1",[e._v("Create a command")]),t("h2",[e._v("Introduction")]),t("p",[e._v("In this first of four first steps tutorials, you will create your first CLI command.")]),t("p",[e._v("For this first assignment, we will build a command that will display a book suggestion related to a given query through the "),t("a",{attrs:{href:"https://developers.google.com/books/docs/v1/using#PerformingSearch"}},[e._v("Google Books API")]),e._v(".")]),t("p",[e._v("Here are the key concepts that will be part of this tutorial:")]),t("ul",[t("li",[e._v("The "),t("code",{pre:!0},[e._v("Command")]),e._v(" class")]),t("li",[e._v("Scaffolding command with "),t("code",{pre:!0},[e._v("make:command")])]),t("li",[e._v("The "),t("code",{pre:!0},[e._v("http")]),e._v(" service")]),t("li",[e._v("The "),t("code",{pre:!0},[e._v("terminal")]),e._v(" service (through the command methods)")])]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":""}},[e._v("node ioc inspire:book react\n\nFullstack React\nThe Complete Guide to ReactJS and Friends\nBy Accomazzo Anthony, Accomazzo Anthony and Ari Lerner\nPublished date: 2017-03\nEbook: http://books.google.ca/books?id=ppjUtAEACAAJ&dq=react&hl=&source=gbs_api\n")])]),t("h2",[e._v("Create the command class file")]),t("p",[e._v("First, we need a command class file.\nNode IoC offers you a command to create a command scaffold.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-bash"}},[e._v("node ioc make:"),t("span",{pre:!0,attrs:{class:"hljs-built_in"}},[e._v("command")]),e._v(" InspireBookCommand\n")])]),t("p",[e._v("This will create a file named "),t("code",{pre:!0},[e._v("InspireBookCommand.js")]),e._v(" under the "),t("code",{pre:!0},[e._v("src/app/commands")]),e._v(" folder.\nNow that the file has been created, we need to test that it is correctly bootstrapped by the kernel.\nWe need to compile our code.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-bash"}},[e._v("npm run manager:build\n")])]),t("p",[e._v("Once the code is fully compiled by the Manager, run "),t("code",{pre:!0},[e._v("node ioc")]),e._v(" command, you should see a new command called "),t("code",{pre:!0},[e._v("name:command")]),e._v(" in the list.\nLet's try it out!")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-bash"}},[e._v("node ioc name:"),t("span",{pre:!0,attrs:{class:"hljs-built_in"}},[e._v("command")]),e._v("\n")])]),t("p",[e._v("You should see a console message indicating "),t("code",{pre:!0},[e._v("To be implemented...")]),e._v(".")]),t("p",[e._v("From now on, we will not need to create new files, so you can use the Manager watch command to compile files on save.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-bash"}},[e._v("npm run manager:watch\n")])]),t("h2",[e._v("Fill command metadata")]),t("p",[e._v("Once that the command has been created, we need to properly fill metadata, such as the name, the description, etc.")]),t("p",[e._v("First, we need to change the generic command name.\nLet's name it "),t("code",{pre:!0},[e._v("inspire:book")]),e._v(".\nSecond, let's adjust the command description.\nHow about "),t("code",{pre:!0},[e._v("Find an inspiring book that matches your needs")]),e._v("?")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-class"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("class")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("InspireBookCommand")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("extends")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("Command")]),e._v(" ")]),e._v("{\n\n    "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("/* ... */")]),e._v("\n\n    "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("get")]),e._v(" name() {\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'inspire:book'")]),e._v(";\n    }\n\n    "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("get")]),e._v(" description() {\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'Find an inspiring book that matches your needs.'")]),e._v(";    \n    }\n\n    "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("/* ... */")]),e._v("\n\n}\n")])]),t("p",[e._v("Now, if you run "),t("code",{pre:!0},[e._v("node ioc")]),e._v(", you should see your new command name, followed by its new description.\nIf it's still the old name, don't forget to compile your code!")]),t("h2",[e._v("Describe arguments")]),t("p",[e._v("After this, if you take a look above on the expected result, we need to handle an argument.\nIn the example, the argument is a "),t("code",{pre:!0},[e._v("parameter")]),e._v(", its value is "),t("code",{pre:!0},[e._v("react")]),e._v(".")]),t("blockquote",[t("p",[e._v("A "),t("strong",[e._v("parameter")]),e._v(" is a value that follows the command, without the "),t("code",{pre:!0},[e._v("--")]),e._v(" prefix, such as "),t("code",{pre:!0},[e._v("name:command parameter")]),e._v(".")]),t("p",[e._v("An "),t("strong",[e._v("option")]),e._v(" is a value that follows an option name, such as "),t("code",{pre:!0},[e._v("name:command --option=value")]),e._v(".")]),t("p",[e._v("A "),t("strong",[e._v("flag")]),e._v(" is a boolean status that is set to "),t("code",{pre:!0},[e._v("true")]),e._v(" when present, such as "),t("code",{pre:!0},[e._v("name:command --flag")]),e._v(".")])]),t("p",[e._v("To be able to receive a parameter, we need to specify it in the command through the "),t("code",{pre:!0},[e._v("parameters")]),e._v(" accessor.")]),t("p",[e._v("It should return a two-dimensional array of "),t("code",{pre:!0},[e._v("Parameter")]),e._v(" arguments, which are, in order, "),t("code",{pre:!0},[e._v("[name, isRequired, defaultValue, description]")]),e._v(".")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-class"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("class")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("InspireBookCommand")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("extends")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("Command")]),e._v(" ")]),e._v("{\n\n    "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("/* ... */")]),e._v("\n\n    "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("get")]),e._v(" parameters() {\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" [\n            ["),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'book'")]),e._v(", "),t("span",{pre:!0,attrs:{class:"hljs-literal"}},[e._v("true")]),e._v(", "),t("span",{pre:!0,attrs:{class:"hljs-literal"}},[e._v("null")]),e._v(", "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'The book you are searching for.'")]),e._v("]\n        ];\n    }\n\n    "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("/* ... */")]),e._v("\n\n}\n")])]),t("p",[e._v("Now, you can inspect the command signature through the "),t("code",{pre:!0},[e._v("--help")]),e._v(" flag.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":""}},[e._v("node ioc inspire:book --help\n\nioc inspire:book <book>\n\nFind an inspiring book that matches your needs.\n\nOptions:\n  --help         Show help                            [boolean]\n  --version      Show version number                  [boolean]\n  -v, --verbose  Adjust the verbosity of the command    [count]\n")])]),t("p",[e._v("We can see that the "),t("code",{pre:!0},[e._v("book")]),e._v(" parameter is now handled by the console engine.")]),t("p",[e._v("Now, let's try to retrieve the parameter value in the "),t("code",{pre:!0},[e._v("handle")]),e._v(" method.\nYou can do it with the "),t("code",{pre:!0},[e._v("parameter")]),e._v(" method.\nIt needs the parameter name as the only argument.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-class"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("class")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("InspireBookCommand")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("extends")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("Command")]),e._v(" ")]),e._v("{\n\n    "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("/* ... */")]),e._v("\n\n    "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("get")]),e._v(" parameters() {\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" [\n            ["),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'book'")]),e._v(", "),t("span",{pre:!0,attrs:{class:"hljs-literal"}},[e._v("true")]),e._v(", "),t("span",{pre:!0,attrs:{class:"hljs-literal"}},[e._v("null")]),e._v(", "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'The book you are searching for.'")]),e._v("]\n        ];\n    }\n\n    handle() {\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".info("),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".parameter("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'book'")]),e._v("));\n    }\n\n}\n")])]),t("p",[e._v("When running "),t("code",{pre:!0},[e._v("node ioc inspire:book react")]),e._v(", you should see "),t("code",{pre:!0},[e._v("react")]),e._v(" logged back in the console.")]),t("h2",[e._v("Inject the http service")]),t("p",[e._v("Now, we have all we need to consume the "),t("a",{attrs:{href:"https://developers.google.com/books/docs/v1/using#PerformingSearch"}},[e._v("Google Books API")]),e._v(".\nTo consume it, we need the "),t("code",{pre:!0},[e._v("http")]),e._v(" service, which allows us to make HTTP calls.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-class"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("class")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("InspireBookCommand")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("extends")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("Command")]),e._v(" ")]),e._v("{\n\n    "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("static")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("get")]),e._v(" dependencies() {\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" ["),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'http'")]),e._v("];\n    }\n\n    "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("get")]),e._v(" name() {\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'inspire:book'")]),e._v(";\n    }\n\n    "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("get")]),e._v(" description() {\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'Find an inspiring book that matches your needs.'")]),e._v(";    \n    }\n\n    "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("get")]),e._v(" parameters() {\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" [\n            ["),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'book'")]),e._v(", "),t("span",{pre:!0,attrs:{class:"hljs-literal"}},[e._v("true")]),e._v(", "),t("span",{pre:!0,attrs:{class:"hljs-literal"}},[e._v("null")]),e._v(", "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'The book you are searching for.'")]),e._v("]\n        ];\n    }\n\n    handle() {\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".info("),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".parameter("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'book'")]),e._v("));\n    }\n\n}\n")])]),t("p",[e._v("The "),t("code",{pre:!0},[e._v("http")]),e._v(" service now bound to your class, you can use "),t("code",{pre:!0},[e._v("this.http.get(url, config)")]),e._v(".")]),t("h2",[e._v("Make the API call")]),t("p",[e._v("Now, we need to make an API call to Google Books.\nSince an API call takes time, we need to switch to "),t("code",{pre:!0},[e._v("async")]),e._v(" mode.\nSimply use the "),t("code",{pre:!0},[e._v("async")]),e._v(" keyword before the "),t("code",{pre:!0},[e._v("handle")]),e._v(" method to make it async.\nAt the same time, let's make our API call.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-class"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("class")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("InspireBookCommand")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("extends")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("Command")]),e._v(" ")]),e._v("{\n\n    "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("/* ... */")]),e._v("\n\n    "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("async")]),e._v(" handle() {\n    \t"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("const")]),e._v(" { "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("data")]),e._v(": { items } } = "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("await")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".http.get("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'https://www.googleapis.com/books/v1/volumes'")]),e._v(", {\n    \t    "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("params")]),e._v(": {\n    \t    \t"),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("q")]),e._v(": "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".parameter("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'book'")]),e._v(")\n    \t    }\n        });\n\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".write(items.length); "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("// It should print 10, the default pagination size.")]),e._v("\n    }\n\n}\n")])]),t("p",[e._v("Now that we made our API call, to inspire the user, we need to pick a random item.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-class"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("class")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("InspireBookCommand")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("extends")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("Command")]),e._v(" ")]),e._v("{\n\n    "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("/* ... */")]),e._v("\n\n    "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("async")]),e._v(" handle() {\n    \t"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("const")]),e._v(" { "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("data")]),e._v(": { items } } = "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("await")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".http.get("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'https://www.googleapis.com/books/v1/volumes'")]),e._v(", {\n    \t    "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("params")]),e._v(": {\n    \t    \t"),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("q")]),e._v(": "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".parameter("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'book'")]),e._v(")\n    \t    }\n        });\n\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("const")]),e._v(" item = items.sort("),t("span",{pre:!0,attrs:{class:"hljs-function"}},[t("span",{pre:!0,attrs:{class:"hljs-params"}},[e._v("()")]),e._v(" =>")]),e._v(" {\n            "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-built_in"}},[e._v("Math")]),e._v(".random() - "),t("span",{pre:!0,attrs:{class:"hljs-number"}},[e._v("0.5")]),e._v(";\n        }).shift();\n\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".write(item); "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("// You should have the book model from the Google API.")]),e._v("\n    }\n\n}\n")])]),t("h2",[e._v("Format the output")]),t("p",[e._v("We now have everything we need to display that inspiring book to the user.\nWe just need to format the final output.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-class"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("class")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("InspireBookCommand")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("extends")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("Command")]),e._v(" ")]),e._v("{\n\n    "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("/* ... */")]),e._v("\n\n    "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("async")]),e._v(" handle() {\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("const")]),e._v(" { "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("data")]),e._v(": { "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("items")]),e._v(": books } } = "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("await")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".http.get("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'https://www.googleapis.com/books/v1/volumes'")]),e._v(", {\n            "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("params")]),e._v(": {\n                "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("q")]),e._v(": "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".parameter("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'book'")]),e._v(")\n            }\n        });\n\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("const")]),e._v(" [{ "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("volumeInfo")]),e._v(": { authors, infoLink, publishedDate, subtitle, title  } }] = books.sort("),t("span",{pre:!0,attrs:{class:"hljs-function"}},[t("span",{pre:!0,attrs:{class:"hljs-params"}},[e._v("()")]),e._v(" =>")]),e._v(" {\n            "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-built_in"}},[e._v("Math")]),e._v(".random() - "),t("span",{pre:!0,attrs:{class:"hljs-number"}},[e._v("0.5")]),e._v(";\n        });\n\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("const")]),e._v(" lastAuthor = authors.pop();\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("const")]),e._v(" formattedAuthors = "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("`"),t("span",{pre:!0,attrs:{class:"hljs-subst"}},[e._v("${authors.length > "),t("span",{pre:!0,attrs:{class:"hljs-number"}},[e._v("0")]),e._v(" ? "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("`"),t("span",{pre:!0,attrs:{class:"hljs-subst"}},[e._v("${authors.join("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("', '")]),e._v(")}")]),e._v(" and `")]),e._v(" : "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("''")]),e._v("}")]),t("span",{pre:!0,attrs:{class:"hljs-subst"}},[e._v("${lastAuthor}")]),e._v("`")]),e._v(";\n\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("let")]),e._v(" output = "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("`\\n"),t("span",{pre:!0,attrs:{class:"hljs-subst"}},[e._v("${title}")]),e._v("\\n`")]),e._v(";\n\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("if")]),e._v(" (subtitle) {\n            output += "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("`"),t("span",{pre:!0,attrs:{class:"hljs-subst"}},[e._v("${subtitle}")]),e._v("\\n`")]),e._v(";\n        }\n\n        output += "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("`By "),t("span",{pre:!0,attrs:{class:"hljs-subst"}},[e._v("${formattedAuthors}")]),e._v("\\n`")]),e._v(";\n        output += "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("`Published date: "),t("span",{pre:!0,attrs:{class:"hljs-subst"}},[e._v("${publishedDate}")]),e._v("\\n`")]),e._v(";\n        output += "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("`Ebook: "),t("span",{pre:!0,attrs:{class:"hljs-subst"}},[e._v("${infoLink}")]),e._v("`")]),e._v(";\n\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".info(output);\n    }\n\n}\n")])]),t("p",[e._v("Here is the final result with enhanced structure:")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("import")]),e._v(" { Command } "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("from")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'@absolunet/ioc'")]),e._v(";\n\n\n"),t("span",{pre:!0,attrs:{class:"hljs-class"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("class")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("InspireBookCommand")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("extends")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("Command")]),e._v(" ")]),e._v("{\n\n    "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("static")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("get")]),e._v(" dependencies() {\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" ["),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'http'")]),e._v("];\n    }\n\n    "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("get")]),e._v(" name() {\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'inspire:book'")]),e._v(";\n    }\n\n    "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("get")]),e._v(" description() {\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'Find an inspiring book that matches your needs.'")]),e._v(";\n    }\n\n    "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("get")]),e._v(" parameters() {\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" [\n            ["),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'book'")]),e._v(", "),t("span",{pre:!0,attrs:{class:"hljs-literal"}},[e._v("true")]),e._v(", "),t("span",{pre:!0,attrs:{class:"hljs-literal"}},[e._v("null")]),e._v(", "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'The book you are searching for.'")]),e._v("]\n        ];\n    }\n\n    "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("async")]),e._v(" handle() {\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("const")]),e._v(" book = "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("await")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".loadRandomBook();\n\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".info("),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".getFormattedBookInfo(book));\n    }\n\n    "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("async")]),e._v(" loadRandomBook() {\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("const")]),e._v(" { "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("data")]),e._v(": { items } } = "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("await")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".http.get("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'https://www.googleapis.com/books/v1/volumes'")]),e._v(", {\n            "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("params")]),e._v(": {\n                "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("q")]),e._v(": "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".parameter("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'book'")]),e._v(")\n            }\n        });\n\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" items.sort("),t("span",{pre:!0,attrs:{class:"hljs-function"}},[t("span",{pre:!0,attrs:{class:"hljs-params"}},[e._v("()")]),e._v(" =>")]),e._v(" {\n            "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-built_in"}},[e._v("Math")]),e._v(".random() - "),t("span",{pre:!0,attrs:{class:"hljs-number"}},[e._v("0.5")]),e._v(";\n        }).shift();\n    }\n\n    getFormattedBookInformation({ "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("volumeInfo")]),e._v(": { authors, infoLink, publishedDate, subtitle, title } }) {\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("const")]),e._v(" lastAuthor = authors.pop();\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("const")]),e._v(" formattedAuthors = "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("`"),t("span",{pre:!0,attrs:{class:"hljs-subst"}},[e._v("${authors.length > "),t("span",{pre:!0,attrs:{class:"hljs-number"}},[e._v("0")]),e._v(" ? "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("`"),t("span",{pre:!0,attrs:{class:"hljs-subst"}},[e._v("${authors.join("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("', '")]),e._v(")}")]),e._v(" and `")]),e._v(" : "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("''")]),e._v("}")]),t("span",{pre:!0,attrs:{class:"hljs-subst"}},[e._v("${lastAuthor}")]),e._v("`")]),e._v(";\n\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("const")]),e._v(" information = [\n        \ttitle,\n            subtitle,\n            "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("`By "),t("span",{pre:!0,attrs:{class:"hljs-subst"}},[e._v("${formattedAuthors}")]),e._v("`")]),e._v(",\n            "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("`Published date: "),t("span",{pre:!0,attrs:{class:"hljs-subst"}},[e._v("${publishedDate}")]),e._v("`")]),e._v(",\n            "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("`Ebook: "),t("span",{pre:!0,attrs:{class:"hljs-subst"}},[e._v("${infoLink}")]),e._v("`")]),e._v("\n        ];\n\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" information.filter("),t("span",{pre:!0,attrs:{class:"hljs-built_in"}},[e._v("Boolean")]),e._v(").join("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'\\n'")]),e._v(");\n    }\n\n}\n\n\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("export")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("default")]),e._v(" InspireBookCommand;\n")])])])}],n=t("2877"),o={},l=Object(n["a"])(o,a,r,!1,null,null,null);s["default"]=l.exports},"9c50":function(e,s,t){},a100:function(e,s,t){"use strict";t.r(s);var a=function(){var e=this,s=e.$createElement;e._self._c;return e._m(0)},r=[function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("section",[t("h1",[e._v("Cache")]),t("h2",[e._v("Introduction")]),t("p",[e._v("Cache in Node IoC is very simple to use, configuration-driven and makes it easy to store data in multiple backends.\nIt offers out-of-the-box runtime, file and database caching drivers, but makes implementing Redis or Memcached very simple if you want or need it.")]),t("h2",[e._v("Configuration")]),t("p",[e._v("To use the cache system, it must be configured first.\nYou can find the cache configuration in the "),t("code",{pre:!0},[e._v("config/cache.yaml")]),e._v(" file.")]),t("p",[e._v("By default, the file cache store is used, under "),t("code",{pre:!0},[e._v("default")]),e._v(".\nThere is three different stores available: "),t("code",{pre:!0},[e._v("runtime")]),e._v(", "),t("code",{pre:!0},[e._v("file")]),e._v(" and "),t("code",{pre:!0},[e._v("database")]),e._v(".\nEach of them has a dedicated driver, so you can reuse those drivers with other cache stores, with another configuration.")]),t("p",[e._v("Let's say for instance that you need to cache in a different file for a certain type of data.\nYou could have this configuration.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-yaml"}},[t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("stores:")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("  file:")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("    driver:")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("file")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("    path:")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'/path/to/folder'")]),e._v("\n\n"),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("  other:")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("    driver:")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("file")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("    path:")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'/path/to/other/folder'")]),e._v("\n")])]),t("p",[e._v("Also, you can specify the global configuration, under the "),t("code",{pre:!0},[e._v("common")]),e._v(" key.\nYou can configure the cache prefix with the "),t("code",{pre:!0},[e._v("common.prefix")]),e._v(" key.\nIt may be very useful if using a common cache system such as Redis.\nAlso, you can specify a default expiration time, in seconds.\nIf data was cached without specific expiration time, this time will be used.")]),t("h2",[e._v("The cache manager")]),t("p",[e._v("The cache manager, injectable through "),t("code",{pre:!0},[e._v("cache")]),e._v(", will help to resolve the cache driver instance through configuration.\nWith the proxy wrapper, you can directly access the default driver instance from it, or you can get the driver for the store you want.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("const")]),e._v(" cache = app.make("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'cache'")]),e._v("); "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("// CacheManager {}")]),e._v("\ncache.resolveDefault(); "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("// FileDriver {}")]),e._v("\ncache.resolve("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'runtime'")]),e._v("); "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("// RuntimeDriver {}")]),e._v("\ncache.resolve("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'other'")]),e._v("); "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("// FileDriver {}, if the above configuration were used")]),e._v("\n\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("const")]),e._v(" value      = "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("await")]),e._v(" cache.resolveDefault().get("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'key'")]),e._v(");\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("const")]),e._v(" otherValue = "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("await")]),e._v(" cache.get("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'key'")]),e._v("); "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("// Same thing as the above line is done under the hood")]),e._v("\n")])]),t("p",[e._v("You can also build your custom cache driver through the "),t("code",{pre:!0},[e._v("build")]),e._v(" method.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("const")]),e._v(" cache = app.make("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'cache'")]),e._v(");\n\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("const")]),e._v(" store = cache.build("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'file'")]),e._v(", {\n    "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("path")]),e._v(": "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'/path/to/folder'")]),e._v("\n}); "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("// FileDriver {}")]),e._v("\n")])]),t("h2",[e._v("Commands")]),t("h3",[e._v("The cache:clear command")]),t("p",[e._v("If you want to clear the whole cache, the "),t("code",{pre:!0},[e._v("cache:clear")]),e._v(" will use the default store and flush it.\nIf you need to clear a specific cache store, you can use "),t("code",{pre:!0},[e._v("cache:clear store-name")]),e._v(", such as "),t("code",{pre:!0},[e._v("cache:clear file")]),e._v(".")]),t("h3",[e._v("The cache:forget command")]),t("p",[e._v("If you need to remove a single cached key from the store, you can use "),t("code",{pre:!0},[e._v("cache:forget key")]),e._v(".\nIf you need to forget a key in a specific cache store, you can use "),t("code",{pre:!0},[e._v("cache:forget key store-name")]),e._v(", such as "),t("code",{pre:!0},[e._v("cache:clear key file")]),e._v(".")]),t("h2",[e._v("Cache drivers")]),t("p",[e._v("The cache drivers extend the same interface-like class, which contains the same base methods: "),t("code",{pre:!0},[e._v("get")]),e._v(", "),t("code",{pre:!0},[e._v("put")]),e._v(", "),t("code",{pre:!0},[e._v("forever")]),e._v(", "),t("code",{pre:!0},[e._v("increment")]),e._v(", "),t("code",{pre:!0},[e._v("decrement")]),e._v(", "),t("code",{pre:!0},[e._v("delete")]),e._v(" and "),t("code",{pre:!0},[e._v("flush")])]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("const")]),e._v(" cache = app.make("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'cache'")]),e._v(").resolveDefault();\n\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("await")]),e._v(" cache.get("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'key'")]),e._v(", "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'default value'")]),e._v("); "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v('// "default value" is returned since nothing is cached under the "key" key')]),e._v("\n\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("await")]),e._v(" cache.put("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'key'")]),e._v(", "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'new value'")]),e._v("); "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v('// "new value" cached for 10 minutes (configured as 600 seconds) under the "key" key')]),e._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("await")]),e._v(" cache.get("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'key'")]),e._v(", "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'default value'")]),e._v("); "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v('// "new value" is returned')]),e._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("await")]),e._v(" cache.put("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'other.key'")]),e._v(", "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'other value'")]),e._v(", "),t("span",{pre:!0,attrs:{class:"hljs-number"}},[e._v("1200")]),e._v("); "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v('// "other value" cached for 20 minutes under the "other.key" key')]),e._v("\n\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("await")]),e._v(" cache.forever("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'foo'")]),e._v(", "),t("span",{pre:!0,attrs:{class:"hljs-number"}},[e._v("10")]),e._v("); "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v('// 10 cached forever, without expiration date, under the "foo" key')]),e._v("\n\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("await")]),e._v(" cache.increment("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'foo'")]),e._v(");\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("await")]),e._v(" cache.get("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'foo'")]),e._v("); "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("// 11")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("await")]),e._v(" cache.decrement("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'foo'")]),e._v(");\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("await")]),e._v(" cache.get("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'foo'")]),e._v("); "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("// 10")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("await")]),e._v(" cache.increment("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'foo'")]),e._v(", "),t("span",{pre:!0,attrs:{class:"hljs-number"}},[e._v("4")]),e._v(");\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("await")]),e._v(" cache.get("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'foo'")]),e._v("); "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("// 14")]),e._v("\n\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("await")]),e._v(" cache.delete("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'foo'")]),e._v(");\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("await")]),e._v(" cache.get("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'foo'")]),e._v("); "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v('// null, the key "foo" was deleted moments earlier')]),e._v("\n\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("await")]),e._v(" cache.flush(); "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("// All the keys, including the forever cached data, are flushed from the store.")]),e._v("\n")])]),t("h3",[e._v("Runtime driver")]),t("p",[e._v("The runtime cache driver is a simple store handled by a JavaScript object, without any permanent save.\nThis cache is working through the process runtime.\nWhen the process has exited, the cache is flushed.\nIt is a good driver for testing purposes, or if you need to cache simple data, but is not suggested for production.\nIt does not need any configuration.")]),t("h3",[e._v("File driver")]),t("p",[e._v("The file driver saves the cached values in JSON files in a configured folder.\nBy default, the application suggests that the cached values go in the "),t("code",{pre:!0},[e._v("storage/framework/cache/data")]),e._v(".")]),t("h3",[e._v("Database driver")]),t("p",[e._v("The database driver uses a database connection (configured in "),t("code",{pre:!0},[e._v("config/database.yaml")]),e._v(", under the "),t("code",{pre:!0},[e._v("connections")]),e._v(" key), through the "),t("code",{pre:!0},[e._v("connection")]),e._v(" configuration key.\nTo use the default connection, simply use the "),t("code",{pre:!0},[e._v('connection: "default"')]),e._v(" configuration\nThe table name can be configured through the "),t("code",{pre:!0},[e._v("table")]),e._v(" configuration key.\nBy default, "),t("code",{pre:!0},[e._v("cache")]),e._v(" is the table that will be used.")]),t("h3",[e._v("The cache:table command")]),t("p",[e._v("To quickly create your database cache table, the "),t("code",{pre:!0},[e._v("cache:table")]),e._v(" command will create a database migration that creates the cache table by using the configured table name.\nDon't forget to run "),t("code",{pre:!0},[e._v("db:migrate")]),e._v(" after creating the cache table migration.")])])}],n=t("2877"),o={},l=Object(n["a"])(o,a,r,!1,null,null,null);s["default"]=l.exports},a199:function(e,s,t){"use strict";var a=t("7438"),r=t.n(a);r.a},a967:function(e,s,t){"use strict";t.r(s);var a=function(){var e=this,s=e.$createElement;e._self._c;return e._m(0)},r=[function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("section",[t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":""}},[e._v("# Views\n")])]),t("h2",[e._v("Introduction")]),t("p",[e._v("Views are the entry point for front-end development.\nIt allows you to render HTML pages in an organized, composable and programmatic way, inject dynamic data in your pages from the back-end, prepare the field for a single-page application, and so on.\nNode IoC has made it easy to play with views by building a configurable and extendable view factory that relies by default on "),t("a",{attrs:{href:"https://www.jsviews.com"}},[e._v("JSRender")]),e._v(" template engine.\nIf you feel the need to work with another template system, such as Pug, or more dynamic and modern engines such as React or Vue.js, feel free to create the appropriate driver in a Node IoC package.")]),t("h2",[e._v("View files")]),t("p",[e._v("In a default Node IoC application, the views are located under the "),t("code",{pre:!0},[e._v("resources/views")]),e._v(" folder.\nEverything in this folder can be moved, manipulates, deleted, whatever suits you the best.\nThe only views that should not move are the "),t("code",{pre:!0},[e._v("errors")]),e._v(" views (if you do, it will not break anything, but you will lose some exception handling features).")]),t("p",[e._v("The original structure proposes directories that separate the view concerns.\nThe "),t("code",{pre:!0},[e._v("layouts")]),e._v(" folder contains everything you need to quickly scaffold any page with a default template containing all the basic HTML tags, your head, CSS and JavaScript files, title, meta tags, etc.\nThe "),t("code",{pre:!0},[e._v("pages")]),e._v(" views use the layout by extending it and inserting content in the "),t("code",{pre:!0},[e._v("slot")]),e._v(".\nWe will go deeper into this concept.\nLike said before, feel free to move the structure to match your needs.")]),t("h2",[e._v("Make a view")]),t("p",[e._v("To render a view file, the "),t("code",{pre:!0},[e._v("view")]),e._v(" factory service was created for this purpose.\nIt exposes a "),t("code",{pre:!0},[e._v("make")]),e._v(" method that accepts two arguments: the view name to render, and a view-model object, or "),t("code",{pre:!0},[e._v("props")]),e._v(" if you will.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("const")]),e._v(" renderedView = app.make("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'view'")]),e._v(").make("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'pages.hello'")]),e._v(", { "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("heading")]),e._v(": "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'Hello world'")]),e._v(" });\n"),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v('// typeof renderedView === "string"')]),e._v("\n")])]),t("p",[e._v("This method will call the "),t("code",{pre:!0},[e._v("view.resolver")]),e._v(" to find the "),t("code",{pre:!0},[e._v("pages.hello")]),e._v(" view, retrieve its path, then render it with the "),t("code",{pre:!0},[e._v("view.engine")]),e._v(" with the view-model, if given and return the result.")]),t("h3",[e._v("View name")]),t("p",[e._v("The view name must match the view file path from the "),t("em",[e._v("views")]),e._v(" folder, with dot-separated segments, and without the file extension.")]),t("p",[e._v("If the wanted view file is "),t("code",{pre:!0},[e._v("resources/views/pages/foo/bar.html")]),e._v(", then its name should be "),t("code",{pre:!0},[e._v("pages.foo.bar")]),e._v(".")]),t("h3",[e._v("Namespace")]),t("p",[e._v('Some packages may offer some "private" templates that will not be part of your application files.\nSince all your views should have priority for names and prevent package of registering a '),t("code",{pre:!0},[e._v("pages")]),e._v(" folder, then making your own "),t("code",{pre:!0},[e._v("pages")]),e._v(" not renderable, a namespace system was built within the "),t("code",{pre:!0},[e._v("view.resolver")]),e._v(" service.")]),t("p",[e._v("To register a namespace, simply use the "),t("code",{pre:!0},[e._v("namespace")]),e._v(" method in the "),t("code",{pre:!0},[e._v("view.resolver")]),e._v(" service.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[e._v("app.make("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'view.resolver'")]),e._v(").namespace("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'home'")]),e._v(", app.homePath("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'ioc'")]),e._v(", "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'views'")]),e._v("));\n")])]),t("p",[e._v("Then, a view in this namespace can be rendered by using the "),t("code",{pre:!0},[e._v("namespace::view.name")]),e._v(" syntax.")]),t("p",[e._v("Given the "),t("code",{pre:!0},[e._v("~/ioc/views/pages/foo/bar.html")]),e._v(" file, we would render it with "),t("code",{pre:!0},[e._v("home::pages.foo.bar")]),e._v(" name.\nThat will prevent conflict between your application pages, and the home directory pages.")]),t("h2",[e._v("JSRender engine")]),t("h3",[e._v("Tags")]),t("p",[e._v("By default, JSRender offers some tags, such as "),t("code",{pre:!0},[e._v("{{:}}")]),e._v(", "),t("code",{pre:!0},[e._v("{{if}}")]),e._v(", "),t("code",{pre:!0},[e._v("{{for}}")]),e._v(", "),t("code",{pre:!0},[e._v("{{include}}")]),e._v(" and so on.\nThey are all still valid.\nHowever, the "),t("code",{pre:!0},[e._v("include")]),e._v(" tag just did not suit the Node IoC ecosystem, so it was refactored.")]),t("h4",[e._v("The "),t("em",[e._v("echo")]),e._v(" tags")]),t("p",[e._v("To print values in your views, JSRender offers the "),t("code",{pre:!0},[e._v("{{: ...}}")]),e._v(" and "),t("code",{pre:!0},[e._v("{{> ...}}")]),e._v(" tags.")]),t("p",[e._v("Given the view-model object "),t("code",{pre:!0},[e._v("{ heading: 'This is a <strong>huge</strong> news' }")]),e._v(", you can print the headings with both tags.")]),t("p",[t("code",{pre:!0},[e._v("{{:heading}}")]),e._v(' will result in "this is a '),t("strong",[e._v("huge")]),e._v(' news".')]),t("p",[t("code",{pre:!0},[e._v("{{>heading}}")]),e._v(' will result in "this is a <strong>huge</strong> news".')]),t("h4",[e._v("The "),t("em",[e._v("include")]),e._v(" tag")]),t("p",[e._v("To include another template, the "),t("code",{pre:!0},[e._v("include")]),e._v(" exists in the JSRender engine but refactored by Node IoC.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-html"}},[e._v('{{include name="components.grid.cell"}}\n    '),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[e._v("<"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[e._v("article")]),e._v(">")]),e._v('\n        {{include name="components.user.avatar" data=author /}}\n        {{include name="components.user.name" data=author /}}\n        {{include name="components.news.full data=#data /}}\n    '),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[e._v("</"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[e._v("article")]),e._v(">")]),e._v("\n{{/include}}\n")])]),t("p",[e._v("It accepts four arguments, which three of them are optional.")]),t("ul",[t("li",[t("p",[t("code",{pre:!0},[e._v("name")])]),t("blockquote",[t("p",[e._v("Required.\nThe view name to render.")])])]),t("li",[t("p",[t("code",{pre:!0},[e._v("data")])]),t("blockquote",[t("p",[e._v("Optional.\nThe view-model object to be sent in the view.\nThe "),t("code",{pre:!0},[e._v("#data")]),e._v(" variable represents the current context's view-model")])])]),t("li",[t("p",[t("code",{pre:!0},[e._v("inline")])]),t("blockquote",[t("p",[e._v("Optional.\nFlag that indicates to render the whole view without line return.\nUseful when you need to pass some HTML segments in a JavaScript string.")])])]),t("li",[t("p",[t("code",{pre:!0},[e._v("escape")])]),t("blockquote",[t("p",[e._v("Optional.\nWill escape the "),t("code",{pre:!0},[e._v("\\")]),e._v(" character.")])])])]),t("p",[e._v("It can be included in two different ways.\nIf the tag ends with a slash, such as the three "),t("code",{pre:!0},[e._v("include")]),e._v(" tags in the article, in the above example, the tag will be replaced by a rendered version of the view.\nHowever, if it has a closing tag, such as the "),t("code",{pre:!0},[e._v("components.grid.cell")]),e._v(" that wraps the content, the content inside the tag will be passed to the included view as the "),t("code",{pre:!0},[e._v("slot")]),e._v(".\nIt is very useful to extend views, such as the main layout, or for components that may receive content.")]),t("p",[e._v("If you are building a component that should accept content, the "),t("code",{pre:!0},[e._v("{{:slot}}")]),e._v(" statement can be used anywhere to insert the content.\nYou can even use this statement more than once if you need it.")]),t("h3",[e._v("Helpers")]),t("p",[e._v("A JSRender helper is a function that can be used anywhere in any template with the given syntax: "),t("code",{pre:!0},[e._v("~myHelper()")]),e._v(", prefixed by a tilde.\nThey act as functions that are defined by the JSRender view driver.")]),t("h4",[e._v("The "),t("em",[e._v("inject")]),e._v(" helper")]),t("p",[e._v("If you need, in any case, to get an injectable in your view, the "),t("code",{pre:!0},[e._v("inject")]),e._v(" helper may be very useful.\nIt acts the same way as "),t("code",{pre:!0},[e._v("app.make()")]),e._v(".")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-html"}},[e._v("{{if ~inject('app').environment === 'local'}}\n    "),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[e._v("<"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[e._v("p")]),e._v(">")]),e._v("You are in a local environment"),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[e._v("</"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[e._v("p")]),e._v(">")]),e._v("\n{{/if}}\n")])]),t("h4",[e._v("The "),t("em",[e._v("config")]),e._v(" helper")]),t("p",[e._v("Sometimes, the configuration is used by all templates.\nTo prevent sending the same view-model over and over again, you can quickly access the configuration from the "),t("code",{pre:!0},[e._v("config")]),e._v(" helper.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-html"}},[t("span",{pre:!0,attrs:{class:"hljs-tag"}},[e._v("<"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[e._v("p")]),e._v(">")]),e._v("Welcome to {{:~config('app.name')}}"),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[e._v("</"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[e._v("p")]),e._v(">")]),e._v("\n")])]),t("h4",[e._v("The "),t("em",[e._v("route")]),e._v(" helper")]),t("p",[e._v("Instead of inserting manual links in your views, the "),t("code",{pre:!0},[e._v("route")]),e._v(" helper may be used to resolve a route URL by name and parameters.")]),t("p",[e._v("Given the "),t("code",{pre:!0},[e._v("router.get('/foo/:bar','FooBarController@action').name('foo.bar')")]),e._v(" route, here is how we could use the "),t("code",{pre:!0},[e._v("route")]),e._v(" helper.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-html"}},[t("span",{pre:!0,attrs:{class:"hljs-tag"}},[e._v("<"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[e._v("a")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("href")]),e._v("="),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("\"{{:~route('foo.bar', { 'bar': 'the-bar-slug' })}}\"")]),e._v(">")]),e._v("Link to the bar"),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[e._v("</"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[e._v("a")]),e._v(">")]),e._v("\n")])]),t("p",[e._v("Notice that the parameters object keys are wrapped by quotes.\nIt is mandatory for JSRender.\nOtherwise, it is going to interpret the key as a variable, such as "),t("code",{pre:!0},[e._v("{ [bar]: 'the-bar-slug' }")]),e._v(" would normally do in JavaScript.")]),t("p",[e._v("The parameter object is optional.\nIt is only required if the route URI has parameters.")]),t("h4",[e._v("The "),t("em",[e._v("t")]),e._v(" helper")]),t("p",[e._v("The "),t("code",{pre:!0},[e._v("t")]),e._v(" helper stands for "),t("code",{pre:!0},[e._v("translate")]),e._v(".\nLots of framework use "),t("code",{pre:!0},[e._v("t()")]),e._v(", "),t("code",{pre:!0},[e._v("trans()")]),e._v(", "),t("code",{pre:!0},[e._v("__()")]),e._v(" and "),t("code",{pre:!0},[e._v("translate()")]),e._v(".\nThe choice of the "),t("code",{pre:!0},[e._v("t")]),e._v(" name was mainly for simplicity when translating content.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-html"}},[t("span",{pre:!0,attrs:{class:"hljs-tag"}},[e._v("<"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[e._v("p")]),e._v(">")]),e._v("{{:~t('This is some content that need to be translated')}}"),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[e._v("</"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[e._v("p")]),e._v(">")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[e._v("<"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[e._v("p")]),e._v(">")]),e._v("{{:~t('some.translation.key'}}"),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[e._v("</"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[e._v("p")]),e._v(">")]),e._v("\n")])]),t("h4",[e._v("The "),t("em",[e._v("dump")]),e._v(" helper")]),t("p",[e._v("In a controller, you can easily dump variables with the "),t("code",{pre:!0},[e._v("return this.dump(variable)")]),e._v(" statement.\nHowever, it may be very useful to dump data while rendering a template, because the context of a template differs a lot from a basic JavaScript class context.")]),t("p",[e._v("You can dump any value you want, anywhere you want.\nIt will simply inject a dump area in your view, without blocking the view rendering.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-html"}},[t("span",{pre:!0,attrs:{class:"hljs-tag"}},[e._v("<"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[e._v("div")]),e._v(">")]),e._v("\n{{for items}}\n    {{:~dump(#data)}}\n{{/for}}\n"),t("span",{pre:!0,attrs:{class:"hljs-tag"}},[e._v("</"),t("span",{pre:!0,attrs:{class:"hljs-name"}},[e._v("div")]),e._v(">")]),e._v("\n")])]),t("p",[e._v("In this example, for three items, there will be three dumping areas, each time containing the current item in the loop ("),t("code",{pre:!0},[e._v("#data")]),e._v(" is the context variable in JSRender, so it changes depending on the rendering scope)")])])}],n=t("2877"),o={},l=Object(n["a"])(o,a,r,!1,null,null,null);s["default"]=l.exports},b359:function(e,s,t){},bd84:function(e,s,t){"use strict";var a=t("1fc4"),r=t.n(a);r.a},bece:function(e,s,t){"use strict";t.r(s);var a=function(){var e=this,s=e.$createElement;e._self._c;return e._m(0)},r=[function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("section",[t("h1",[e._v("Helpers")]),t("h2",[e._v("Introduction")]),t("p",[e._v("Helpers are objects or functions that cannot be classified as services or any other kind.\nThey provide useful methods, shortcuts and common packages to make it easier to develop.\nThey normally don't contain any business or core logic, but might be useful to reuse certain pieces of code that would be considered generic.")]),t("p",[e._v("Node IoC offers four helpers, the "),t("code",{pre:!0},[e._v("helper.date")]),e._v(", "),t("code",{pre:!0},[e._v("helper.file")]),e._v(", "),t("code",{pre:!0},[e._v("helper.path")]),e._v(" and "),t("code",{pre:!0},[e._v("helper.string")]),e._v(".")]),t("h2",[e._v("The date helper")]),t("p",[e._v("The date helper is, in reality, a wrapper over "),t("a",{attrs:{href:"https://momentjs.com/"}},[e._v("'Moment.js")]),e._v(".\nThe "),t("code",{pre:!0},[e._v("helper.date")]),e._v(" simply returns the Moment function to create Moment instance.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("const")]),e._v(" dateHelper = app.make("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'helper.date'")]),e._v(");\n\ndateHelper().calendar(); "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v('// "Today at 1:23 PM"')]),e._v("\n")])]),t("p",[e._v("It also configures the global locale based on the application configuration.\nIf the "),t("code",{pre:!0},[e._v("app.locale")]),e._v(" is set to "),t("code",{pre:!0},[e._v("fr")]),e._v(", the result would be "),t("code",{pre:!0},[e._v("Aujourd'hui à 13:23")]),e._v(".")]),t("h2",[e._v("The file helper")]),t("p",[e._v("The file helper currently contains two methods to parse or humanize file size, through the "),t("a",{attrs:{href:"https://github.com/visionmedia/bytes.js"}},[t("code",{pre:!0},[e._v("bytes")])]),e._v(" package.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("const")]),e._v(" fileHelper = app.make("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'helper.file'")]),e._v(");\n\nfileHelper.formatSize("),t("span",{pre:!0,attrs:{class:"hljs-number"}},[e._v("1024")]),e._v("); "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v('// "1KB"')]),e._v("\nfileHelper.parseSize("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'1KB'")]),e._v("); "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("// 1024")]),e._v("\n")])]),t("h2",[e._v("The path helper")]),t("p",[e._v("The path helper wraps the core "),t("code",{pre:!0},[e._v("path")]),e._v(" module with "),t("a",{attrs:{href:"https://github.com/sindresorhus/slash"}},[t("code",{pre:!0},[e._v("slash")])]),e._v(" to ensure Windows and Unix the same and predictable behavior.\nAll "),t("code",{pre:!0},[e._v("path")]),e._v(" methods and properties are accessible through this helper.\nThis will allow you to use the "),t("code",{pre:!0},[e._v("path")]),e._v(" core module as an injectable, decorable instance.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("const")]),e._v(" pathHelper = app.make("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'helper.path'")]),e._v(");\n\npathHelper.join("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'foo'")]),e._v(", "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'bar'")]),e._v("); "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v('// "foo/bar", for both Windows and Unix')]),e._v("\npathHelper.slash("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'foo\\\\\\\\Bar'")]),e._v("); "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v('// "foo/bar"')]),e._v("\npathHelper.isAbsolute("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'/foo/bar'")]),e._v("); "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("// true")]),e._v("\npathHelper.isRelative("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'/foo/bar'")]),e._v("); "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("// false")]),e._v("\n")])]),t("h2",[e._v("The string helper")]),t("p",[e._v("The string helper exposes the "),t("a",{attrs:{href:"https://github.com/ianstormtaylor/to-case"}},[t("code",{pre:!0},[e._v("to-case")])]),e._v(" and "),t("a",{attrs:{href:"https://github.com/blakeembrey/pluralize"}},[t("code",{pre:!0},[e._v("pluralize")])]),e._v(" features.\nYou can use all the "),t("code",{pre:!0},[e._v("to-case")]),e._v(" methods, as well as "),t("code",{pre:!0},[e._v("plural(string, count)")]),e._v(" and "),t("code",{pre:!0},[e._v("singular(string)")]),e._v(".")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("const")]),e._v(" stringHelper = app.make("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'helper.string'")]),e._v(");\n\nstringHelper.slug("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'fooBarBaz'")]),e._v("); "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v('// "foo-bar-baz"')]),e._v("\nstringHelper.dot("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'fooBarBaz'")]),e._v(");  "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v('// "foo.bar.baz"')]),e._v("\nstringHelper.add("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'reverse'")]),e._v(", (string) => {\n    "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" string.split("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("''")]),e._v(").reverse().join("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("''")]),e._v(");\n});\nstringHelper.reverse("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'lorem'")]),e._v("); "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v('// "merol"')]),e._v("\n")])])])}],n=t("2877"),o={},l=Object(n["a"])(o,a,r,!1,null,null,null);s["default"]=l.exports},c674:function(e,s,t){},c9b9:function(e,s,t){"use strict";t.r(s);var a=function(){var e=this,s=e.$createElement;e._self._c;return e._m(0)},r=[function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("section",[t("h1",[e._v("Commands")]),t("h2",[e._v("Introduction")]),t("p",[e._v("Tests are a key point when it comes to maintain and scale applications.\nNode IoC kept that in mind all the way from the start to make extensions and applications easy to test.")]),t("p",[e._v("There is an out-of-the-box command that allows testing the application, which is called "),t("code",{pre:!0},[e._v("test")]),e._v(".\nIt runs tests from classes instead of callbacks for more scalability and verbosity, with a PHPUnit lookalike architecture.")]),t("p",[e._v("Paired with this enhanced testing system, the "),t("code",{pre:!0},[e._v("@absolunet/tester")]),e._v(" package will wrap Node IoC tests within NPM commands to test both the features and the logic, as well as the code itself.\nIt comes by default with a folder validator ("),t("code",{pre:!0},[e._v("package.json")]),e._v(" content, "),t("code",{pre:!0},[e._v("CHANGELOG.md")]),e._v(" structure, CI files such as "),t("code",{pre:!0},[e._v(".travis.yml")]),e._v(" and "),t("code",{pre:!0},[e._v("bitbucket-pipelines.yml")]),e._v(", etc.) and the power of "),t("code",{pre:!0},[e._v("ESLint")]),e._v(" for the best code quality.")]),t("p",[e._v("All those tests are powered by "),t("a",{attrs:{href:"https://jestjs.io/"}},[t("code",{pre:!0},[e._v("Jest")])]),e._v(", developed by Facebook.\nAs always, you can implement your own test engine, such as Ava or Jasmine, but Jest is the recommended one here.")]),t("p",[e._v("However, all the "),t("code",{pre:!0},[e._v("@absolunet/tester")]),e._v(" tests are driven by Jest, without any possible configuration to change the engine.")]),t("h2",[e._v("NPM commands")]),t("p",[e._v("By default, it is strongly recommended using the given NPM commands to run tests, since the "),t("code",{pre:!0},[e._v("@absolunet/tester")]),e._v(" package will properly handle it.")]),t("p",[e._v("Your "),t("code",{pre:!0},[e._v("package.json")]),e._v(" file should contain those scripts:")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-json"}},[e._v("{\n  "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v('"scripts"')]),e._v(": {\n    "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v('"test"')]),e._v(": "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v('"node test --scope=all"')]),e._v(",\n    "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v('"test:standards"')]),e._v(": "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v('"node test --scope=standards"')]),e._v(",\n    "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v('"test:unit"')]),e._v(": "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v('"node test --scope=unit"')]),e._v(",\n    "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v('"test:feature"')]),e._v(": "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v('"node test --scope=feature"')]),e._v(",\n    "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v('"test:integration"')]),e._v(": "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v('"node test --scope=integration"')]),e._v(",\n    "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v('"test:endtoend"')]),e._v(": "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v('"node test --scope=endtoend"')]),e._v("\n  }\n}\n")])]),t("p",[e._v("As you can see, it simply runs the "),t("code",{pre:!0},[e._v("test/index.js")]),e._v(" file with a "),t("code",{pre:!0},[e._v("scope")]),e._v(" option.\nThis command will then be handled by the Node Tester package.")]),t("p",[e._v("The standards tests will be handled by the Node Tester, while all the other tests will be handled by Node IoC.")]),t("p",[e._v("Of course, "),t("code",{pre:!0},[e._v("npm test")]),e._v(" will run all tests.")]),t("h2",[e._v("The test command")]),t("p",[e._v("The "),t("code",{pre:!0},[e._v("test")]),e._v(" command is used to bootstrap all the application tests and run them with the configured engine, with a high-level abstraction over the engine implementation.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-bash"}},[e._v("node ioc "),t("span",{pre:!0,attrs:{class:"hljs-built_in"}},[e._v("test")]),e._v("\n")])]),t("p",[e._v("You can run all tests in your application with this simple command.\nYou can also scope your tests by type.\nBy default, four types are supported: "),t("code",{pre:!0},[e._v("unit")]),e._v(", "),t("code",{pre:!0},[e._v("feature")]),e._v(", "),t("code",{pre:!0},[e._v("endtoend")]),e._v(" and "),t("code",{pre:!0},[e._v("integration")]),e._v(".\nEach one of them is represented by a folder in the "),t("code",{pre:!0},[e._v("test")]),e._v(" folder.")]),t("p",[e._v("To run a single folder, you can use a flag representing the folder, or the "),t("code",{pre:!0},[e._v("type")]),e._v(" option.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-bash"}},[e._v("node ioc "),t("span",{pre:!0,attrs:{class:"hljs-built_in"}},[e._v("test")]),e._v(" --unit\nnode ioc "),t("span",{pre:!0,attrs:{class:"hljs-built_in"}},[e._v("test")]),e._v(" --"),t("span",{pre:!0,attrs:{class:"hljs-built_in"}},[e._v("type")]),e._v("=unit\n")])]),t("p",[e._v("You can also pass "),t("code",{pre:!0},[e._v("--type=all")]),e._v(" as an option.\nThis is the default behavior.")]),t("h2",[e._v("The make:test command")]),t("p",[e._v("To quickly scaffold a test class, the "),t("code",{pre:!0},[e._v("make:test")]),e._v(" is perfect.\nIt also allows you to create the wanted test in the proper folder.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-bash"}},[e._v("node ioc make:"),t("span",{pre:!0,attrs:{class:"hljs-built_in"}},[e._v("test")]),e._v(" MyClassTest\nnode ioc make:"),t("span",{pre:!0,attrs:{class:"hljs-built_in"}},[e._v("test")]),e._v(" MyClassFeatureTest --feature\n")])]),t("p",[e._v("The first command will create "),t("code",{pre:!0},[e._v("MyClassTest.js")]),e._v(" in the "),t("code",{pre:!0},[e._v("test/unit")]),e._v(" folder.\nThe second one, more explicitly, will create "),t("code",{pre:!0},[e._v("MyClassFeatureTest.js")]),e._v(" in the "),t("code",{pre:!0},[e._v("test/feature")]),e._v(" folder.")]),t("p",[e._v("You can also scope the test file by the class it's supposed to test.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-bash"}},[e._v("node ioc make:"),t("span",{pre:!0,attrs:{class:"hljs-built_in"}},[e._v("test")]),e._v(" CreatePostTest --"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("for")]),e._v("=services/PostService --feature\n")])]),t("p",[e._v("This will create the "),t("code",{pre:!0},[e._v("CreatePostTest.js")]),e._v(" file in a scoped folder for the "),t("code",{pre:!0},[e._v("services/PostService")]),e._v(" class, as a feature test.\nIts destination will then be "),t("code",{pre:!0},[e._v("test/feature/services/PostService/CreatePostTest.js")]),e._v(".\nThis will help you create tests and keep them structured over time.")])])}],n=t("2877"),o={},l=Object(n["a"])(o,a,r,!1,null,null,null);s["default"]=l.exports},cdef:function(e,s,t){"use strict";t.r(s);var a=function(){var e=this,s=e.$createElement;e._self._c;return e._m(0)},r=[function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("section",[t("h1",[e._v("Exception handling")]),t("h2",[e._v("Introduction")]),t("p",[e._v("To properly handle exceptions across the different contexts, such as CLI, Web and API requests, Node IoC made an exception handler that handles all those cases the proper way, besides logging the exceptions through the logger.")]),t("p",[e._v("The bound exception handler is located in a Node IoC application.\nIt extends the framework's exception handler, so you can easily interact before or after different handling phases or completely override some handling phases.")]),t("h2",[e._v("Lifecycle")]),t("p",[e._v("In the lifecycle, the exception handler is used in three places: for the "),t("code",{pre:!0},[e._v("unhandledRejection")]),e._v(" event, the "),t("code",{pre:!0},[e._v("uncaughtException")]),e._v(" event and when catching an error that occurs during kernel handling.\nYou can find the exception handling in the "),t("code",{pre:!0},[e._v("src/bootstrap/lifecycle.js")]),e._v(" file.")]),t("p",[e._v("The exception handler is also used in two places: the command runner and the HTTP handler.")]),t("p",[e._v("Since a CLI request is handled by Yargs under the hood, we want to skip its error handler, which is not behaving the best possible way for Node IoC.\nIt overrides the Yargs exception handling by catching an error from within the handling process, so Yargs never notice it.\nWe then properly handle it, so the kernel can properly terminate the request.")]),t("p",[e._v("For the HTTP exception handling, we cannot rely on the global kernel error catching since the whole process is trapped by Express to prevent unexpected exits.\nThe same thing happens here: the application's exception handler is called when an HTTP request error occurs, so the HTTP handler properly terminates the request.")]),t("h2",[e._v("The handle method")]),t("p",[e._v("The "),t("code",{pre:!0},[e._v("handle")]),e._v(" report is the one that should be called when an exception occurs.\nBy default, it stops the terminal interceptor capture to prevent a muted console, and to prevent unexpected console behavior.\nThen, it reports the exception through the "),t("code",{pre:!0},[e._v("report")]),e._v(" method, and then render the exception through the "),t("code",{pre:!0},[e._v("render")]),e._v(" method.")]),t("p",[e._v("When an exception is handled, it keeps the exception in memory.\nIt will then affect the "),t("code",{pre:!0},[e._v("hadException")]),e._v(" and "),t("code",{pre:!0},[e._v("lastException")]),e._v(" accessors.")]),t("h2",[e._v("The report method")]),t("p",[e._v("This method uses the logger service ("),t("code",{pre:!0},[e._v("log")]),e._v("), if bound in the application, and reports the exception as an "),t("code",{pre:!0},[e._v("error")]),e._v(".\nIf an error occurs while reporting, the reported error is rendered in the console, and the report does not occur.")]),t("h2",[e._v("The render method")]),t("p",[e._v("The "),t("code",{pre:!0},[e._v("render")]),e._v(" method simply chose between the "),t("code",{pre:!0},[e._v("renderResponse")]),e._v(" and "),t("code",{pre:!0},[e._v("renderConsole")]),e._v(" by checking the received "),t("code",{pre:!0},[e._v("response")]),e._v(" object.\nTo render a response, the "),t("code",{pre:!0},[e._v("response")]),e._v(" object must be truthy and expose the "),t("code",{pre:!0},[e._v("write")]),e._v(", "),t("code",{pre:!0},[e._v("json")]),e._v(" and "),t("code",{pre:!0},[e._v("status")]),e._v(" methods.")]),t("h3",[e._v("Render in console")]),t("p",[e._v("When rendering in the console, the exception handler uses the "),t("code",{pre:!0},[e._v("console")]),e._v(" driver.\nBy default, the "),t("code",{pre:!0},[e._v("console")]),e._v(" driver is the "),t("code",{pre:!0},[e._v("prettyError")]),e._v(" driver, which uses the "),t("code",{pre:!0},[e._v("terminal")]),e._v(" service to echo the formatted error.")]),t("p",[e._v("The formatting is handled by the "),t("a",{attrs:{href:"https://github.com/AriaMinaei/pretty-error"}},[t("code",{pre:!0},[e._v("pretty-error")])]),e._v(" package.\nThe style from the "),t("code",{pre:!0},[e._v("terminal")]),e._v(" service is automatically transferred to the "),t("code",{pre:!0},[e._v("pretty-error")]),e._v(" instance.")]),t("h3",[e._v("Render in HTTP response")]),t("p",[e._v("When rendering in the HTTP response, it starts by setting the response status based on the thrown exception.\nBy default, the "),t("code",{pre:!0},[e._v("500 Internal Server Error.")]),e._v(" status is sent if no "),t("code",{pre:!0},[e._v("status")]),e._v(" property was provided in the exception instance.\nThe status must be an integer, such as "),t("code",{pre:!0},[e._v("404")]),e._v(".")]),t("p",[e._v("Then, the "),t("code",{pre:!0},[e._v("app.debug")]),e._v(" configuration value is checked to use the most appropriate driver.\nIf set to "),t("code",{pre:!0},[e._v("true")]),e._v(", the "),t("code",{pre:!0},[e._v("http.debug")]),e._v(" driver is used, aliased by the "),t("code",{pre:!0},[e._v("ouch")]),e._v(" driver.\nThis driver uses the "),t("a",{attrs:{href:"https://github.com/quorrajs/Ouch"}},[t("code",{pre:!0},[e._v("ouch")])]),e._v(" package, which is similar to the popular PHP's "),t("a",{attrs:{href:"https://github.com/filp/whoops"}},[e._v("Whoops")]),e._v(" package.\nOtherwise, the "),t("code",{pre:!0},[e._v("http.production")]),e._v(" driver is used, aliased by the "),t("code",{pre:!0},[e._v("view")]),e._v(" driver.")]),t("h4",[e._v("HTML response")]),t("p",[e._v("When rendering HTML response, the Ouch's PrettyPageHandler is used to render the page, with the blue theme.")]),t("p",[e._v("To enhance your development experience, Ouch supports IDE links from the stack files.\nYou must, however, specify your own IDE in the "),t("code",{pre:!0},[e._v("dev.ide")]),e._v(" configuration.")]),t("h4",[e._v("JSON response")]),t("p",[e._v("If the request accepts "),t("code",{pre:!0},[e._v("application/json")]),e._v(" or contains the "),t("code",{pre:!0},[e._v("x-requested-with: xmlhtttprequest")]),e._v(" header (case-insensitive), the response will be formatted as JSON instead.\nThe Ouch's JsonResponseHandler is then used to process the JSON response.")]),t("p",[e._v("The schema will look like this.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-json"}},[e._v("{\n  "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v('"error"')]),e._v(": {\n    "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v('"file"')]),e._v(": "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v('"/path/to/error/File.js"')]),e._v(",\n    "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v('"line"')]),e._v(": "),t("span",{pre:!0,attrs:{class:"hljs-number"}},[e._v("123")]),e._v(",\n    "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v('"message"')]),e._v(": "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v('"Internal Server Error."')]),e._v(",\n    "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v('"trace"')]),e._v(": [\n      {\n        "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v('"class"')]),e._v(": "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v('"File"')]),e._v(",\n        "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v('"file"')]),e._v(": "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v('"/path/to/error/File.js"')]),e._v(",\n        "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v('"function"')]),e._v(": "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v('"methodThatThrows"')]),e._v(",\n        "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v('"line"')]),e._v(": "),t("span",{pre:!0,attrs:{class:"hljs-number"}},[e._v("123")]),e._v("\n      },\n      {\n        "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v('"class"')]),e._v(": "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v('"File"')]),e._v(",\n        "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v('"file"')]),e._v(": "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v('"/path/to/error/File.js"')]),e._v(",\n        "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v('"function"')]),e._v(": "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v('"callMethodThatThrows"')]),e._v(",\n        "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v('"line"')]),e._v(": "),t("span",{pre:!0,attrs:{class:"hljs-number"}},[e._v("98")]),e._v("\n      }\n    ],\n    "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v('"type"')]),e._v(": "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v('"TypeError"')]),e._v("\n  }\n}\n")])]),t("h2",[e._v("Handle error in production")]),t("p",[e._v("When in production, errors must be well handled to prevent unexpected rendered pages or data.")]),t("p",[e._v("Console errors remain the same since we can normally assume that a developer will use the CLI, or will handle the error if using it through an application of his own.")]),t("p",[e._v("However, HTTP errors must be well handled for users, without stack trace or frames.\nHTML response can be easily customized through the "),t("code",{pre:!0},[e._v("errors")]),e._v(" views.")]),t("p",[e._v("By default, the application offers the "),t("code",{pre:!0},[e._v("resources/view/errors/base.html")]),e._v(" template that you can extend to display custom error pages.\nThe HTTP status code is used to render the appropriate view.\nFor instance, a "),t("code",{pre:!0},[e._v("404 Not Found.")]),e._v(" error will attempt to render the "),t("code",{pre:!0},[e._v("errors.404")]),e._v(" view.\nThe "),t("code",{pre:!0},[e._v("errors.generic")]),e._v(" view is used by default if the current error code cannot be found.\nIf the "),t("code",{pre:!0},[e._v("errors.generic")]),e._v(" view cannot be found, a simple "),t("code",{pre:!0},[e._v("Something went wrong...")]),e._v(" text is rendered.\nIf the "),t("code",{pre:!0},[e._v("translator")]),e._v(" service is available, it will use it to translate the default text, such as "),t("code",{pre:!0},[e._v("Quelque chose a mal tourné...")]),e._v(" in french.")])])}],n=t("2877"),o={},l=Object(n["a"])(o,a,r,!1,null,null,null);s["default"]=l.exports},cecb:function(e,s,t){"use strict";var a=t("b359"),r=t.n(a);r.a},d13c:function(e,s,t){"use strict";t.r(s);var a=function(){var e=this,s=e.$createElement;e._self._c;return e._m(0)},r=[function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("section",[t("h1",[e._v("Multiple inheritances")]),t("h2",[e._v("Introduction")]),t("p",[e._v("Inheritance in JavaScript allows us to extend a class or to modify the prototype object of an instance.\nBy default, it does not allow multiple inheritances, unlike some Object-Oriented languages such as C++.\nHowever, Node IoC offers a simple way to define mixins, a simple way to add some features in a class.\nThey act somehow like traits in PHP.\nWe will take a look at how they work, the existing mixins and how to define one.")]),t("h2",[e._v("Mixin pattern")]),t("p",[e._v("A mixin is a function that accepts an optional class as its only argument.\nIt returns another class that extends the given one, or a plain class by default if no parent class is provided.\nYou can then extend this new class without any problem.\nWith this in mind, it must be understood that "),t("code",{pre:!0},[e._v("A extends someMixin(B)")]),e._v(" results in "),t("code",{pre:!0},[e._v("A extends SomeClass")]),e._v(" and "),t("code",{pre:!0},[e._v("SomeClass extends B")]),e._v(".")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("import")]),e._v(" { mixins } "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("from")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'@absolunet/ioc'")]),e._v(";\n\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("const")]),e._v(" { hasDriver } = mixins;\n\n\n"),t("span",{pre:!0,attrs:{class:"hljs-class"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("class")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("MyService")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("extends")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("hasDriver")]),e._v("() ")]),e._v("{\n\n}\n")])]),t("p",[e._v("In this example, "),t("code",{pre:!0},[e._v("MyService")]),e._v(" class extends a dynamic class called "),t("code",{pre:!0},[e._v("HasDriverMixin")]),e._v(".\nAfter this dynamic call, "),t("code",{pre:!0},[e._v("MyService")]),e._v(" has some methods offered by the mixin.")]),t("ul",[t("li",[t("code",{pre:!0},[e._v("driver(name, parameters = {})")])]),t("li",[t("code",{pre:!0},[e._v("addDriver(name, driver)")])]),t("li",[t("code",{pre:!0},[e._v("setDefaultDriver(name)")])]),t("li",[t("code",{pre:!0},[e._v("setDriverAlias(name, alias)")])]),t("li",[t("code",{pre:!0},[e._v("hasDriver(name)")])]),t("li",[t("code",{pre:!0},[e._v("isDriverAlias(name)")])])]),t("p",[e._v('However, this mixin alone does nothing special.\nIt simply creates a dynamic class that you could have made "static".\nThe interesting thing happens when extending another class, but by still using the mixin.')]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-class"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("class")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("MyService")]),e._v(" ")]),e._v("{\n\n    doSomething() {\n        "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("//")]),e._v("\n    }\n\n}\n\n\n"),t("span",{pre:!0,attrs:{class:"hljs-class"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("class")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("MySpecialService")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("extends")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("hasDriver")]),e._v("("),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("MyService")]),e._v(") ")]),e._v("{\n\n}\n")])]),t("p",[e._v("In this scenario, "),t("code",{pre:!0},[e._v("MySpecialService")]),e._v(" inherit from "),t("code",{pre:!0},[e._v("HasDriverMixin")]),e._v(", but the mixin returns a class that extends "),t("code",{pre:!0},[e._v("MyService")]),e._v(".\nThen, "),t("code",{pre:!0},[e._v("MySpecialService")]),e._v(" inherits from both "),t("code",{pre:!0},[e._v("HasDriverMixin")]),e._v(" and "),t("code",{pre:!0},[e._v("MyService")]),e._v(".")]),t("p",[e._v("We can go further and use two mixins with a base class at the same time.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-class"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("class")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("MySpecialService")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("extends")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("hasDriver")]),e._v("("),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("forwardsCalls")]),e._v("("),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("MyService")]),e._v(")) ")]),e._v("{\n\n}\n")])]),t("h2",[e._v("Existing mixins")]),t("p",[e._v("There are five available mixins that are used across framework classes:")]),t("ul",[t("li",[t("code",{pre:!0},[e._v("checksTypes")])]),t("li",[t("code",{pre:!0},[e._v("forwardsCalls")])]),t("li",[t("code",{pre:!0},[e._v("getsMethods")])]),t("li",[t("code",{pre:!0},[e._v("hasDriver")])]),t("li",[t("code",{pre:!0},[e._v("hasEngine")])])]),t("p",[e._v("All of these mixins are available in the "),t("code",{pre:!0},[e._v("mixins")]),e._v(" exported value.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("import")]),e._v(" { mixins } "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("from")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'@absolunet/ioc'")]),e._v(";\n\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("const")]),e._v(" {\n    checksTypes,\n    forwardsCalls,\n    getsMethods,\n    hasDriver,\n    hasEngine\n} = mixins;\n")])]),t("h3",[e._v("checksTypes")]),t("p",[e._v("The "),t("code",{pre:!0},[e._v("checksTypes")]),e._v(" mixin exposes four methods that help to validate types.")]),t("ul",[t("li",[t("p",[t("code",{pre:!0},[e._v("isInstantiable(object)")])]),t("blockquote",[t("p",[e._v("Returns "),t("code",{pre:!0},[e._v("true")]),e._v(" if the given argument can be called with the "),t("code",{pre:!0},[e._v("new")]),e._v(" keyword")])])]),t("li",[t("p",[t("code",{pre:!0},[e._v("isFunction(object)")])]),t("blockquote",[t("p",[e._v("Returns "),t("code",{pre:!0},[e._v("true")]),e._v(" if the given argument is a regular or arrow function")])])]),t("li",[t("p",[t("code",{pre:!0},[e._v("isObject(object)")])]),t("blockquote",[t("p",[e._v("Returns "),t("code",{pre:!0},[e._v("true")]),e._v(" if the given argument is a non-null object")])])]),t("li",[t("p",[t("code",{pre:!0},[e._v("methodExists(method)")])]),t("blockquote",[t("p",[e._v("Returns "),t("code",{pre:!0},[e._v("true")]),e._v(" if the given method name exists in the current instance")])])])]),t("h3",[e._v("forwardsCalls")]),t("p",[e._v("The "),t("code",{pre:!0},[e._v("forwardsCalls")]),e._v(" mixin exposes a single method, and declare an abstract method that must be implemented.")]),t("ul",[t("li",[t("p",[t("code",{pre:!0},[e._v("forwardCall(method, parameters = [])")])]),t("blockquote",[t("p",[e._v("Call the given method on the forward instance with the given parameters as arguments.")])])]),t("li",[t("p",[t("code",{pre:!0},[e._v("getForward()")])]),t("blockquote",[t("p",[t("em",[e._v("Abstract")]),e._v(" method that must be implemented.\nShould return an object on which the call should be forwarded.")])])])]),t("h3",[e._v("getsMethods")]),t("p",[e._v("The "),t("code",{pre:!0},[e._v("getsMethods")]),e._v(" mixin exposes a single method.")]),t("ul",[t("li",[t("code",{pre:!0},[e._v("getMethods(instance)")]),t("blockquote",[t("p",[e._v("Returns a list of all available methods in the given instance, including instance methods, prototype methods, and inherited methods, sorted alphabetically.")])])])]),t("h3",[e._v("hasDriver")]),t("p",[e._v("The "),t("code",{pre:!0},[e._v("hasDriver")]),e._v(" mixin exposes all the necessary features to use drivers.")]),t("ul",[t("li",[t("p",[t("code",{pre:!0},[e._v("driver(name = 'default', parameters = {})")])]),t("blockquote",[t("p",[e._v("Returns the driver instance by name, made by the container with the given parameters.")])])]),t("li",[t("p",[t("code",{pre:!0},[e._v("bootDriver(driver, name)")])]),t("blockquote",[t("p",[e._v("Method that can be overridden to boot a driver.\nReturns the booted driver.")])])]),t("li",[t("p",[t("code",{pre:!0},[e._v("addDriver(name, driver)")])]),t("blockquote",[t("p",[e._v("Add a driver instance or class with a name that acts as a unique identifier.")])])]),t("li",[t("p",[t("code",{pre:!0},[e._v("setDefaultDriver(name)")])]),t("blockquote",[t("p",[e._v('Set default driver by name.\nThe driver will then be aliased as "default"')])])]),t("li",[t("p",[t("code",{pre:!0},[e._v("setDriverAlias(name, alias)")])]),t("blockquote",[t("p",[e._v("Set a driver's alias, so it can be resolved with both names.")])])]),t("li",[t("p",[t("code",{pre:!0},[e._v("hasDriver(name)")])]),t("blockquote",[t("p",[e._v("Returns "),t("code",{pre:!0},[e._v("true")]),e._v(" if the driver exists or is an alias.")])])]),t("li",[t("p",[t("code",{pre:!0},[e._v("isDriverAlias(name)")])]),t("blockquote",[t("p",[e._v("Returns "),t("code",{pre:!0},[e._v("true")]),e._v(" if the driver is an alias.")])])])]),t("h3",[e._v("hasEngine")]),t("p",[e._v("The "),t("code",{pre:!0},[e._v("hasEngine")]),e._v(" mixin exposes a single method, paired with an accessor.")]),t("ul",[t("li",[t("p",[t("code",{pre:!0},[e._v("setEngine(engine)")])]),t("blockquote",[t("p",[e._v("Set the current engine")])])]),t("li",[t("p",[t("code",{pre:!0},[e._v("get engine()")])]),t("blockquote",[t("p",[e._v("Current engine accessor.")])])])]),t("h2",[e._v("Define mixin")]),t("p",[e._v("To define a new mixin, the "),t("code",{pre:!0},[e._v("mixins")]),e._v(" exposed object from Node IoC contains a "),t("code",{pre:!0},[e._v("factory")]),e._v(" function, for standalone mixins, and "),t("code",{pre:!0},[e._v("add")]),e._v(" function, for registered and reusable mixins.")]),t("p",[e._v("The "),t("code",{pre:!0},[e._v("add")]),e._v(" method accepts a name, and a factory function, while "),t("code",{pre:!0},[e._v("factory")]),e._v(" only accepts a factory function.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("// Reusable mixin")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("import")]),e._v(" __         "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("from")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'@absolunet/private-registry'")]),e._v(";\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("import")]),e._v(" { mixins } "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("from")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'@absolunet/ioc'")]),e._v(";\n\n\nmixins.add("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'hasUser'")]),e._v(", (SuperClass) => {\n    "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-class"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("class")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("HasUserMixin")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("extends")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("SuperClass")]),e._v(" ")]),e._v("{\n    \n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("static")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("get")]),e._v(" dependencies() {\n            "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" ("),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("super")]),e._v(".dependencies || []).concat(["),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'event'")]),e._v("]);\n        }\n\n        init() {\n            "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("if")]),e._v(" ("),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("super")]),e._v(".init) {\n                "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("super")]),e._v(".init();\n            }\n\n            "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".setUser("),t("span",{pre:!0,attrs:{class:"hljs-literal"}},[e._v("null")]),e._v(");\n        }\n\n        getUser() {\n            "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" __("),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(").get("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'user'")]),e._v(");\n        }\n\n        setUser(user) {\n        \t__("),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(").set("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'user'")]),e._v(", user);\n            "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".event.emit("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("`user."),t("span",{pre:!0,attrs:{class:"hljs-subst"}},[e._v("${user ? "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'set'")]),e._v(" : "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'unset'")]),e._v("}")]),e._v("`")]),e._v(", { user });\n\n            "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(";\n        }\n\n    }\n});\n\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("const")]),e._v(" { hasUser } = mixins;\nhasUser(); "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("// HasUserMixin {}")]),e._v("\n")])]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("// Standalone mixin")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("import")]),e._v(" __         "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("from")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'@absolunet/private-registry'")]),e._v(";\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("import")]),e._v(" { mixins } "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("from")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'@absolunet/ioc'")]),e._v(";\n\n\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("export")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("default")]),e._v(" mixins.factory("),t("span",{pre:!0,attrs:{class:"hljs-function"}},[e._v("("),t("span",{pre:!0,attrs:{class:"hljs-params"}},[e._v("SuperClass")]),e._v(") =>")]),e._v(" {\n    "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-class"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("class")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("HasUserMixin")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("extends")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("SuperClass")]),e._v(" ")]),e._v("{\n    \n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("static")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("get")]),e._v(" dependencies() {\n            "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" ("),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("super")]),e._v(".dependencies || []).concat(["),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'event'")]),e._v("]);\n        }\n\n        init() {\n            "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("if")]),e._v(" ("),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("super")]),e._v(".init) {\n                "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("super")]),e._v(".init();\n            }\n\n            "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".setUser("),t("span",{pre:!0,attrs:{class:"hljs-literal"}},[e._v("null")]),e._v(");\n        }\n\n        getUser() {\n            "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" __("),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(").get("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'user'")]),e._v(");\n        }\n\n        setUser(user) {\n        \t__("),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(").set("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'user'")]),e._v(", user);\n            "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".event.emit("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("`user."),t("span",{pre:!0,attrs:{class:"hljs-subst"}},[e._v("${user ? "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'set'")]),e._v(" : "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'unset'")]),e._v("}")]),e._v("`")]),e._v(", { user });\n\n            "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(";\n        }\n\n    }\n});\n\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("const")]),e._v(" { hasUser } = mixins; "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("// undefined;")]),e._v("\n")])]),t("p",[e._v("The callback will always receive a "),t("code",{pre:!0},[e._v("SuperClass")]),e._v(".\nIt can be a class that is passed in parameter or a plain empty class.")]),t("p",[e._v("Notice that, when implementing the "),t("code",{pre:!0},[e._v("init")]),e._v(" method, we attempt to initialize the parent, if it implements the "),t("code",{pre:!0},[e._v("init")]),e._v(" method too.\nAlso, we inject the "),t("code",{pre:!0},[e._v("event")]),e._v(" dispatcher.\nHowever, the parent class may also inject services.\nWe must ensure that its dependencies are resolved and in the same order.\nThat is the reason why the current class dependencies are appended instead of prepended.")]),t("p",[e._v("This is one of the few items that cannot be injected by Node IoC since it allows us to change an exported value that can be used for further definitions.")]),t("p",[e._v("If you want to create mixins, they should be done before loading any classes.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("// [your Node IoC application/src/bootstrap/index.js")]),e._v("\n\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("import")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'./mixins'")]),e._v(";\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("import")]),e._v(" handlers  "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("from")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'./handlers'")]),e._v(";\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("import")]),e._v(" lifecycle "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("from")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'./lifecycle'")]),e._v(";\n\n"),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("/* ... */")]),e._v("\n")])]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("// [your Node IoC extension]/src/index.js")]),e._v("\n\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("import")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'./mixins'")]),e._v(";\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("import")]),e._v(" ExtensionServiceProvider "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("from")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'./ExtensionServiceProvider'")]),e._v(";\n\n\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("export")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("default")]),e._v(" ExtensionServiceProvider;\n")])])])}],n=t("2877"),o={},l=Object(n["a"])(o,a,r,!1,null,null,null);s["default"]=l.exports},d703:function(e,s,t){},d74c:function(e,s,t){"use strict";t.r(s);var a=function(){var e=this,s=e.$createElement;e._self._c;return e._m(0)},r=[function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("section",[t("h1",[e._v("Create an API endpoint")]),t("h2",[e._v("Introduction")]),t("p",[e._v("In this third assignment, we will build an API endpoint.\nThis time, we will use the configuration repository to emulate data.")]),t("p",[e._v("This tutorial will show you how to build a basic CRUD API application to manage a classic TODO list, with the "),t("code",{pre:!0},[e._v("index")]),e._v(", "),t("code",{pre:!0},[e._v("store")]),e._v(", "),t("code",{pre:!0},[e._v("show")]),e._v(", "),t("code",{pre:!0},[e._v("update")]),e._v(" and "),t("code",{pre:!0},[e._v("destroy")]),e._v(" action.")]),t("p",[e._v("Here are the key concepts that will be part of this tutorial:")]),t("ul",[t("li",[e._v("The "),t("code",{pre:!0},[e._v("serve")]),e._v(" command")]),t("li",[e._v("The "),t("code",{pre:!0},[e._v("router")]),e._v(" service (through the routes file, and a view helper function)")]),t("li",[e._v("The API routes file")]),t("li",[e._v("The "),t("code",{pre:!0},[e._v("Controller")]),e._v(" class")]),t("li",[e._v("Scaffolding controller with "),t("code",{pre:!0},[e._v("make:controller")])]),t("li",[e._v("The controller folder notation")]),t("li",[e._v("The "),t("code",{pre:!0},[e._v("config")]),e._v(" repository")]),t("li",[e._v("The "),t("code",{pre:!0},[e._v("validator")]),e._v(" service")])]),t("h2",[e._v("Launch the server")]),t("p",[e._v("First, we need to start a server.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-bash"}},[e._v("node ioc serve\n")])]),t("p",[e._v("This will start a new server process over port "),t("code",{pre:!0},[e._v("8080")]),e._v(".\nTry accessing "),t("a",{attrs:{href:""}},[e._v("http://localhost:8080")]),e._v(".\nYou should see the default Web welcome page.\nIf you need to change the port, use the "),t("code",{pre:!0},[e._v("--port=8080")]),e._v(" option, with the wanted port.")]),t("p",[e._v("To develop faster, Node IoC provides a daemon feature that will relaunch the server on file change.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-bash"}},[e._v("node ioc serve --daemon\n")])]),t("p",[e._v("Once the server has started, we can, in another terminal, run the Node Manager "),t("code",{pre:!0},[e._v("watch")]),e._v(" command.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-bash"}},[e._v("npm run manager:watch\n")])]),t("p",[e._v("Now, we are ready to create our first Web page!")]),t("h2",[e._v("Create the index route")]),t("p",[e._v("Then, we need our API routes.\nThey are located in the "),t("code",{pre:!0},[e._v("src/routes/api.js")]),e._v(" file.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("export")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("default")]),e._v(" (router) => {\n    "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("// The original comments were stripped out for easier readability.")]),e._v("\n\n    router.get("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'/app'")]),e._v(", "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'AppController@index'")]),e._v(").name("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'app.index'")]),e._v(");\n};\n")])]),t("p",[e._v("It's important to notice that the key difference between this file and the "),t("code",{pre:!0},[e._v("web.js")]),e._v(" routes file is that all the routes in the "),t("code",{pre:!0},[e._v("api.js")]),e._v(" file are prefixed by "),t("code",{pre:!0},[e._v("/api")]),e._v(" by default.\nSo, the "),t("code",{pre:!0},[e._v("/app")]),e._v(" route here is, in fact, a route that matches "),t("code",{pre:!0},[e._v("/api/app")]),e._v(" URL.")]),t("p",[e._v("Let's add our first custom route.\nIt should point to "),t("code",{pre:!0},[e._v("/todo")]),e._v(".")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("export")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("default")]),e._v(" (router) => {\n    router.get("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'/app'")]),e._v(", "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'AppController@index'")]),e._v(").name("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'app.index'")]),e._v(");\n\n    router.get("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'/todo'")]),e._v(", (request, response) => {\n        response.send("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'My first API endpoint'")]),e._v(");\n    });\n};\n")])]),t("p",[e._v("If you access to "),t("a",{attrs:{href:""}},[e._v("http://localhost:8080/api/todo")]),e._v(", you should see "),t("code",{pre:!0},[e._v("My first API endpoint")]),e._v(".")]),t("p",[e._v("However, since we are working with API endpoints, it is strongly suggested that you use an appropriate tool.\nWe recommend using "),t("a",{attrs:{href:"https://www.getpostman.com/downloads/"}},[e._v("Postman")]),e._v(", or any API consumer tool.\nYou must be able to easily switch the HTTP method and set the request body.")]),t("h2",[e._v("Create the controller")]),t("p",[e._v("As we saw earlier in the previous tutorial, a "),t("code",{pre:!0},[e._v("Controller")]),e._v(" is needed to clearly separate our logic from the routes.")]),t("p",[e._v("We also learned a useful command that creates a controller class file for us, called "),t("code",{pre:!0},[e._v("make:command")]),e._v(".")]),t("p",[e._v("Let's check its signature through the "),t("code",{pre:!0},[e._v("--help")]),e._v(" flag.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-text"}},[e._v('node ioc make:controller --help\n\nioc make:controller <class>\n\nCreate a controller class.\n\nOptions:\n  --help         Show help                                                                                     [boolean]\n  --version      Show version number                                                                           [boolean]\n  -v, --verbose  Adjust the verbosity of the command                                                             [count]\n  --destination  File destination.                                                              [string] [default: null]\n  --resource     Generate a resource controller class.                                                         [boolean]\n  --api          Generate an API resource controller class, without "create" and "edit" actions.               [boolean]\n  --handler      Generate a single method handler controller class.                                            [boolean]\n')])]),t("p",[e._v("As we can see, there are some custom flags, such as "),t("code",{pre:!0},[e._v("resource")]),e._v(", "),t("code",{pre:!0},[e._v("api")]),e._v(" and "),t("code",{pre:!0},[e._v("handler")]),e._v(".\nEach one of them indicates to create a specific type of controller.\nIn our case, we need an API controller, which implements the API CRUD methods that we want to implement.")]),t("p",[e._v("Let's make our API controller, called "),t("code",{pre:!0},[e._v("TodoController")]),e._v(".\nAlso, let's put it in a sub-folder called "),t("code",{pre:!0},[e._v("api")]),e._v(".")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-bash"}},[e._v("node ioc make:controller api/TodoController --api\n")])]),t("p",[e._v("This will automatically create a folder called "),t("code",{pre:!0},[e._v("api")]),e._v(", if it did not exist, and create the "),t("code",{pre:!0},[e._v("TodoController")]),e._v(" file in this location.\nWith the "),t("code",{pre:!0},[e._v("--api")]),e._v(" flag, we indicate that we need a different scaffold.\nHere what your new controller, located under "),t("code",{pre:!0},[e._v("src/app/http/controllers/api/TodoController")]),e._v(" looks like.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-class"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("class")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("TodoController")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("extends")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("Controller")]),e._v(" ")]),e._v("{\n\n    "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("/**\n     * Display a listing of the resource.\n     *\n     * @returns {response} The response.\n     */")]),e._v("\n    index() {\n        "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("//")]),e._v("\n    }\n\n    "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("/**\n     * Store a newly created resource.\n     *\n     * @returns {response} The response.\n     */")]),e._v("\n    store() {\n        "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("//")]),e._v("\n    }\n\n    "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("/**\n     * Display the specified resource.\n     *\n     * @returns {response} The response.\n     */")]),e._v("\n    show() {\n        "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("//")]),e._v("\n    }\n\n    "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("/**\n     * Update the specified resource.\n     *\n     * @returns {response} The response.\n     */")]),e._v("\n    update() {\n        "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("//")]),e._v("\n    }\n\n    "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("/**\n     * Remove the specified resource.\n     *\n     * @returns {response} The response.\n     */")]),e._v("\n    destroy() {\n        "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("//")]),e._v("\n    }\n\n}\n")])]),t("p",[e._v("Very cool, isn't it? Now, all we need to do is associate our route to our newly created controller.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("export")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("default")]),e._v(" (router) => {\n    router.get("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'/app'")]),e._v(", "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'AppController@index'")]),e._v(").name("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'app.index'")]),e._v(");\n\n    router.get("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'/todo'")]),e._v(", "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'api.TodoController@index'")]),e._v(");\n};\n")])]),t("p",[e._v("The folders are dotted separated in a controller.\nIt is treated the same as a service, which all follow the dotted syntax.")]),t("p",[e._v("Finally, let's return a response in our "),t("code",{pre:!0},[e._v("index")]),e._v(" action in our controller.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-class"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("class")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("TodoController")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("extends")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("Controller")]),e._v(" ")]),e._v("{\n\n    index() {\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".json("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'My first JSON response'")]),e._v(");\n    }\n\n    "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("/* ... */")]),e._v("\n\n}\n")])]),t("p",[e._v("Notice that we used the "),t("code",{pre:!0},[e._v("json")]),e._v(" method.\nIt accepts any JSON serializable value and handles all the formatting for you.\nNo need to "),t("code",{pre:!0},[e._v("JSON.stringify")]),e._v(" anymore.")]),t("p",[e._v("If you access the endpoint, you should now see "),t("code",{pre:!0},[e._v('"My first JSON response"')]),e._v(", as an "),t("code",{pre:!0},[e._v("application/json")]),e._v(" content type (notice the double quotes).")]),t("h3",[e._v("Create the other routes")]),t("p",[e._v("Now that we have a fully functional controller bound to a route, we should be able to create the other routes.")]),t("p",[e._v("Let's create our "),t("code",{pre:!0},[e._v("store")]),e._v(" route, the one that should create an entity.")]),t("p",[e._v("For the following routes, we will follow the "),t("a",{attrs:{href:"https://en.wikipedia.org/wiki/Representational_state_transfer#Relationship_between_URI_and_HTTP_methods"}},[e._v("REST nomenclature")]),e._v(".")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("export")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("default")]),e._v(" (router) => {\n    router.get("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'/todo'")]),e._v(",          "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'api.TodoController@index'")]),e._v(");\n    router.post("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'/todo'")]),e._v(",         "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'api.TodoController@store'")]),e._v(");\n    router.get("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'/todo/:todo'")]),e._v(",    "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'api.TodoController@show'")]),e._v(");\n    router.patch("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'/todo/:todo'")]),e._v(",  "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'api.TodoController@update'")]),e._v(");\n    router.delete("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'/todo/:todo'")]),e._v(", "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'api.TodoController@destroy'")]),e._v(");\n};\n")])]),t("p",[e._v("Those routes are the basic ones for any RESTful API architecture.\nSince it happens too often, two special methods from the "),t("code",{pre:!0},[e._v("router")]),e._v(" service was created, called "),t("code",{pre:!0},[e._v("resource")]),e._v(" and "),t("code",{pre:!0},[e._v("apiResource")]),e._v(".")]),t("p",[e._v("What they do is basically the same as we did, but automatically.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("export")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("default")]),e._v(" (router) => {\n    router.apiResource("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'todo'")]),e._v(", "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'api.TodoController'")]),e._v(");\n};\n")])]),t("p",[e._v("Much cleaner, isn't it? All we need to send to the "),t("code",{pre:!0},[e._v("resource")]),e._v(" or the "),t("code",{pre:!0},[e._v("apiResource")]),e._v(" method is the current resource name, which will be present in the URL, and the resource controller that will handle the requests.")]),t("p",[e._v("The key difference between a "),t("code",{pre:!0},[e._v("resource")]),e._v(" and an "),t("code",{pre:!0},[e._v("apiResource")]),e._v(" (which will be reflected in the "),t("code",{pre:!0},[e._v("make:controller")]),e._v("'s "),t("code",{pre:!0},[e._v("--resource")]),e._v(" and "),t("code",{pre:!0},[e._v("--api")]),e._v(") is that the "),t("code",{pre:!0},[e._v("resource")]),e._v(" has two additional routes: "),t("code",{pre:!0},[e._v("create")]),e._v(" ("),t("code",{pre:!0},[e._v("/resource/create")]),e._v(") and "),t("code",{pre:!0},[e._v("edit")]),e._v(" ("),t("code",{pre:!0},[e._v("/resource/:id/edit")]),e._v(").\nThey are not present in an API resource since they should return a creation, or an edition form, which does not make sense in an API.")]),t("h2",[e._v("Implement the index action")]),t("p",[e._v("To make our first CRUD application works, we need some data.\nWe could set up a local database, but let's keep it simple for now.")]),t("p",[e._v("The "),t("code",{pre:!0},[e._v("config")]),e._v(" repository can be very helpful to handle application configuration through the framework modules, our own implementation, and for third parties.\nLet's use it another way (for demo purpose): as a runtime data repository.")]),t("p",[e._v("First, we need to inject the "),t("code",{pre:!0},[e._v("config")]),e._v(" repository in our controller.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-class"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("class")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("TodoController")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("extends")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("Controller")]),e._v(" ")]),e._v("{\n\n    "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("static")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("get")]),e._v(" dependencies() {\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" ["),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'config'")]),e._v("];\n    }\n\n    index() {\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".json("),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".config.get("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'app.name'")]),e._v("));\n    }\n\n    "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("/* ... */")]),e._v("\n\n}\n")])]),t("p",[e._v("You should now see the application name instead of our placeholder sentence.")]),t("h3",[e._v("The config repository")]),t("p",[e._v("The configuration repository is one of the most useful ones.\nIt allows using configuration to drive our entire application through "),t("code",{pre:!0},[e._v("yaml")]),e._v(" files.\nIt offers some methods, such as "),t("code",{pre:!0},[e._v("get")]),e._v(", "),t("code",{pre:!0},[e._v("set")]),e._v(", "),t("code",{pre:!0},[e._v("has")]),e._v(", "),t("code",{pre:!0},[e._v("merge")]),e._v(", etc.\nThe files in the "),t("code",{pre:!0},[e._v("config")]),e._v(" folder act like namespaces: the "),t("code",{pre:!0},[e._v("app.name")]),e._v(" key can be found in the "),t("code",{pre:!0},[e._v("app.yaml")]),e._v(" file, under the "),t("code",{pre:!0},[e._v("name")]),e._v(" YAML key.\nThe configuration repository accepts "),t("code",{pre:!0},[e._v(".yaml")]),e._v(", "),t("code",{pre:!0},[e._v(".yml")]),e._v(", "),t("code",{pre:!0},[e._v(".js")]),e._v(" and "),t("code",{pre:!0},[e._v(".json")]),e._v(" files to retrieve default configuration (however, your JavaScript ile must be written in CommonJS syntax, with "),t("code",{pre:!0},[e._v("module.exports")]),e._v(").")]),t("h3",[e._v("Return a todo list")]),t("p",[e._v("Let's return the todo list.\nIt will be empty at first but will be filled when we will implement the other CRUD methods.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-class"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("class")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("TodoController")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("extends")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("Controller")]),e._v(" ")]),e._v("{\n\n    "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("/* ... */")]),e._v("\n\n    index() {\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("const")]),e._v(" todos = "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".config.get("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'todos'")]),e._v(", []); "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("// The second argument is the default value")]),e._v("\n\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".json(todos);\n    }\n\n    "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("/* ... */")]),e._v("\n\n}\n")])]),t("p",[e._v("This will return an empty array.\nLet's try to populate it manually to see how it reacts in a runtime environment.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-class"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("class")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("TodoController")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("extends")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("Controller")]),e._v(" ")]),e._v("{\n\n    "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("/* ... */")]),e._v("\n\n    index() {\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("const")]),e._v(" todos = "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".config.get("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'todos'")]),e._v(", []).concat([{ "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("label")]),e._v(": "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'My first todo'")]),e._v(", "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("done")]),e._v(": "),t("span",{pre:!0,attrs:{class:"hljs-literal"}},[e._v("false")]),e._v(" }]);\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".config.set("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'todos'")]),e._v(", todos);\n\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".json(todos);\n    }\n\n    "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("/* ... */")]),e._v("\n\n}\n")])]),t("p",[e._v("If you reload the page, you should see "),t("code",{pre:!0},[e._v('[{"name":"My first todo","done":false}]')]),e._v(".\nTry to reload it another time.\nNow, you have two todos, "),t("code",{pre:!0},[e._v('[{"name":"My first todo","done":false},{"name":"My first todo","done":false}]')]),e._v(".\nThe configuration caches the result the whole time the application runs.")]),t("p",[e._v("Now that we can assert that the configuration repository works, let's put the controller back the way it was.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-class"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("class")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("TodoController")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("extends")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("Controller")]),e._v(" ")]),e._v("{\n\n    "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("/* ... */")]),e._v("\n\n    index() {\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("const")]),e._v(" todos = "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".config.get("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'todos'")]),e._v(", []);\n\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".json(todos);\n    }\n\n    "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("/* ... */")]),e._v("\n\n}\n")])]),t("h3",[e._v("Implement the store action")]),t("p",[e._v("The first action that will interact with our data is the "),t("code",{pre:!0},[e._v("store")]),e._v(" action.\nIts role is to create a new entity.\nWe need to use the "),t("code",{pre:!0},[e._v("POST")]),e._v(" HTTP method.")]),t("p",[e._v("Let's try with Postman, with the following url: "),t("code",{pre:!0},[e._v("http://localhost:8080/api/todo")]),e._v(" with the "),t("code",{pre:!0},[e._v("POST")]),e._v(" HTTP method, and let's return a fake JSON response in the "),t("code",{pre:!0},[e._v("store")]),e._v(" controller action.")]),t("blockquote",[t("p",[e._v("In order to trap errors in JSON response instead of HTML, your request must have the "),t("code",{pre:!0},[e._v("Accept: application/json")]),e._v(" header.")])]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-class"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("class")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("TodoController")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("extends")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("Controller")]),e._v(" ")]),e._v("{\n\n    "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("/* ... */")]),e._v("\n\n    store() {\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".json("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'Storing new todo'")]),e._v(");\n    }\n\n    "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("/* ... */")]),e._v("\n\n}\n")])]),t("p",[e._v("The two actions refer to the same URL, but with a different HTTP method, "),t("code",{pre:!0},[e._v("GET")]),e._v(" for "),t("code",{pre:!0},[e._v("index")]),e._v(", and "),t("code",{pre:!0},[e._v("POST")]),e._v(" form "),t("code",{pre:!0},[e._v("store")]),e._v(".\nIf you try to send a "),t("code",{pre:!0},[e._v("POST")]),e._v(" request to the "),t("code",{pre:!0},[e._v("/api/todo")]),e._v(" URL, you should see "),t("code",{pre:!0},[e._v('"Storing new todo"')]),e._v(" instead of "),t("code",{pre:!0},[e._v("[]")]),e._v(".")]),t("p",[e._v('This action normally expects that it receives a body containing the Todo data to be stored.\nLet\'s establish a "todo" model for the backend side.')]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-json"}},[e._v("{\n  "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v('"id"')]),e._v(":    "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v('"number"')]),e._v(",\n  "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v('"label"')]),e._v(": "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v('"string"')]),e._v(",\n  "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v('"done"')]),e._v(":  "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v('"boolean"')]),e._v("\n}\n")])]),t("p",[e._v("However, the user only has to specify the "),t("code",{pre:!0},[e._v("label")]),e._v(" field, since it will not be done, and the ID is generated by the server.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-json"}},[e._v("{\n  "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v('"label"')]),e._v(": "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v('"string"')]),e._v("\n}\n")])]),t("p",[e._v("Let's send this body to the "),t("code",{pre:!0},[e._v("store")]),e._v(" action endpoint.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-json"}},[e._v("{\n  "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v('"label"')]),e._v(": "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v('"My first todo"')]),e._v("\n}\n")])]),t("p",[e._v("In the controller, we now need to retrieve the body.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-class"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("class")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("TodoController")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("extends")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("Controller")]),e._v(" ")]),e._v("{\n\n    "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("/* ... */")]),e._v("\n\n    store() {\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".json("),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".request.body);\n    }\n\n    "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("/* ... */")]),e._v("\n\n}\n")])]),t("p",[e._v("You should see the whole request body in the response.")]),t("p",[e._v("Now, let's create a todo.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-class"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("class")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("TodoController")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("extends")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("Controller")]),e._v(" ")]),e._v("{\n\n    "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("/* ... */")]),e._v("\n\n    store() {\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("const")]),e._v(" todos      = "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".config.get("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'todo'")]),e._v(", []);\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("const")]),e._v(" previousId = (todos[todos.length - "),t("span",{pre:!0,attrs:{class:"hljs-number"}},[e._v("1")]),e._v("] || {}).id || "),t("span",{pre:!0,attrs:{class:"hljs-number"}},[e._v("0")]),e._v(";\n\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("const")]),e._v(" todo = {\n           ...this.request.body,\n           "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("id")]),e._v(": previousId + "),t("span",{pre:!0,attrs:{class:"hljs-number"}},[e._v("1")]),e._v(",\n            "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("done")]),e._v(": "),t("span",{pre:!0,attrs:{class:"hljs-literal"}},[e._v("false")]),e._v(",\n        };\n\n        todos.push(todo);\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".config.set("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'todo'")]),e._v(", todos);        \n\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".json(todo);\n    }\n\n    "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("/* ... */")]),e._v("\n\n}\n")])]),t("p",[e._v("It should add a new todo each time you make the request, with an incrementing ID.")]),t("h3",[e._v("Validate data")]),t("p",[e._v("We missed a very important part: validation.\nWe are assuming that the received body will match our expected model, but "),t("code",{pre:!0},[e._v("label")]),e._v(" may be an object, or we could have another unexpected key.")]),t("p",[e._v("We can use the "),t("code",{pre:!0},[e._v("validate")]),e._v(" method in the controller to validate the current request body.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-class"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("class")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("TodoController")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("extends")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("Controller")]),e._v(" ")]),e._v("{\n\n    "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("/* ... */")]),e._v("\n\n    store() {\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("const")]),e._v(" todos      = "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".config.get("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'todo'")]),e._v(", []);\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("const")]),e._v(" previousId = (todos[todos.length - "),t("span",{pre:!0,attrs:{class:"hljs-number"}},[e._v("1")]),e._v("] || {}).id || "),t("span",{pre:!0,attrs:{class:"hljs-number"}},[e._v("0")]),e._v(";\n\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".validate("),t("span",{pre:!0,attrs:{class:"hljs-function"}},[e._v("("),t("span",{pre:!0,attrs:{class:"hljs-params"}},[e._v("validator")]),e._v(") =>")]),e._v(" {\n            "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" {\n                "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("label")]),e._v(": validator.string().min("),t("span",{pre:!0,attrs:{class:"hljs-number"}},[e._v("3")]),e._v(")\n            }; \n        });\n\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("const")]),e._v(" todo = {\n           ...this.request.body,\n           "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("id")]),e._v(": previousId + "),t("span",{pre:!0,attrs:{class:"hljs-number"}},[e._v("1")]),e._v(",\n            "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("done")]),e._v(": "),t("span",{pre:!0,attrs:{class:"hljs-literal"}},[e._v("false")]),e._v(",\n        };\n\n        todos.push(todo);\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".config.set("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'todo'")]),e._v(", todos);        \n\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".json(todo);\n    }\n\n    "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("/* ... */")]),e._v("\n\n}\n")])]),t("p",[e._v("The "),t("code",{pre:!0},[e._v("validate")]),e._v(" method accepts a callback that is used to validate each request body key against a validator schema.")]),t("p",[e._v("The default validator is the well-known "),t("a",{attrs:{href:"https://hapi.dev/family/joi/"}},[e._v("@hapi/joi")]),e._v(" validation package.\nYou can use all the available methods and schema types.")]),t("p",[e._v("Here we validate that the body contains (and contains only) a label that is a string with a minimum length of 3 characters.")]),t("p",[e._v("Now, create a todo, then go to the index endpoint.\nYour todo should be there.")]),t("h2",[e._v("Implement the show action")]),t("p",[e._v("The show action is normally used to display a single resource item.\nIn our case, we should return the requested todo by ID.")]),t("p",[e._v("The route URL schema is "),t("code",{pre:!0},[e._v("/api/todo/:todo")]),e._v(".\nNotice the last segment, which contains "),t("code",{pre:!0},[e._v(":")]),e._v(".\nIt indicates that this segment is a variable that can be retrieved.")]),t("p",[e._v("You can retrieve the route parameter in the controller through "),t("code",{pre:!0},[e._v("this.request.params")]),e._v(".\nIn our case, it would be "),t("code",{pre:!0},[e._v("this.reques.t.params.todo")]),e._v(".")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-class"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("class")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("TodoController")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("extends")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("Controller")]),e._v(" ")]),e._v("{\n\n    "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("/* ... */")]),e._v("\n\n    show() {\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("const")]),e._v(" { "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("todo")]),e._v(": id } = "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".request.params;\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("const")]),e._v(" todos = "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".config.get("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'todo'")]),e._v(", []);\n\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("const")]),e._v(" todo = todos.find("),t("span",{pre:!0,attrs:{class:"hljs-function"}},[e._v("("),t("span",{pre:!0,attrs:{class:"hljs-params"}},[e._v("{ id: todoId }")]),e._v(") =>")]),e._v(" {\n            "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" todoId.toString() === id.toString();\n        });\n\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("if")]),e._v(" (!todo) {\n            "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".notFound();\n        }\n\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".json(todo);\n    }\n\n    "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("/* ... */")]),e._v("\n\n}\n")])]),t("p",[e._v("Here, we retrieve the requested todo ID.\nThen, we attempt to retrieve the corresponding todo.\nWith a database, we would have used "),t("code",{pre:!0},[e._v("where")]),e._v(" and "),t("code",{pre:!0},[e._v("first")]),e._v(" statements.")]),t("p",[e._v("We used the ID as a matcher, and we converted them to string to keep strict equality check (most backend developers like type tests and casting, let's use it too, even with a weakly-typed language)")]),t("p",[e._v("Interesting fact, you can send a "),t("code",{pre:!0},[e._v("404 Not Found.")]),e._v(" very easily with the "),t("code",{pre:!0},[e._v("notFound")]),e._v(" method, but in a local environment, it converts to a "),t("code",{pre:!0},[e._v("NotFoundHttpError")]),e._v(" page, which is great for testing.\nIf you are not in a local environment, the real 404 page or JSON response will show up.")]),t("p",[e._v("To be able to display a todo, ensure that your to-do list contains the requested todo.\nFriendly reminder that each time the server is stopped, the data disappear, and you have to create them again.")]),t("h2",[e._v("Implement the update action")]),t("p",[e._v("Now, we can start updating an existing todo.\nWe should allow to update the label, but the done status as well.\nThe route to consume this API action is "),t("code",{pre:!0},[e._v("/api/todo/:todo")]),e._v(" with the "),t("code",{pre:!0},[e._v("PATCH")]),e._v(" HTTP method.")]),t("p",[e._v("Here is the accepted schema")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-json"}},[e._v("{\n  "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v('"label"')]),e._v(": "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v('"string|optional"')]),e._v(",\n  "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v('"todo"')]),e._v(":  "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v('"boolean|optional"')]),e._v("\n}\n")])]),t("p",[e._v("Let's implement it, with validation of course!")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-class"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("class")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("TodoController")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("extends")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("Controller")]),e._v(" ")]),e._v("{\n\n    "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("/* ... */")]),e._v("\n\n    update() {\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("const")]),e._v(" { "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("todo")]),e._v(": id } = "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".request.params;\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("const")]),e._v(" todos = "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".config.get("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'todo'")]),e._v(", []);\n\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("const")]),e._v(" todo = todos.find("),t("span",{pre:!0,attrs:{class:"hljs-function"}},[e._v("("),t("span",{pre:!0,attrs:{class:"hljs-params"}},[e._v("{ id: todoId }")]),e._v(") =>")]),e._v(" {\n            "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" todoId.toString() === id.toString();\n        });\n\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("if")]),e._v(" (!todo) {\n            "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".notFound();\n        }\n        \n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".validate("),t("span",{pre:!0,attrs:{class:"hljs-function"}},[e._v("("),t("span",{pre:!0,attrs:{class:"hljs-params"}},[e._v("validator")]),e._v(") =>")]),e._v(" {\n            "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" {\n                "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("label")]),e._v(": validator.string().optional(),\n                "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("done")]),e._v(":  validator.boolean().optional()\n            };\n        });\n\n        "),t("span",{pre:!0,attrs:{class:"hljs-built_in"}},[e._v("Object")]),e._v(".assign(todo, "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".request.body);\n\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".config.set("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'todo'")]),e._v(", todos);\n\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".json(todo);\n    }\n\n    "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("/* ... */")]),e._v("\n\n}\n")])]),t("h2",[e._v("Implement destroy action")]),t("p",[e._v("Let's finally delete a todo.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-class"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("class")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("TodoController")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("extends")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("Controller")]),e._v(" ")]),e._v("{\n\n    "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("/* ... */")]),e._v("\n\n    destroy() {\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("const")]),e._v(" { "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("todo")]),e._v(": id } = "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".request.params;\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("const")]),e._v(" todos = "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".config.get("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'todo'")]),e._v(", []);\n\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("const")]),e._v(" todoIndex = todos.findIndex("),t("span",{pre:!0,attrs:{class:"hljs-function"}},[e._v("("),t("span",{pre:!0,attrs:{class:"hljs-params"}},[e._v("{ id: todoId }")]),e._v(") =>")]),e._v(" {\n            "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" todoId.toString() === id.toString();\n        });\n\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("if")]),e._v(" (todoIndex === "),t("span",{pre:!0,attrs:{class:"hljs-number"}},[e._v("-1")]),e._v(") {\n            "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".notFound();\n        }\n\n        todos.splice(todoIndex, "),t("span",{pre:!0,attrs:{class:"hljs-number"}},[e._v("1")]),e._v(");\n\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".noContent();\n    }\n\n}\n")])]),t("p",[e._v("To indicate that the content was deleted and nothing remains of it, a "),t("code",{pre:!0},[e._v("204 No Content.")]),e._v(" is returned.")]),t("p",[e._v("Here is the final result:")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("import")]),e._v(" Controller "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("from")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'../Controller'")]),e._v(";\n\n\n"),t("span",{pre:!0,attrs:{class:"hljs-class"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("class")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("TodoController")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("extends")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("Controller")]),e._v(" ")]),e._v("{\n\n    "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("static")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("get")]),e._v(" dependencies() {\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" ["),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'config'")]),e._v("];\n    }\n\n    index() {\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".json("),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".config.get("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'todo'")]),e._v(", []));\n    }\n\n    store() {\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("const")]),e._v(" todos      = "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".config.get("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'todo'")]),e._v(", []);\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("const")]),e._v(" previousId = (todos[todos.length - "),t("span",{pre:!0,attrs:{class:"hljs-number"}},[e._v("1")]),e._v("] || {}).id || "),t("span",{pre:!0,attrs:{class:"hljs-number"}},[e._v("0")]),e._v(";\n\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".validate("),t("span",{pre:!0,attrs:{class:"hljs-function"}},[e._v("("),t("span",{pre:!0,attrs:{class:"hljs-params"}},[e._v("validator")]),e._v(") =>")]),e._v(" {\n            "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" {\n                "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("label")]),e._v(": validator.string().required()\n            };\n        });\n\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("const")]),e._v(" todo = {\n            ...this.request.body,\n            "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("id")]),e._v(": previousId + "),t("span",{pre:!0,attrs:{class:"hljs-number"}},[e._v("1")]),e._v(",\n            "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("done")]),e._v(": "),t("span",{pre:!0,attrs:{class:"hljs-literal"}},[e._v("false")]),e._v("\n        };\n\n        todos.push(todo);\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".config.set("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'todo'")]),e._v(", todos);\n\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".json(todo);\n    }\n\n    show() {\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("const")]),e._v(" { "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("todo")]),e._v(": id } = "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".request.params;\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("const")]),e._v(" todos = "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".config.get("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'todo'")]),e._v(", []);\n\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("const")]),e._v(" todo = todos.find("),t("span",{pre:!0,attrs:{class:"hljs-function"}},[e._v("("),t("span",{pre:!0,attrs:{class:"hljs-params"}},[e._v("{ id: todoId }")]),e._v(") =>")]),e._v(" {\n            "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" todoId.toString() === id.toString();\n        });\n\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("if")]),e._v(" (!todo) {\n            "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".notFound();\n        }\n\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".json(todo);\n    }\n\n    update() {\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("const")]),e._v(" { "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("todo")]),e._v(": id } = "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".request.params;\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("const")]),e._v(" todos = "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".config.get("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'todo'")]),e._v(", []);\n\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("const")]),e._v(" todo = todos.find("),t("span",{pre:!0,attrs:{class:"hljs-function"}},[e._v("("),t("span",{pre:!0,attrs:{class:"hljs-params"}},[e._v("{ id: todoId }")]),e._v(") =>")]),e._v(" {\n            "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" todoId.toString() === id.toString();\n        });\n\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("if")]),e._v(" (!todo) {\n            "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".notFound();\n        }\n\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".validate("),t("span",{pre:!0,attrs:{class:"hljs-function"}},[e._v("("),t("span",{pre:!0,attrs:{class:"hljs-params"}},[e._v("validator")]),e._v(") =>")]),e._v(" {\n            "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" {\n                "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("label")]),e._v(": validator.string().optional(),\n                "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("done")]),e._v(":  validator.boolean().optional()\n            };\n        });\n\n        "),t("span",{pre:!0,attrs:{class:"hljs-built_in"}},[e._v("Object")]),e._v(".assign(todo, "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".request.body);\n\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".config.set("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'todo'")]),e._v(", todos);\n\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".json(todo);\n    }\n\n    destroy() {\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("const")]),e._v(" { "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("todo")]),e._v(": id } = "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".request.params;\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("const")]),e._v(" todos = "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".config.get("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'todo'")]),e._v(", []);\n\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("const")]),e._v(" todoIndex = todos.findIndex("),t("span",{pre:!0,attrs:{class:"hljs-function"}},[e._v("("),t("span",{pre:!0,attrs:{class:"hljs-params"}},[e._v("{ id: todoId }")]),e._v(") =>")]),e._v(" {\n            "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" todoId.toString() === id.toString();\n        });\n\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("if")]),e._v(" (todoIndex === "),t("span",{pre:!0,attrs:{class:"hljs-number"}},[e._v("-1")]),e._v(") {\n            "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".notFound();\n        }\n\n        todos.splice(todoIndex, "),t("span",{pre:!0,attrs:{class:"hljs-number"}},[e._v("1")]),e._v(");\n\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".noContent();\n    }\n\n}\n\n\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("export")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("default")]),e._v(" TodoController;\n")])]),t("p",[e._v("Of course, all we did was a small CRUD todo application through a RESTful API, but you saw how to do it the "),t("em",[e._v("simple")]),e._v(" way.")]),t("p",[e._v("We could have gone deeper by creating a service that handles all this process, to have a better separation of concern...")]),t("p",[e._v("That's your next assignment!")])])}],n=t("2877"),o={},l=Object(n["a"])(o,a,r,!1,null,null,null);s["default"]=l.exports},dc90:function(e,s,t){"use strict";t.r(s);var a=function(){var e=this,s=e.$createElement;e._self._c;return e._m(0)},r=[function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("section",[t("h1",[e._v("HTTP client")]),t("h2",[e._v("Introduction")]),t("p",[e._v("Making API calls to third parties is almost inevitable in modern Web applications.\nConfiguring connectors may be very useful too when creating services that transact with other entities such as a CMS backend, an ERP, a SaaS or any other kind of parties.\nTo make it easy to work with those parties, Node IoC provides an HTTP client service, powered by "),t("a",{attrs:{href:"https://github.com/axios/axios"}},[e._v("Axios")]),e._v(".")]),t("h2",[e._v("The http service")]),t("p",[e._v("To access the HTTP client, you can inject the "),t("code",{pre:!0},[e._v("http")]),e._v(" service, which will return a factorized Axios instance.\nThen, all the available features in Axios will be directly available.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("const")]),e._v(" http = app.make("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'http'")]),e._v(");\n\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("const")]),e._v(" { "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("data")]),e._v(": first } = "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("await")]),e._v(" http.get("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'https://example.com/foo/bar'")]),e._v("); "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v('// { foo: "bar" }')]),e._v("\n\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("const")]),e._v(" { "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("data")]),e._v(": second } = "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("await")]),e._v(" http.post("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'https://example.com/foo/bar'")]),e._v(", { "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("key")]),e._v(": "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'value'")]),e._v(" }); "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("// { success: true }")]),e._v("\n\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("const")]),e._v(" dedicatedClient = http.create({\n    "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("baseUrl")]),e._v(": "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'https://example.com'")]),e._v("\n});\n\nhttp === dedicatedClient; "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("// false")]),e._v("\n\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("const")]),e._v(" { "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("data")]),e._v(": third } = "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("await")]),e._v(" dedicatedClient.get("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'/foo/bar'")]),e._v("); "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v('// { foo: "bar" }')]),e._v("\n")])])])}],n=t("2877"),o={},l=Object(n["a"])(o,a,r,!1,null,null,null);s["default"]=l.exports},eb8a:function(e,s,t){"use strict";t.r(s);var a=function(){var e=this,s=e.$createElement;e._self._c;return e._m(0)},r=[function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("section",[t("h1",[e._v("Translation")]),t("h2",[e._v("Introduction")]),t("p",[e._v("Node IoC offers a custom translation system that all the common cases, from simple translation to pluralization and tokens.\nMost of the existing "),t("em",[e._v("i18n")]),e._v(" systems are either async, only rely on JSON files or do not handle complex use cases.\nThe "),t("code",{pre:!0},[e._v("translator")]),e._v(" service uses drivers for its implementation, which adds a lot of flexibility.\nBy default, only the "),t("code",{pre:!0},[e._v("file")]),e._v(" driver is provided, but feel free to implement your own, such as a database translation driver.")]),t("h2",[e._v("The translator service")]),t("p",[e._v("The translator service allows us to easily translate strings, for both current and specific locales.\nYou can also easily add a translation or even a batch of translations.\nBy default, translations are loaded by the kernel to ensure sync translations afterward.\nAll translation implementation is in fact offered by its drivers.")]),t("p",[e._v("However, it abstracts their methods for simple and verbose usage.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("const")]),e._v(" translator = app.make("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'translator'")]),e._v(");\n\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("await")]),e._v(" translator.loadTranslations();\ntranslator.setLocale("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'fr'")]),e._v(");\ntranslator.setFallbackLocale("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'es'")]),e._v(");\n\ntranslator.addTranslation("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'Thanks'")]),e._v(", "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'Merci'")]),e._v(");\ntranslator.addTranslation("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'Thanks'")]),e._v(", "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'Gracias'")]),e._v(", "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'es'")]),e._v(");\n\ntranslator.translate("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'Thanks'")]),e._v("); "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v('// "Merci"')]),e._v("\ntranslator.translateForLocale("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'es'")]),e._v(", "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'Thanks'")]),e._v("); "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v('// "Gracias"')]),e._v("\n\ntranslator.addTranslations({ "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'This is a sentence'")]),e._v(": "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'C\\'est une phrase'")]),e._v(" });\ntranslator.addTranslations({ "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'This is a sentence'")]),e._v(": "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'Esta es una frase'")]),e._v(" }, "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'es'")]),e._v(");\n\ntranslator.addTranslation("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'Only translated into Spanish'")]),e._v(", "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'Solo traducido al español'")]),e._v(", "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'es'")]),e._v(");\n\ntranslator.translate("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'Only translated into Spanish'")]),e._v("); "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v('// "Solo traducido al español", as fallback locale is Spanish')]),e._v("\ntranslator.translate("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'Unexisting translation'")]),e._v("); "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v('// "Unexisting translation", as no translation was provided')]),e._v("\n")])]),t("p",[e._v("The default locale and fallback locale can be set in the configuration, in the "),t("code",{pre:!0},[e._v("config/app.yaml")]),e._v(".")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-yaml"}},[t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("# config/app.yaml")]),e._v("\n\n"),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("# ...")]),e._v("\n\n"),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("locale:")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("fr")]),e._v("\n\n"),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("fallback_locale:")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("es")]),e._v("\n")])]),t("h3",[e._v("The file driver")]),t("p",[e._v("The file driver is the default one.\nIt uses "),t("code",{pre:!0},[e._v(".yaml")]),e._v(" files to fetch existing translations.\nAs always, feel free to use both "),t("code",{pre:!0},[e._v(".yaml")]),e._v(", "),t("code",{pre:!0},[e._v(".yml")]),e._v(", "),t("code",{pre:!0},[e._v(".json")]),e._v(" and "),t("code",{pre:!0},[e._v(".js")]),e._v(" files.\nAll the translations can be found in your application, under the "),t("code",{pre:!0},[e._v("resources/lang")]),e._v(" folder.")]),t("p",[e._v("By default, the "),t("code",{pre:!0},[e._v("translations.yaml")]),e._v(" file is used as the default one.\nAll the existing translations in this file can be directly referred to.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-yaml"}},[t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("Hello,")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("world!:")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("  en:")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("Hello,")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("world!")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("  fr:")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("Bonjour,")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("le")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("monde!")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("  es:")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("¡Hola,")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("mundo!")]),e._v("\n")])]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v('// Given `app.locale` config set as "fr"')]),e._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("const")]),e._v(" fileDriver = app.make("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'translator'")]),e._v(").driver("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'file'")]),e._v(");\n\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("await")]),e._v(" fileDriver.loadTranslations();\n\nfileDriver.translate("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'Hello, world!'")]),e._v("); "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v('// "Bonjour, le monde!"')]),e._v("\n")])]),t("p",[e._v("As you can see in the "),t("code",{pre:!0},[e._v("translations.yaml")]),e._v(" example above, the translations are all done within the same file.\nThis approach was taken after long debates regarding the translation files structure for large-scale projects.\nSince an application evolves over time, translations do too.\nThis strategy prevents missing translations for a single locale and is easy to track over time.")]),t("p",[e._v("You can also use multiple files that will be used as namespaces.\nFor instance, if a "),t("code",{pre:!0},[e._v("foo.yaml")]),e._v(" was located in the "),t("code",{pre:!0},[e._v("resources/lang")]),e._v(" folder, all its translation keys would be prefixed by "),t("code",{pre:!0},[e._v("foo")]),e._v(".")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-yaml"}},[t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("# resources/lang/foo.yaml")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("bar:")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("  en:")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("Bar")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("in")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("english")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("  fr:")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("Bar")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("en")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("français")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("  es:")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("Bar")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("en")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("español")]),e._v("\n")])]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[e._v("fileDriver.translate("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'foo.bar'")]),e._v("); "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("// Bar en français")]),e._v("\n")])]),t("p",[e._v("A lot of developers like to work with translation keys instead of plain sentences or word translations.\nYou can do both with the "),t("code",{pre:!0},[e._v("translations.yaml")]),e._v(" file that can be used for full word(s) translations, and other files for namespaces translation keys.")]),t("p",[e._v("All the translations in the "),t("code",{pre:!0},[e._v("translations.yaml")]),e._v(" file will not contain a namespace prefix.")]),t("p",[e._v("An interesting strategy would also be to create sub-namespaces within a namespaced file.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-yaml"}},[t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("# resources/lang/foo.yaml")]),e._v("\n\n"),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("bar:")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("  baz:")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("    qux:")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("      en:")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("Qux")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("in")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("english")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("      fr:")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("Qux")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("en")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("français")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("      es:")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("Qux")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("en")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("español")]),e._v("\n")])]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[e._v("fileDriver.translate("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'foo.bar.baz.qux'")]),e._v("); "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v('// "Bar en français"')]),e._v("\n")])])])}],n=t("2877"),o={},l=Object(n["a"])(o,a,r,!1,null,null,null);s["default"]=l.exports},effd:function(e,s,t){"use strict";t.r(s);var a=function(){var e=this,s=e.$createElement;e._self._c;return e._m(0)},r=[function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("section",[t("h1",[e._v("Routing")]),t("h2",[e._v("Introduction")]),t("p",[e._v("Routing is the best way to assign HTTP requests to their handlers.\nThis section will cover the Node IoC routing system, which is directly linked to "),t("a",{attrs:{href:"https://expressjs.com/"}},[e._v("Express")]),e._v(".")]),t("h2",[e._v("Routes")]),t("p",[e._v("The application routes are normally located in the "),t("code",{pre:!0},[e._v("src/routes")]),e._v(" folder.\nThey are loaded by the "),t("code",{pre:!0},[e._v("src/app/providers/RouteServiceProvider")]),e._v(".\nThis service provider loads both the "),t("code",{pre:!0},[e._v("api.js")]),e._v(" and the "),t("code",{pre:!0},[e._v("web.js")]),e._v(" files, one after the other, to separate the route types.\nAll the "),t("code",{pre:!0},[e._v("api.js")]),e._v(" routes will be automatically prefixed by "),t("code",{pre:!0},[e._v("/api")]),e._v(".")]),t("h2",[e._v("Basic routing")]),t("p",[e._v("The router uses expressive syntax, similar to what Express exposes.\nThe router handles all basic HTTP verbs as a method, a URL and a handler.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[e._v("router.get("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'/foo'")]),e._v(", (request, response) => {\n    "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" response.write("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'Hello world!'")]),e._v(");\n});\n")])]),t("p",[e._v("As a route handler, you can also define a controller action.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[e._v("router.get("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'/foo'")]),e._v(", "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'FooController@index'")]),e._v(");\n")])]),t("p",[e._v("The syntax to use a controller action is "),t("code",{pre:!0},[e._v("ControllerName@method")]),e._v(".\nGiven the above example, here would be a valid implementation of the controller.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-class"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("class")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("FooController")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("extends")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("Controller")]),e._v(" ")]),e._v("{\n\n    index() {\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".response.write("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'Hello world!'")]),e._v(");\n    }\n\n}\n")])]),t("p",[e._v("The router handles the following basic methods:")]),t("ul",[t("li",[t("code",{pre:!0},[e._v("router.get(uri, handler)")])]),t("li",[t("code",{pre:!0},[e._v("router.post(uri, handler)")])]),t("li",[t("code",{pre:!0},[e._v("router.put(uri, handler)")])]),t("li",[t("code",{pre:!0},[e._v("router.patch(uri, handler)")])]),t("li",[t("code",{pre:!0},[e._v("router.delete(uri, handler)")])])]),t("h3",[e._v("Redirection route")]),t("p",[e._v("Sometime, the application may handle redirection.\nIt is always a better solution, regarding the performance, to handle the redirection from the server engine, such as Apache or Nginx configuration files.\nA simple solution was developed to handle those situations, for both temporary and permanent redirection.")]),t("ul",[t("li",[t("code",{pre:!0},[e._v("router.redirect(from, to)")])]),t("li",[t("code",{pre:!0},[e._v("router.permanentRedirect(from, to)")])])]),t("h3",[e._v("Static route")]),t("p",[e._v("Also, static content may come from dedicated folders.\nBy default, the "),t("code",{pre:!0},[e._v("/static")]),e._v(" and "),t("code",{pre:!0},[e._v("/uploads")]),e._v(" routes are static assets routes, "),t("code",{pre:!0},[e._v("/static")]),e._v(" from the "),t("code",{pre:!0},[e._v("path.public")]),e._v(" folder and "),t("code",{pre:!0},[e._v("/uploads")]),e._v(" from the "),t("code",{pre:!0},[e._v("path.upload")]),e._v("'s "),t("code",{pre:!0},[e._v("public")]),e._v(" folder.\nThey are simply pointing to a folder, and the file tree will be taken into account to retrieve the file to serve.")]),t("p",[e._v("Given the following file tree, here is the basic schema that the following route would handle with a file response.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":""}},[e._v("/path/to/files/\n    foo.txt\n    bar/\n        baz.txt\n        qux/\n            hello.txt\n")])]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[e._v("router.static("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'/files'")]),e._v(", "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'/path/to/files'")]),e._v(");\n"),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("// 'http://localhost:8080/files/foo.txt'       -> Serves '/path/to/files/foo.txt")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("// 'http://localhost:8080/files/bar/baz.txt'   -> Serves '/path/to/files/bar/baz.txt")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("// 'http://localhost:8080/files/qux/hello.txt' -> Serves '/path/to/files/qux/hello.txt")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("// 'http://localhost:8080/files/bar'           -> Return a \"404 Not Found.\" response.")]),e._v("\n")])]),t("h3",[e._v("Any verbs route")]),t("p",[e._v("It may occur that your route must handle any kind of verbs.")]),t("p",[e._v("The "),t("code",{pre:!0},[e._v("router.any(uri, handler)")]),e._v(" method will create a route that will match any HTTP verbs.\nThe "),t("code",{pre:!0},[e._v("router.all(uri, handler)")]),e._v(" method is an alias of the "),t("code",{pre:!0},[e._v("any")]),e._v(" method.")]),t("h3",[e._v("Fallback route")]),t("p",[e._v("Also, fallback routes may be very useful to handle single page application (SPA) built with React or Vue.js, for instance.")]),t("p",[e._v("The "),t("code",{pre:!0},[e._v("router.fallback(handler)")]),e._v(" method will create a route that matches any path that was not matched yet by the defined routes.\nIt prevents a 404 response from being sent.\nHowever, if you define this route before another specific route in the same group, the specific route will never match.")]),t("h2",[e._v("Route parameters")]),t("p",[e._v("A route can receive parameters, such as an ID/UUID, a username, a unique slug, etc.\nThe way to define a route parameter is by using the colon token, such as "),t("code",{pre:!0},[e._v("/:id")]),e._v(".")]),t("p",[e._v("The entire route parameters will be available with the request's "),t("code",{pre:!0},[e._v("params")]),e._v(" property, the same way you would do with Express.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[e._v("router.get("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'/todo'")]),e._v(",       "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'TodoController@index'")]),e._v(");\nrouter.get("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'/todo/:todo'")]),e._v(", "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'TodoController@show'")]),e._v(");\n")])]),t("h3",[e._v("Constraints")]),t("p",[e._v("To add constraints to a route parameter, you normally would use regular expression in the route signature, which some could find annoying for readability.\nSince the "),t("code",{pre:!0},[e._v("route.get(uri, handler)")]),e._v(" method returns a "),t("code",{pre:!0},[e._v("Route")]),e._v(" instance, you can use some useful methods.\nTo add constraints, you can use the "),t("code",{pre:!0},[e._v("where")]),e._v(" method, which is chainable.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[e._v("router.get("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'/todo/:todo'")]),e._v(", "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'TodoController@show'")]),e._v(")\n    .where("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'todo'")]),e._v(", "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'[1-9]\\d*'")]),e._v(");\n")])]),t("p",[e._v("This constraint indicates that to match the following route, the "),t("code",{pre:!0},[e._v("todo")]),e._v(" parameter must be a valid positive number.")]),t("h2",[e._v("Default values")]),t("p",[e._v("If you are using a controller as the route handler, it may be useful to send some default values to it as parameters, such as resolvable instance, static values, etc.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("// src/routes/web.js")]),e._v("\nrouter.get("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'/foo'")]),e._v(", "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'FooController@index'")]),e._v(")\n    .with("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'connection'")]),e._v(", app.make("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'db'")]),e._v(").getDefaultConnection())\n    .with("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'userId'")]),e._v(", "),t("span",{pre:!0,attrs:{class:"hljs-number"}},[e._v("1")]),e._v(");\n\n"),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("// src/app/http/controllers/FooController.js")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-class"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("class")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("FooController")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("extends")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("Controller")]),e._v(" ")]),e._v("{\n\n    index({ connection, userId }) {\n        "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("// connection === the default connection")]),e._v("\n        "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("// userId === 1")]),e._v("\n    }\n}\n")])]),t("h2",[e._v("Named routes")]),t("p",[e._v("It may be easy to reference a route by its URL, but you will have to change some of them, either for SEO reasons, localization, refactoring, etc.\nThe named routes are a very simple way to prevent those refactor messes that you may encounter.")]),t("p",[e._v("To name a route, the "),t("code",{pre:!0},[e._v("Route")]),e._v(" object exposes the "),t("code",{pre:!0},[e._v("name")]),e._v(" method.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[e._v("router.get("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'/foo'")]),e._v(", "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'FooController@index'")]),e._v(")\n    .name("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'foo.index'")]),e._v(");\n")])]),t("p",[e._v("With this simple additional line, you will be able to find your route very easily in the "),t("code",{pre:!0},[e._v("router.route")]),e._v(" repository.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("const")]),e._v(" route = app.make("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'router.route'")]),e._v(").findByName("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'foo.index'")]),e._v("); "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("// Route {}")]),e._v("\nroute.path   === "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'/foo'")]),e._v("; "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("// true")]),e._v("\nroute.action === "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'FooController@index'")]),e._v("; "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("// true")]),e._v("\n")])]),t("h2",[e._v("Groups")]),t("p",[e._v("Grouping routes is a great idea to prevent all routes to have long URIs, a complex naming structure that may have typos in it, and so on.\nThe router offers the "),t("code",{pre:!0},[e._v("group")]),e._v(" method that accepts a group options object, and a callback that registers the routes in the group.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[e._v("router.group({ "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("prefix")]),e._v(": "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'/admin'")]),e._v(", "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("as")]),e._v(": "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'admin.'")]),e._v(", "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("namespace")]),e._v(": "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'backend.'")]),e._v("}, () => {\n    router.get("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'/'")]),e._v(",           "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'DashboardController@index'")]),e._v(").name("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'dashboard'")]),e._v(");\n    router.get("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'/user'")]),e._v(",       "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'UserController@index'")]),e._v(").name("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'user.index'")]),e._v(");\n    router.get("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'/user/:user'")]),e._v(", "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'UserController@show'")]),e._v(").name("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'user.show'")]),e._v(");\n});\n")])]),t("p",[e._v("This example will give the following pseudo-routes")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("// { path: '/admin',            action: 'backend.DashboardController@index', as: 'admin.dashboard' }")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("// { path: '/admin/user',       action: 'backend.UserController@index',      as: 'admin.user.index' }")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("// { path: '/admin/user/:user', action: 'backend.UserController@show',       as: 'admin.user.show' }")]),e._v("\n")])]),t("p",[e._v("You can also use groups inside groups")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[e._v("router.group({ "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("prefix")]),e._v(": "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'/admin'")]),e._v(", "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("as")]),e._v(": "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'admin.'")]),e._v(", "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("namespace")]),e._v(": "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'backend.'")]),e._v("}, () => {\n    router.get("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'/'")]),e._v(", "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'DashboardController@index'")]),e._v(").name("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'dashboard'")]),e._v(");\n\n    router.group({ "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("prefix")]),e._v(": "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'/user'")]),e._v(", "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("as")]),e._v(": "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'user.'")]),e._v("}, () => {\n        router.get("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'/'")]),e._v(",      "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'UserController@index'")]),e._v(").name("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'index'")]),e._v(");\n        router.get("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'/:user'")]),e._v(", "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'UserController@show'")]),e._v(").name("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'show'")]),e._v(");\n    });\n});\n")])]),t("p",[e._v("You can use the following group options:")]),t("ul",[t("li",[t("p",[t("code",{pre:!0},[e._v("as")])]),t("blockquote",[t("p",[e._v("The routes name prefix.\nWould end with a period if you want to define as route namespace.")])])]),t("li",[t("p",[t("code",{pre:!0},[e._v("namespace")])]),t("blockquote",[t("p",[e._v("Controller namespace.\nShould end with a period.")])])]),t("li",[t("p",[t("code",{pre:!0},[e._v("prefix")])]),t("blockquote",[t("p",[e._v("URI prefix segment.\nCan contain multiple segments.")])])])]),t("h2",[e._v("Resource routes")]),t("p",[e._v("Most of the CRUD applications will implement the same routes:")]),t("ul",[t("li",[t("code",{pre:!0},[e._v("GET /resource")]),e._v(" to get a list page of the resource")]),t("li",[t("code",{pre:!0},[e._v("POST /resource/create")]),e._v(" to get the creation form for a new resource")]),t("li",[t("code",{pre:!0},[e._v("POST /resource")]),e._v(" to add a new resource record")]),t("li",[t("code",{pre:!0},[e._v("GET /resource/:resource")]),e._v(" to get a single resource record page")]),t("li",[t("code",{pre:!0},[e._v("GET /resource/:resource/edit")]),e._v(" to get the edition form for the current resource")]),t("li",[t("code",{pre:!0},[e._v("PATCH /resource/:resource")]),e._v(" to edit the current resource")]),t("li",[t("code",{pre:!0},[e._v("DELETE /resource/:resource")]),e._v(" to delete the current resource")])]),t("p",[e._v("To simplify the routes, the "),t("code",{pre:!0},[e._v("resource")]),e._v(" method was defined to create all those routes automatically with a dedicated controller.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[e._v("router.resource("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'resource'")]),e._v(", "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'ResourceController'")]),e._v(");\n"),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("/*\n// Same as this\nrouter.group({ as: 'resource.', prefix: '/resource' }, () => {\n    router.get('/',               'ResourceController@index').name('index');\n    router.get('/create',         'ResourceController@create').name('create');\n    router.post('/',              'ResourceController@store').name('store');\n    router.get('/:resource',      'ResourceController@show').name('show');\n    router.get('/:resource/edit', 'ResourceController@edit').name('edit');\n    router.patch('/:resource',    'ResourceController@update').name('update');\n    router.delete('/:resource',   'ResourceController@destroy').name('destroy');\n});\n */")]),e._v("\n")])]),t("p",[e._v("You can have only some routes defined by adding a third argument, which represents the route types that you need.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[e._v("router.resource("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'resource'")]),e._v(", "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'ResourceController'")]),e._v(", ["),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'index'")]),e._v(", "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'create'")]),e._v(", "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'store'")]),e._v(", "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'show'")]),e._v("]);\n"),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("/*\n// Same as this\nrouter.group({ as: 'resource.', prefix: '/resource' }, () => {\n    router.get('/',               'ResourceController@index').name('index');\n    router.get('/create',         'ResourceController@create').name('create');\n    router.post('/',              'ResourceController@store').name('store');\n    router.get('/:resource',      'ResourceController@show').name('show');\n});\n */")]),e._v("\n")])]),t("h3",[e._v("API resource")]),t("p",[e._v("For API endpoints, the "),t("code",{pre:!0},[e._v("create")]),e._v(" and the "),t("code",{pre:!0},[e._v("edit")]),e._v(" routes have no reason to be present since the "),t("code",{pre:!0},[e._v("store")]),e._v(" and the "),t("code",{pre:!0},[e._v("update")]),e._v(" may come from form data outside the known ecosystem of the application.")]),t("p",[e._v("The "),t("code",{pre:!0},[e._v("apiResource")]),e._v(" method will do the exact same thing than "),t("code",{pre:!0},[e._v("resource")]),e._v(", but by omitting the "),t("code",{pre:!0},[e._v("create")]),e._v(" and "),t("code",{pre:!0},[e._v("edit")]),e._v(" routes.")]),t("h2",[e._v("Controllers")]),t("p",[e._v("A controller in Node IoC is a simple class that contains actions, which are methods.\nIn your application, they are located in the "),t("code",{pre:!0},[e._v("src/app/http/controllers")]),e._v(" folder.\nAn abstract "),t("code",{pre:!0},[e._v("Controller")]),e._v(" is already defined, empty and ready to be enhanced.\nIt already inherits from the Controller class in the framework.")]),t("h3",[e._v("Auto-registration")]),t("p",[e._v("The application controllers are automatically registered in the "),t("code",{pre:!0},[e._v("router.controller")]),e._v(" repository, which contains all the known controllers.")]),t("p",[e._v("Their file names, without the "),t("code",{pre:!0},[e._v(".js")]),e._v(" extension is used as their name.\nIf they are nested in a folder, the folder path becomes the controller's namespace, replacing the slash by dots.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":""}},[e._v('src/app/http/controllers/\n    Controller.js              -> "Controller" (should never be directly used...)\n    HomeController.js          -> "HomeController"\n    api/\n        TodoController.js      -> "api.TodoController"\n    admin\n        DashboardController.js -> "admin.DashboardController"\n        people\n            UserController.js  -> "admin.people.UserController"\n')])]),t("h3",[e._v("Register a controller")]),t("p",[e._v("To manually register a controller, the "),t("code",{pre:!0},[e._v("router.controller")]),e._v(" repository offers an "),t("code",{pre:!0},[e._v("add")]),e._v(" method.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("import")]),e._v(" MyController "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("from")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'./MyController'")]),e._v(";\n\napp.make("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'router.controller'")]),e._v(").add("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'MyController'")]),e._v(", MyController);\n")])]),t("p",[e._v("When registering a controller, they are bound to the application under their name.\nThe fact that the controllers are in "),t("code",{pre:!0},[e._v("PascalCase")]),e._v(" clashes with the other services and should prevent conflicts.")]),t("p",[e._v("You can retrieve a controller instance anytime by using the "),t("code",{pre:!0},[e._v("get")]),e._v(" method.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[e._v("app.make("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'router.controller'")]),e._v(").get("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'MyController'")]),e._v("); "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[e._v("// MyController {}")]),e._v("\n")])]),t("h2",[e._v("Create a controller")]),t("p",[e._v("To create a controller in your application, a simple command creates the necessary scaffold of a controller that inherits from your base controller.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-bash"}},[e._v("node ioc make:controller MyController\n")])]),t("p",[e._v("It will create an empty "),t("code",{pre:!0},[e._v("MyController.js")]),e._v(" controller class file inside the "),t("code",{pre:!0},[e._v("src/app/http/controllers")]),e._v(" folder.")]),t("p",[e._v("You can create different kinds of controllers, such as a handler, a resource or an API resource controller.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":""}},[e._v("node ioc make:controller DashboardController --handler\nnode ioc make:controller DashboardController --resource\nnode ioc make:controller DashboardController --api\n")])]),t("p",[e._v("A handler controller will only have a "),t("code",{pre:!0},[e._v("handle")]),e._v(" method.\nIt is normally used for a single action controller.\nA resource controller defines all the resource actions: "),t("code",{pre:!0},[e._v("index")]),e._v(", "),t("code",{pre:!0},[e._v("create")]),t("code",{pre:!0},[e._v("store")]),e._v(", "),t("code",{pre:!0},[e._v("show")]),e._v(", "),t("code",{pre:!0},[e._v("edit")]),e._v(", "),t("code",{pre:!0},[e._v("update")]),e._v(" and "),t("code",{pre:!0},[e._v("destroy")]),e._v(".\nAn API controller defines all the API resource actions: "),t("code",{pre:!0},[e._v("index")]),e._v(", "),t("code",{pre:!0},[e._v("store")]),e._v(", "),t("code",{pre:!0},[e._v("show")]),e._v(", "),t("code",{pre:!0},[e._v("update")]),e._v(" and "),t("code",{pre:!0},[e._v("destroy")]),e._v(".")]),t("h2",[e._v("Render views")]),t("p",[e._v("To send an HTML response, the "),t("code",{pre:!0},[e._v("view")]),e._v(" method may be very useful to render a given view and send the result to the response object.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-class"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("class")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("HomeController")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("extends")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("Controller")]),e._v(" ")]),e._v("{\n\n    index() {\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".view("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'pages.home'")]),e._v(");\n    }\n\n}\n")])]),t("p",[e._v("You can also send view-mode data to the views as the second argument.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-class"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("class")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("HomeController")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("extends")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("Controller")]),e._v(" ")]),e._v("{\n\n    "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("async")]),e._v(" index() {\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("const")]),e._v(" weather = "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("await")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".app.make("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'weather'")]),e._v(").today();\n\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".view("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'pages.home'")]),e._v(", { weather });\n    }\n\n}\n")])]),t("h2",[e._v("Send JSON response")]),t("p",[e._v("To send a JSON response, the "),t("code",{pre:!0},[e._v("json")]),e._v(" method transform the given value to JSON and send it as an "),t("code",{pre:!0},[e._v("application/json")]),e._v(" response.")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-class"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("class")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("MyApiController")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("extends")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[e._v("Controller")]),e._v(" ")]),e._v("{\n\n    index() {\n        "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("return")]),e._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[e._v("this")]),e._v(".json({\n            "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[e._v("foo")]),e._v(": "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[e._v("'bar'")]),e._v("\n        });\n    }\n\n}\n")])]),t("h3",[e._v("Set HTTP status code")]),t("p",[e._v("To send the proper status code, some helper methods were defined:")]),t("ul",[t("li",[t("p",[t("code",{pre:!0},[e._v("status(code)")])]),t("blockquote",[t("p",[e._v("Set the status code manually")])])]),t("li",[t("p",[t("code",{pre:!0},[e._v("throwWithStatus(status)")])]),t("blockquote",[t("p",[e._v("Set the status code manually, the throw a corresponding HTTP error")])])]),t("li",[t("p",[t("code",{pre:!0},[e._v("ok()")])]),t("blockquote",[t("p",[e._v("Set "),t("code",{pre:!0},[e._v("200 OK.")]),e._v(" status code")])])]),t("li",[t("p",[t("code",{pre:!0},[e._v("created()")])]),t("blockquote",[t("p",[e._v("Set "),t("code",{pre:!0},[e._v("201 Created.")]),e._v(" status code")])])]),t("li",[t("p",[t("code",{pre:!0},[e._v("accepted()")])]),t("blockquote",[t("p",[e._v("Set "),t("code",{pre:!0},[e._v("202 Accepted.")]),e._v(" status code")])])]),t("li",[t("p",[t("code",{pre:!0},[e._v("noContent()")])]),t("blockquote",[t("p",[e._v("Set "),t("code",{pre:!0},[e._v("204 No Content.")]),e._v(" status code")])])]),t("li",[t("p",[t("code",{pre:!0},[e._v("badRequest()")])]),t("blockquote",[t("p",[e._v("Set "),t("code",{pre:!0},[e._v("400 Bad Request.")]),e._v(" status code and throws "),t("code",{pre:!0},[e._v("BadRequestHttpError")])])])]),t("li",[t("p",[t("code",{pre:!0},[e._v("unauthorized()")])]),t("blockquote",[t("p",[e._v("Set "),t("code",{pre:!0},[e._v("401 Unauthorized.")]),e._v(" status code and throws "),t("code",{pre:!0},[e._v("UnauthorizedHttpError")])])])]),t("li",[t("p",[t("code",{pre:!0},[e._v("forbidden()")])]),t("blockquote",[t("p",[e._v("Set "),t("code",{pre:!0},[e._v("403 Forbidden.")]),e._v(" status code and throws "),t("code",{pre:!0},[e._v("ForbiddenHttpError")])])])]),t("li",[t("p",[t("code",{pre:!0},[e._v("notFound()")])]),t("blockquote",[t("p",[e._v("Set "),t("code",{pre:!0},[e._v("404 Not Found.")]),e._v(" status code and throws "),t("code",{pre:!0},[e._v("NotFoundHttpError")])])])]),t("li",[t("p",[t("code",{pre:!0},[e._v("methodNotAllowed()")])]),t("blockquote",[t("p",[e._v("Set "),t("code",{pre:!0},[e._v("405 Method Not Allowed.")]),e._v(" status code and throws "),t("code",{pre:!0},[e._v("MethodNotAllowedHttpError")])])])]),t("li",[t("p",[t("code",{pre:!0},[e._v("timeout()")])]),t("blockquote",[t("p",[e._v("Set "),t("code",{pre:!0},[e._v("408 Timeout.")]),e._v(" status code and throws "),t("code",{pre:!0},[e._v("TimeoutHttpError")])])])]),t("li",[t("p",[t("code",{pre:!0},[e._v("teapot()")])]),t("blockquote",[t("p",[e._v("Set "),t("code",{pre:!0},[e._v("418 Timeout.")]),e._v(" status code")])])])]),t("p",[e._v("When an HTTP error is thrown, it is handled by the "),t("code",{pre:!0},[e._v("exception.handler")]),e._v(", which will render the proper response for both JSON and HTML requests, depending on the "),t("code",{pre:!0},[e._v("app.debug")]),e._v(" configuration state.")])])}],n=t("2877"),o={},l=Object(n["a"])(o,a,r,!1,null,null,null);s["default"]=l.exports},f1be:function(e,s,t){"use strict";var a=t("1083"),r=t.n(a);r.a},f270:function(e,s,t){},f637:function(e,s,t){},fc92:function(e,s,t){"use strict";var a=t("f637"),r=t.n(a);r.a}});
//# sourceMappingURL=app.07216c69.js.map